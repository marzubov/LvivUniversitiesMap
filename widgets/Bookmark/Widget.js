//>>built
require({cache:{"widgets/Bookmark/ImageNode":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dojo/on dojo/mouse dojo/query".split(" "),function(h,d,b,e,l,k,m,g){return h([e,l],{templateString:'\x3cdiv class\x3d"jimu-img-node"\x3e\x3c/div\x3e',constructor:function(b,d){},postCreate:function(){this.box=b.create("div",{"class":"node-box"},this.domNode);b.create("img",{src:this.img},this.box);b.create("div",{"class":"node-label",innerHTML:this.label,
title:this.label},this.domNode);this.own(k(this.domNode,"click",d.hitch(this,this.onClick)))},onClick:function(){g(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");g(this.domNode).addClass("jimu-state-selected")},highLight:function(){g(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");g(this.domNode).addClass("jimu-state-selected")},startup:function(){}})})},"widgets/Bookmark/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Bookmark/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"jimu-r-row add-section"\x3e\r\n\t\t\x3cinput class\x3d"jimu-input input-bookmark-name" data-dojo-attach-point\x3d"bookmarkName" type\x3d"text" placeholder\x3d"${nls.placeholderBookmarkName}"\x3e\r\n\t\t\x3cdiv class\x3d"btn-add" data-dojo-attach-point\x3d"btnAdd" data-dojo-attach-event\x3d"onclick:_onAddBtnClicked"\x3e\x3cdiv class\x3d"jimu-center-img"\x3e\x3c/div\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"jimu-state-error" data-dojo-attach-point\x3d"errorNode"\x3e\x26nbsp;\x3c/div\x3e\t\t\r\n\t\x3cdiv class\x3d"bookmark-list" data-dojo-attach-point\x3d"bookmarkListNode"\x3e\r\n\t\t\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"jimu-r-row play-section"\x3e\r\n\t\t\x3cdiv class\x3d"col-1-2"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-btn btn-play" data-dojo-attach-point\x3d"btnPlay" data-dojo-attach-event\x3d"onclick:_onPlayBtnClicked"\x3e${nls.labelPlay}\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"col-1-2"\x3e\r\n\t\t\t\x3cdiv class\x3d"jimu-btn btn-delete" data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_onDeleteBtnClicked"\x3e${nls.labelDelete}\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/Bookmark/css/style.css":".jimu-img-node{font-size: 12px; position: relative; float: left; border-radius: 4px; color: #686868; overflow: hidden;}.jimu-img-node .node-box{position: absolute; top: 0; bottom: 32px; left: 0; width: 100%; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{position: absolute; width: 100%; left: 0; bottom: 0; height: 30px; text-align: center;}.jimu-img-node:hover{color: #51b1fe;}.jimu-img-node.jimu-state-selected .node-label{background-color: #d9dde0;}.jimu-widget-bookmark .add-section{position: relative; height: 30px; margin-top: 7px; overflow: visible;}.jimu-widget-bookmark .input-bookmark-name{border-top-right-radius: 0; border-bottom-right-radius: 0; position: absolute; left: 0; top: 0; width: 100%;}.jimu-widget-bookmark .btn-add{position: absolute; right: 1px; top: 1px; bottom: 1px; width: 30px; z-index: 2; border-top-right-radius: 2px; border-bottom-right-radius: 2px; background-color: #d9dde0; cursor: pointer;}.jimu-widget-bookmark .btn-add .jimu-center-img{border-top: 1px solid rgba(255, 255, 255, 0.2); background-image: url(images/add.png);}.jimu-widget-bookmark .jimu-state-error{margin-top: 4px; visibility: hidden;}.jimu-widget-bookmark .play-section{overflow: hidden; margin-top: 20px;}.jimu-widget-bookmark .jimu-btn{float: none; margin: auto; width: 150px;}.FoldableTheme.green .jimu-widget-bookmark .btn-add{background-color: #80dbc5;}.FoldableTheme.cyan .jimu-widget-bookmark .btn-add{background-color: #d5d5d4;}",
"url:widgets/Bookmark/config.json":'{\r\n\t"bookmarks2D": [{\r\n\t\t"name": "China",\r\n\t\t"extent": {\r\n\t\t\t"xmin": 7457807.540881645,\r\n\t\t\t"ymin": 2017936.0525213866,\r\n\t\t\t"xmax": 15324094.995763611,\r\n\t\t\t"ymax": 6420708.8817463685,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_great_wall.png"\r\n\t}, {\r\n\t\t"name": "Beijing",\r\n\t\t"extent": {\r\n\t\t\t"xmin": -27150828.956547454,\r\n\t\t\t"ymin": 4834000.477831723,\r\n\t\t\t"xmax": -27077449.409393787,\r\n\t\t\t"ymax": 4875085.380534951,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_forbidden_city.png"\r\n\t}, {\r\n\t\t"name": "Arches National Park",\r\n\t\t"extent": {\r\n\t\t\t"xmin": -12269895.952570029,\r\n\t\t\t"ymin": 4638952.643481596,\r\n\t\t\t"xmax": -12123136.858262688,\r\n\t\t\t"ymax": 4721122.448888049,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_arches_national_park.png"\r\n\t}, {\r\n\t\t"name": "Paris",\r\n\t\t"extent": {\r\n\t\t\t"xmin": 254218.13006577286,\r\n\t\t\t"ymin": 6250235.153843932,\r\n\t\t\t"xmax": 256511.24091413454,\r\n\t\t\t"ymax": 6251519.0570533015,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_eiffel_tower.png"\r\n\t}, {\r\n\t\t"name": "Sydney",\r\n\t\t"extent": {\r\n\t\t\t"xmin": 16828875.127701383,\r\n\t\t\t"ymin": -4013216.291883955,\r\n\t\t\t"xmax": 16836557.04904403,\r\n\t\t\t"ymax": -4008916.70904292,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_sydney_opera.png"\r\n\t}, {\r\n\t\t"name": "Egypt",\r\n\t\t"extent": {\r\n\t\t\t"xmin": 2880948.957769421,\r\n\t\t\t"ymin": 2793013.2537907935,\r\n\t\t\t"xmax": 3864234.889629663,\r\n\t\t\t"ymax": 3343359.8574439143,\r\n\t\t\t"spatialReference": {\r\n\t\t\t\t"wkid": 102100\r\n\t\t\t}\r\n\t\t},\r\n\t\t"thumbnail": "images/thumbnail_giza_pyramid.png"\r\n\t}],\r\n\t"bookmarks3D": [{\r\n\t\t"name": "China",\r\n\t\t"camera": [116.38, 39.9, 100000, 0, 1],\r\n\t\t"thumbnail": "images/thumbnail_beijing.png"\r\n\t}, {\r\n\t\t"name": "SF",\r\n\t\t"camera": [-122.3956840179302, 37.78329055435611, 235.5668830918148, 327.4062957304337, 66.71004825534648],\r\n\t\t"thumbnail": "images/thumbnail_sf.png"\r\n\t}, {\r\n\t\t"name": "USA",\r\n\t\t"camera": [-108.919, 34.2259, 4126880, 340.71, 5.91655],\r\n\t\t"thumbnail": "images/thumbnail_us.png"\r\n\t}],\r\n\t"flyTime": 3000\r\n}\r\n',
"*now":function(h){h(['dojo/i18n!*preload*widgets/Bookmark/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html jimu/BaseWidget dojo/on dojo/aspect dojo/string esri/SpatialReference ./ImageNode jimu/dijit/TileLayoutContainer libs/storejs/store".split(" "),function(h,d,b,e,l,k,m,g,n,p,q,f){return h([l],{baseClass:"jimu-widget-bookmark",name:"Bookmark",bookmarks:[],currentIndex:-1,_canDelete:!1,_canPlay:!1,_playStatus:"none",startup:function(){this.inherited(arguments);this.bookmarkList=new q({strategy:"fixCols",itemSize:{height:100*
(110/130)+"%"},maxCols:2},this.bookmarkListNode);this.appConfig.map["3D"]?(e.setStyle(this.btnPlay,"display",""),m.after(this.map,"onCameraChangeEnd",d.hitch(this,this._onFlytoEnd),!0),m.after(this.map,"onCameraChangeBreak",d.hitch(this,this._onFlytoBreak),!0)):e.setStyle(this.btnPlay,"display","none");this.bookmarkList.startup();this.own(k(this.bookmarkName,"keydown",d.hitch(this,function(a){13===(void 0!==a.keyCode?a.keyCode:a.which)&&this._onAddBtnClicked()})))},onOpen:function(){var a=this._getLocalCache();
this.bookmarks=0<a.length?a:this.appConfig.map["3D"]?d.clone(this.config.bookmarks3D):d.clone(this.config.bookmarks2D);this._readBookmarksInWebmap();this.displayBookmarks()},onClose:function(){this.bookmarks=[];this.currentIndex=-1},onMinimize:function(){this.resize()},onMaximize:function(){this.resize()},resize:function(){this.bookmarkList&&this.bookmarkList.resize()},destroy:function(){this.bookmarkList.destroy();this.inherited(arguments)},displayBookmarks:function(){var a=[];this.bookmarkList.empty();
b.forEach(this.bookmarks,function(c){a.push(this._createBookMarkNode(c))},this);this.bookmarkList.addItems(a);this._switchDeleteBtn();this._switchPlayBtn();this.resize()},_readBookmarksInWebmap:function(){this.map.itemInfo&&(this.map.itemInfo.itemData&&this.map.itemInfo.itemData.bookmarks)&&b.forEach(this.map.itemInfo.itemData.bookmarks,function(a){a.isInWebmap=!0;a.name=a.name;for(var c=0,b=0;b<this.bookmarks.length;b++)this.bookmarks[b].name===a.name&&c++;c||this.bookmarks.push(a)},this)},_switchDeleteBtn:function(){-1<
this.currentIndex&&!this.bookmarks[this.currentIndex].isInWebmap?(e.removeClass(this.btnDelete,"jimu-state-disabled"),this._canDelete=!0):(e.addClass(this.btnDelete,"jimu-state-disabled"),this._canDelete=!1)},_switchPlayBtn:function(){1<this.bookmarks.length?(e.removeClass(this.btnPlay,"jimu-state-disabled"),this._canPlay=!0):(e.addClass(this.btnPlay,"jimu-state-disabled"),this._canPlay=!1)},_switchPlayStatus:function(a){this._playStatus=a;this.btnPlay.innerHTML="none"===this._playStatus||"stop"===
this._playStatus?this.nls.labelPlay:this.nls.labelStop},_createBookMarkNode:function(a){var c;c=a.thumbnail&&a.thumbnail.startWith("data:")?a.thumbnail:a.thumbnail?this.folderUrl+a.thumbnail:this.folderUrl+"images/thumbnail_default.png";c=new p({img:c,label:a.name});k(c.domNode,"click",d.hitch(this,d.partial(this._onBookmarkClick,a)));return c},_getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},_saveAllToLocalCache:function(){var a=[];b.forEach(f.get(this._getKeysKey()),
function(a){f.remove(a)},this);b.forEach(this.bookmarks,function(c){if(!c.isInWebmap){var b=this._getKeysKey()+"."+c.name;a.push(b);f.set(b,c)}},this);f.set(this._getKeysKey(),a)},_getLocalCache:function(){var a=[];if(!f.get(this._getKeysKey()))return a;b.forEach(f.get(this._getKeysKey()),function(c){c.startWith(this._getKeysKey())&&a.push(f.get(c))},this);return a},_onFlytoEnd:function(a){"stop"===this._playStatus||"none"===this._playStatus||(this.currentIndex+1===this.bookmarkList.items.length?
this._switchPlayStatus("stop"):(this.currentIndex++,this.bookmarkList.items[this.currentIndex].highLight(),setTimeout(d.hitch(this,this._setCamera,this.bookmarks[this.currentIndex]),this.config.stopTime)))},_onFlytoBreak:function(){"playing"===this._playStatus&&this._switchPlayStatus("stop")},_onAddBtnClicked:function(){0===g.trim(this.bookmarkName.value).length?(e.setStyle(this.errorNode,{visibility:"visible"}),this.errorNode.innerHTML=this.nls.errorNameNull):b.some(this.bookmarks,function(a){if(a.name===
this.bookmarkName.value)return!0},this)?(e.setStyle(this.errorNode,{visibility:"visible"}),this.errorNode.innerHTML=this.nls.errorNameExist):(this._createBookmark(),e.setStyle(this.errorNode,{visibility:"hidden"}),this.errorNode.innerHTML="\x26nbsp;",this.bookmarkName.value="",this.displayBookmarks())},_onPlayBtnClicked:function(){this._canPlay&&("playing"===this._playStatus?this._switchPlayStatus("stop"):(this._switchPlayStatus("playing"),this.currentIndex=0,this._switchDeleteBtn(),this.bookmarkList.items[this.currentIndex].highLight(),
this._setCamera(this.bookmarks[this.currentIndex])))},_createBookmark:function(){var a;this.appConfig.map["3D"]?(a=this.map.getCamera(new n(4326)),a={name:this.bookmarkName.value,camera:[a.x,a.y,a.z,a.heading,a.tilt]}):a={name:this.bookmarkName.value,extent:this.map.extent.toJson()};this.bookmarks.push(a);this._createBookMarkNode(a);this._saveAllToLocalCache();this.resize()},_onDeleteBtnClicked:function(){this._canDelete&&-1!==this.currentIndex&&(b.some(this.bookmarks,function(a,c){if(c===this.currentIndex)return this.bookmarks.splice(c,
1),!0},this),this._saveAllToLocalCache(),this.resize(),this.currentIndex=-1,this.displayBookmarks())},_onBookmarkClick:function(a){b.some(this.bookmarks,function(c,b){if(c.name===a.name)return this.currentIndex=b,!0},this);this._switchDeleteBtn();this.appConfig.map["3D"]?this._setCamera(a):require(["esri/geometry/Extent"],d.hitch(this,function(c){var b=a.extent;b.spatialReference?new n(b.spatialReference):new n({wkid:4326});this.map.setExtent(new c(b))}))},_setCamera:function(a){this.map.setCamera(a.camera,
this.config.flyTime)}})});