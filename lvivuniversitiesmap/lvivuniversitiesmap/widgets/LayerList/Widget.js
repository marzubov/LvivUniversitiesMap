//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-geometry dojo/on dojo/aspect dojo/query jimu/dijit/CheckBox ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html esri/dijit/Legend ./NlsStrings dojo/dom-attr dojo/dom-class dojo/dom-style".split(" "),function(v,s,q,h,c,e,u,k,p,d,r,l,g,b,t,A,x,w){return s([v,l],{templateString:g,_currentSelectedLayerRowNode:null,postCreate:function(){h.forEach(this.operLayerInfos.finalLayerInfos,
function(b){this.drawListNode(b,0,this.layerListTable,!0)},this)},drawListNode:function(b,d,c){0===b.newSubLayers.length?(b.layerNode=this.addLayerNode(b,d,c),this.config.showLegend?this.addLegendNode(b,d,b.layerNode.subNode):w.set(p(".showLegend-image",b.layerNode.currentNode)[0],"display","none")):(b.layerNode=this.addLayerNode(b,d,c),h.forEach(b.newSubLayers,q.hitch(this,function(d,c){this.drawListNode(c,d+1,b.layerNode.subNode)},d)))},addLayerNode:function(b,e,g){var h=c.create("tr",{"class":"jimu-widget-row layer-row ",
layerTrNodeId:b.id},g),l,p,k,t,x,s;l=c.create("td",{"class":"col col1"},h);for(k=0;k<e;k++)c.create("div",{"class":"begin-blank-div",innerHTML:""},l);s=c.create("div",{"class":"showLegend-div"},l);t=c.create("img",{"class":"showLegend-image",src:this.layerListWidget.folderUrl+"images/v_right.png",alt:"l"},s);p=c.create("div",{"class":"div-select"},l);k=new d({checked:b.isVisible()});c.place(k.domNode,p);x=c.create("div",{"class":"noLegend-div"},l);c.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+
"images/noLegend.png",alt:"l"},x);b.noLegend?(w.set(s,"display","none"),w.set(p,"display","none")):w.set(x,"display","none");w.set(l,"width",12*e+35+"px");l=c.create("td",{"class":"col col2"},h);c.create("div",{innerHTML:b.title,"class":"div-content"},l);l=c.create("td",{"class":"col col3"},h);e=c.create("div",{"class":"layers-list-popupMenu-div"},l);l=(new r({items:b.popupMenuInfo.menuItems,box:this.layerListWidget.domNode.parentNode})).placeAt(e);this.own(u(l,"onMenuClick",q.hitch(this,this._onPopupMenuItemClick,
b,l)));g=c.create("tr",{"class":"",layerContentTrNodeId:b.id},g);g=c.create("td",{"class":"",colspan:"3"},g);g=c.create("table",{"class":"layer-sub-node"},g);this.own(u(h,"click",q.hitch(this,this._onRowTrClick,b,t,h)));this.own(u(h,"mouseover",q.hitch(this,this._onLayerNodeMouseover,h,l)));this.own(u(h,"mouseout",q.hitch(this,this._onLayerNodeMouseout,h,l)));this.own(u(k.domNode,"click",q.hitch(this,this._onCkSelectNodeClick,b,k)));this.own(u(e,"click",q.hitch(this,this._onPopupMenuClick,b,l,h)));
return{currentNode:h,subNode:g}},addLegendNode:function(b,d,e){e=c.create("tr",{"class":"legend-node-tr"},e);e=c.create("td",{"class":"legend-node-td"},e);try{var g=b.obtainLegendsNode();b.legendsNode=g;w.set(g,"marginLeft",12*(d+1)+"px");c.place(g,e)}catch(l){console.error(l)}},_fold:function(b,d){"none"===w.get(b.layerNode.subNode,"display")?(w.set(b.layerNode.subNode,"display","table"),A.set(d,"src",this.layerListWidget.folderUrl+"images/v.png")):(w.set(b.layerNode.subNode,"display","none"),A.set(d,
"src",this.layerListWidget.folderUrl+"images/v_right.png"))},_onImageShowLegendClick:function(b,d,c){this._fold(b,d);c&&c.stopPropagation()},_onCkSelectNodeClick:function(b,d,c){d.checked?b.setTopLayerVisible(!0):b.setTopLayerVisible(!1);c.stopPropagation()},_onPopupMenuClick:function(b,d,c,e){this._changeSelectedLayerRow(c);d&&"opened"===d.state?d.closeDropMenu():(this._hideCurrentPopupMenu(),d&&(b=b.getDeniedItems(),d.openDropMenu(b),this.currentPopupMenu=d));e.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&
"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerNodeMouseover:function(b,d){x.add(b,"layer-row-mouseover");d&&x.add(d.btnNode,"jimu-icon-btn-selected")},_onLayerNodeMouseout:function(b,d){x.remove(b,"layer-row-mouseover");d&&x.remove(d.btnNode,"jimu-icon-btn-selected")},_onPopupMenuHide:function(){console.log("aaa")},_onLayerListWidgetPaneClick:function(b){b&&b.closeDropMenu()},_onRowTrClick:function(b,d,c){this._changeSelectedLayerRow(c);this._onImageShowLegendClick(b,
d);b.loadLegends(this.layerListWidget.appConfig.portalUrl)},_changeSelectedLayerRow:function(b){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===b||(this._currentSelectedLayerRowNode&&x.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),x.add(b,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=b)},_onPopupMenuItemClick:function(b,d,c,e){e={itemKey:c.key,data:e,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===c.key?"none"===
w.get(d.transparencyDiv,"display")?d.showTransNode(b.getOpacity()):d.hideTransNode():(b=b.onPopupMenuClick(e),b.closeMenu&&d.closeDropMenu())},_exchangeLayerTrNode:function(b,d){var c=p("tr[layerTrNodeId\x3d'"+b+"']",this.layerListTable)[0],e=p("tr[layerTrNodeId\x3d'"+d+"']",this.layerListTable)[0],g=p("tr[layerContentTrNodeId\x3d'"+d+"']",this.layerListTable)[0];this.layerListTable.removeChild(e);this.layerListTable.insertBefore(e,c);this.layerListTable.removeChild(g);this.layerListTable.insertBefore(g,
c)},moveUpLayer:function(b){var d=this.operLayerInfos.moveUpLayer(b);d&&this._exchangeLayerTrNode(d,b)},moveDownLayer:function(b){var d=this.operLayerInfos.moveDownLayer(b);d&&this._exchangeLayerTrNode(b,d)}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on jimu/dijit/DropMenu dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style ./NlsStrings".split(" "),
function(v,s,q,h,c,e,u,k,p,d,r,l,g){return v([u,k],{templateString:r,_deniedItems:null,constructor:function(){this.nls=g.value;this._deniedItems=[]},_getDropMenuPosition:function(){return{top:"15px",left:12-q.getStyle(this.dropMenuNode,"width")+"px"}},_getTransNodePosition:function(){return{top:"15px",left:-174-q.getStyle(this.dropMenuNode,"width")+"px"}},_onBtnClick:function(){this.dropMenuNode||(this._createDropMenuNode(),this.own(e(this.dropMenuNode,"click",h.hitch(this,function(b){b.stopPropagation()}))))},
_refresh:function(){this._denyItems()},_denyItems:function(){var b=c("div[class~\x3d'menu-item']",this.dropMenuNode).forEach(function(b){q.removeClass(b,"menu-item-dissable")});s.forEach(this._deniedItems,function(d){b.forEach(function(b){q.getAttr(b,"itemId")===d&&(q.addClass(b,"menu-item-dissable"),("description"===d||"download"===d)&&c(".menu-item-description",b).forEach(function(b){q.setAttr(b,"href","#");q.removeAttr(b,"target")}))})},this)},selectItem:function(b){-1===this._deniedItems.indexOf(b.key)&&
this.emit("onMenuClick",b)},openDropMenu:function(b){b.then(h.hitch(this,function(b){this._deniedItems=b;this._refresh()}));this.inherited(arguments)},closeDropMenu:function(){this.inherited(arguments);this.hideTransNode()},_onTransparencyDivClick:function(b){b.stopPropagation()},showTransNode:function(b){this.transHorizSlider||(this._createTransparencyWidget(),this.transHorizSlider.set("value",1-b));l.set(this.transparencyDiv,"top",this._getTransNodePosition().top);l.set(this.transparencyDiv,"left",
this._getTransNodePosition().left);l.set(this.transparencyDiv,"display","block")},hideTransNode:function(){l.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(){this.transHorizSlider=new p({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",h.hitch(this,function(b){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:b})})));new d({container:"bottomDecoration"},this.transparencyRule)}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented ../utils".split(" "),
function(v,s,q,h,c,e,u,k){return v([s,u],{"class":"jimu-dropmenu",constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=c.create("div",{"class":"jimu-icon-btn"},this.domNode);this.own(e(this.btnNode,"click",q.hitch(this,this._onBtnClick)));this.box||(this.box=this.domNode.parentNode);this.own(e(this.box,"click",q.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(c){c.stopPropagation();this.dropMenuNode||this._createDropMenuNode();"closed"===
this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=c.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);h.forEach(this.items,function(h){var d;h.key?(d=c.create("div",{"class":"menu-item",itemId:h.key,innerHTML:h.label},this.dropMenuNode),this.own(e(d,"click",q.hitch(this,function(){this.selectItem(h)})))):c.create("hr",{"class":"menu-item-line"},this.dropMenuNode)},this)},_getDropMenuPosition:function(){var e=
c.getContentBox(this.box),d=c.getMarginBox(this.domNode),h=c.getMarginBox(this.btnNode),l=c.getMarginBox(this.dropMenuNode),g={},b,k;g.l=d.l;g.t=d.t+h.h;g.t+l.h>e.h&&(k=d.t,b=e.h-d.t-h.h,b=Math.max(k,b),b===k&&(g.t=0-l.h));g.l+l.w>e.w&&(l=d.l,e=e.w-d.l-h.w,b=Math.max(l,e),b===l&&(g.l="",g.r=0));g.left=g.l;g.top=g.t;g.right=g.r;return g},selectItem:function(c){this.closeDropMenu();this.emit("onMenuClick",c)},openDropMenu:function(){this.state="opened";c.setStyle(this.dropMenuNode,"display","");c.setStyle(this.dropMenuNode,
k.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){this.state="closed";c.setStyle(this.dropMenuNode,"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/has dojo/sniff dojo/DeferredList dojo/json dojo/number dojo/dom dojo/dom-construct dojo/dom-style dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureFillSymbol ../symbols/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/i18n!dojo/cldr/nls/number".split(" "),
function(v,s,q,h,c,e,u,k,p,d,r,l,g,b,t,A,x,w,F,S,G,H,E,C,I,J,K,L,M,N,O,D,P,Q,R){var B=s([P,A],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,dotDensitySwatchSize:26,dotCoverage:75,reZeros:RegExp("\\"+R.decimal+"0+$","g"),reZerosFractional:RegExp("(\\d)0*$","g"),_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(a,n){q.mixin(this,Q.widgets.legend);a=a||{};a.map?n?(this.map=a.map,this.layerInfos=a.layerInfos,this._respectCurrentMapScale=
!1===a.respectCurrentMapScale?!1:!0,this.arrangement=a.arrangement===B.ALIGN_RIGHT?B.ALIGN_RIGHT:B.ALIGN_LEFT,this.arrangement===B.ALIGN_RIGHT&&(this.alignRight=!0),this.autoUpdate=!1===a.autoUpdate?!1:!0,this._surfaceItems=[]):console.error("esri.dijit.Legend: must specify a container for the legend"):console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var a=["ar","he"],n,f;for(n=0;n<a.length;n+=1)f=a[n],v.locale&&
-1!==v.locale.indexOf(f)&&(-1!==v.locale.indexOf("-")?-1!==v.locale.indexOf(f+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>k("ie")&&(this._repaintItems=q.hitch(this,this._repaintItems),
setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();this._removeHoverHandlers();this.inherited(arguments)},refresh:function(a){if(this.domNode){a?(this.layerInfos=a,this.layers=[],h.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(a.layer._hideLayersInLegend=a.hideLayers,this._addSubLayersToHide(a)):a.layer._hideLayersInLegend=[],
a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this)):this.useAllMapLayers&&(this.layers=this.layerInfos=null);for(a=this.domNode.children.length-1;0<=a;a--)b.destroy(this.domNode.children[a]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){this.layerInfos&&(this.layers=[],h.forEach(this.layerInfos,function(a){this._isSupportedLayerType(a.layer)&&
(a.title&&(a.layer._titleForLegend=a.title),a.layer._hideDefaultSymbol=!1===a.defaultSymbol?!0:!1,a.hideLayers?(a.layer._hideLayersInLegend=a.hideLayers,this._addSubLayersToHide(a)):a.layer._hideLayersInLegend=[],a.hoverLabel&&(a.layer._hoverLabel=a.hoverLabel),a.hoverLabels&&(a.layer._hoverLabels=a.hoverLabels),this.layers.push(a.layer))},this));this.useAllMapLayers=!1;if(!this.layers){this.useAllMapLayers=!0;this.layers=[];var a=[],n=[];h.forEach(this.map.layerIds,function(b){b=this.map.getLayer(b);
var y;this._isSupportedLayerType(b)&&(b.arcgisProps&&b.arcgisProps.title&&(b._titleForLegend=b.arcgisProps.title),this.layers.push(b));"esri.layers.KMLLayer"==b.declaredClass&&(y=b.getLayers(),h.forEach(y,function(b){a.push(b.id)},this));"esri.layers.GeoRSSLayer"==b.declaredClass&&(y=b.getFeatureLayers(),h.forEach(y,function(a){n.push(a.id)},this))},this);h.forEach(this.map.graphicsLayerIds,function(b){var y=this.map.getLayer(b);-1==h.indexOf(a,b)&&-1==h.indexOf(n,b)&&(this._isSupportedLayerType(y)&&
y._params&&y._params.drawMode)&&(y.arcgisProps&&y.arcgisProps.title&&(y._titleForLegend=y.arcgisProps.title),this.layers.push(y))},this)}this._createLegend()},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=c.connect(this.map,"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=c.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=c.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=
c.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),h.forEach(this.layers,function(a){a.ovcConnect=c.connect(a,"onVisibilityChange",this,"_refreshLayers");a.oscConnect=c.connect(a,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass&&a.supportsDynamicLayers&&(a.odcConnect=c.connect(a,"_onDynamicLayersChange",q.hitch(this,"_updateDynamicLayers",a)));"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&(a.oirConnect=c.connect(a,
"onRenderingChange",q.partial(this._updateImageServiceLayers,this,a)))},this))},_deactivate:function(){this._ozeConnect&&c.disconnect(this._ozeConnect);this._olaConnect&&c.disconnect(this._olaConnect);this._olroConnect&&c.disconnect(this._olroConnect);this._olrConnect&&c.disconnect(this._olrConnect);h.forEach(this.layers,function(a){a.ovcConnect&&c.disconnect(a.ovcConnect);a.oscConnect&&c.disconnect(a.oscConnect);a.odcConnect&&c.disconnect(a.odcConnect);a.oirConnect&&c.disconnect(a.oirConnect)},this)},
_updateDynamicLayers:function(a){delete a.legendResponse;this._refreshLayers()},_updateImageServiceLayers:function(a,b){delete b.legendResponse;a._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];h.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&this.layers.push(a)},this);h.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);this._isSupportedLayerType(a)&&(a._params&&a._params.drawMode)&&
this.layers.push(a)},this);this.refresh()},_createLegend:function(){var a=!1;t.set(this.domNode,"position","relative");b.create("div",{id:this.id+"_msg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var n=[];h.forEach(this.layers,function(f){if("esri.layers.KMLLayer"==f.declaredClass||"esri.layers.GeoRSSLayer"==f.declaredClass){var d;f.loaded?("esri.layers.KMLLayer"==f.declaredClass?d=f.getLayers():"esri.layers.GeoRSSLayer"==f.declaredClass&&(d=f.getFeatureLayers(),f._hideLayersInLegend&&
(d=h.filter(d,function(a){return-1==h.indexOf(f._hideLayersInLegend,a.id)}))),h.forEach(d,function(a){"esri.layers.FeatureLayer"==a.declaredClass&&f._titleForLegend&&(a._titleForLegend=f._titleForLegend+" - ","esriGeometryPoint"==a.geometryType?a._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==a.geometryType?a._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==a.geometryType&&(a._titleForLegend+=this.NLS_polygons),n.push(a))},this)):c.connect(f,"onLoad",q.hitch(this,function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===
f.declaredClass)if(f.loaded){if(f.visible&&0<f.layerInfos.length&&h.some(f.layerInfos,function(a){return a.legendURL})){var e=!1;h.forEach(f.layerInfos,function(n){n.legendURL&&-1<h.indexOf(f.visibleLayers,n.name)&&(e||(b.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(f._titleForLegend||f.name||f.id)+"\x3c/span\x3e"},this.domNode),e=!0),b.create("div",{innerHTML:"\x3cimg src\x3d'"+n.legendURL+"'/\x3e"},this.domNode),a=!0)},this)}}else c.connect(f,"onLoad",q.hitch(this,function(){this.refresh(this.layerInfos)}));
else n.push(f)},this);var f=[];h.forEach(n,function(a){if(a.loaded){if(!0===a.visible&&(a.layerInfos||a.renderer||"esri.layers.ArcGISImageServiceLayer"==a.declaredClass)){var n=b.create("div",{id:this.id+"_"+a.id,style:{display:"none"},"class":"esriLegendService"});b.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},b.create("td",{align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",{width:"95%"},n)))));b.place(n,this.id,"first");a.legendResponse||
a.renderer?this._createLegendForLayer(a):f.push(this._legendRequest(a))}}else var d=c.connect(a,"onLoad",this,function(a){c.disconnect(d);d=null;this.refresh()})},this);0===f.length&&!a?(g.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate()):(new d(f)).addCallback(q.hitch(this,function(b){a?g.byId(this.id+"_msg").innerHTML="":g.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()}))},_createLegendForLayer:function(a){if(a.legendResponse||a.renderer){var b=!1;if(a.legendResponse){var f=
a.dynamicLayerInfos||a.layerInfos;f&&f.length?h.forEach(f,function(f,d){if(!a._hideLayersInLegend||-1==h.indexOf(a._hideLayersInLegend,f.id)){var c=this._buildLegendItems(a,f,d);b=b||c}},this):"esri.layers.ArcGISImageServiceLayer"==a.declaredClass&&(b=this._buildLegendItems(a,{id:0,name:null,title:a.name,subLayerIds:null,parentLayerId:-1},0))}else a.renderer&&(f=a.url?a.url.substring(a.url.lastIndexOf("/")+1,a.url.length):"fc_"+a.id,b=this._buildLegendItems(a,{id:f,name:null,subLayerIds:null,parentLayerId:-1},
0));b&&(t.set(g.byId(this.id+"_"+a.id),"display","block"),t.set(g.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(a){if(a.loaded)return 10.01<=a.version?this._legendRequestServer(a):this._legendRequestTools(a);c.connect(a,"onLoad",q.hitch(this,"_legendRequest"))},_legendRequestServer:function(a){var b=a.url,f=b.indexOf("?"),b=-1<f?b.substring(0,f)+"/legend"+b.substring(f):b+"/legend";(f=a._getToken())&&(b+="?token\x3d"+f);var d=q.hitch(this,"_processLegendResponse"),f={f:"json"};
a._params.dynamicLayers&&(f.dynamicLayers=r.stringify(this._createDynamicLayers(a)),"[{}]"===f.dynamicLayers&&(f.dynamicLayers="[]"));a._params.bandIds&&(f.bandIds=a._params.bandIds);a._params.renderingRule&&(f.renderingRule=a._params.renderingRule);return H({url:b,content:f,callbackParamName:"callback",load:function(b,f){d(a,b,f)},error:G.defaults.io.errorHandler})},_legendRequestTools:function(a){var b=a.url.toLowerCase().indexOf("/rest/"),b=a.url.substring(0,b)+a.url.substring(b+5,a.url.length),
b=this._legendUrl+"?soapUrl\x3d"+window.escape(b);if(!k("ie")||8<k("ie"))b+="\x26returnbytes\x3dtrue";var f=q.hitch(this,"_processLegendResponse");return H({url:b,content:{f:"json"},callbackParamName:"callback",load:function(b,n){f(a,b,n)},error:G.defaults.io.errorHandler})},_processLegendResponse:function(a,n){n&&n.layers?(a.legendResponse=n,g.byId(this.id+"_"+a.id)&&b.empty(g.byId(this.id+"_"+a.id)),b.create("span",{innerHTML:this._getServiceTitle(a),"class":"esriLegendServiceLabel"},b.create("td",
{align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",{width:"95%"},g.byId(this.id+"_"+a.id)))))),this._createLegendForLayer(a)):console.log("Legend could not get generated for "+a.url+": "+e.toJson(n))},_buildLegendItems:function(a,n,f){var d=!1,c=g.byId(this.id+"_"+a.id),e=n.parentLayerId;if(n.subLayerIds)a=b.create("div",{id:this.id+"_"+a.id+"_"+n.id+"_group",style:{display:"none"},"class":-1==e?0<f?"esriLegendGroupLayer":"":this._legendAlign},-1==e?c:g.byId(this.id+"_"+a.id+
"_"+e+"_group")),b.create("td",{innerHTML:n.name,align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",{width:"95%","class":"esriLegendLayerLabel"},a))));else{if(a.visibleLayers&&-1==(","+a.visibleLayers+",").indexOf(","+n.id+","))return d;f=b.create("div",{id:this.id+"_"+a.id+"_"+n.id,style:{display:"none"},"class":-1<e?this._legendAlign:""},-1==e?c:g.byId(this.id+"_"+a.id+"_"+e+"_group"));b.create("td",{innerHTML:n.name||"",align:this._align},b.create("tr",{},b.create("tbody",
{},b.create("table",{width:"95%","class":"esriLegendLayerLabel"},f))));a.legendResponse?d=d||this._buildLegendItems_Tools(a,n,f):a.renderer&&(d=d||this._buildLegendItems_Renderer(a,n,f))}return d},_buildLegendItems_Tools:function(a,n,f){var d=n.parentLayerId,c=this.map.getScale(),e=!1,z=function(a,b){var f,n;for(f=0;f<a.length;f++)if(b.dynamicLayerInfos)for(n=0;n<b.dynamicLayerInfos[n].length;n++){if(b.dynamicLayerInfos[n].mapLayerId==a[f].layerId)return a[f]}else if(b.id==a[f].layerId)return a[f];
return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(a,n,c)){var l=!0;if("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISMapServiceLayer"===a.declaredClass){var m=this._getEffectiveScale(a,n);if(m.minScale&&m.minScale<c||m.maxScale&&m.maxScale>c)l=!1}if(l){var c=z(a.legendResponse.layers,n),k=c.legendType,r=c.legend;if(r){f=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f);var q=b.create("tbody",
{},f);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(f,a,n);h.forEach(r,function(b){if(!(10.1<=a.version&&!b.values&&1<r.length&&(a._hideDefaultSymbol||"\x3call other values\x3e"===b.label||!b.label&&!("esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.3<=a.version))))if(b.url&&0===b.url.indexOf("http")||b.imageData&&0<b.imageData.length)e=!0,this._buildRow_Tools(b,q,a,n.id,k)},this)}}}e&&(t.set(g.byId(this.id+"_"+a.id+"_"+n.id),"display","block"),-1<d&&(t.set(g.byId(this.id+"_"+
a.id+"_"+d+"_group"),"display","block"),this._findParentGroup(a.id,a,d)));return e},_buildRow_Tools:function(a,n,f,d,c){var e=b.create("tr",{},n),g;this.alignRight?(n=b.create("td",{align:this._isRightToLeft?"left":"right"},e),g=b.create("td",{align:this._isRightToLeft?"left":"right",width:35},e)):(g=b.create("td",{width:35},e),n=b.create("td",{},e));e=a.url;(!k("ie")||9<=k("ie")||9>k("ie")&&"esri.layers.ArcGISImageServiceLayer"===f.declaredClass)&&a.imageData&&0<a.imageData.length?e="data:image/png;base64,"+
a.imageData:0!==a.url.indexOf("http")&&(e=f.url+"/"+d+"/images/"+a.url,(d=f._getToken())&&(e+="?token\x3d"+d));d=b.create("img",{src:e,border:0,style:"opacity:"+f.opacity},g);a=b.create("td",{innerHTML:a.label,align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",{width:"95%",dir:"ltr"},n))));c&&("Stretched"===c&&10.3<=f.version&&"esri.layers.ArcGISImageServiceLayer"===f.declaredClass)&&(a.style.verticalAlign="top",a.style.lineHeight="1",d.style.marginBottom="-1px",d.style.display=
"block",n.style.verticalAlign="top");9>k("ie")&&(d.style.filter="alpha(opacity\x3d"+100*f.opacity+")")},_buildLegendItems_Renderer:function(a,n,f){var d=n.parentLayerId,c=this.map,e=c.getScale(),z=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(a,n,e)){var l,m=a.renderer,k,r,u,p;if(m instanceof K&&(m=(m="zoom"===m.rangeType?m.getRendererInfoByZoom(c.getZoom()):m.getRendererInfoByScale(e))&&m.renderer,!m))return!1;m.colorInfo&&(m.hasAlphaValues||(k=this._getMedianColor(m)),u=q.isFunction(m.colorInfo.field)?
null:a._getField(m.colorInfo.field,!0));m.proportionalSymbolInfo&&(p=q.isFunction(m.proportionalSymbolInfo.field)?null:a._getField(m.proportionalSymbolInfo.field,!0));if(m instanceof L)z=!0,this._showDotDensityLegend(a,n,m,f);else if(m instanceof M)z=!0,c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f),l=b.create("tbody",{},c),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,n),m.latestObservationRenderer&&m.latestObservationRenderer instanceof C&&
this._buildRow_Renderer(a,m.latestObservationRenderer.symbol,k,m.latestObservationRenderer.label||this.NLS_currentObservations,null,l),m.observationRenderer&&m.observationRenderer instanceof C&&this._buildRow_Renderer(a,m.observationRenderer.symbol,k,m.observationRenderer.label||this.NLS_previousObservations,null,l);else if(m instanceof I){if(m.infos&&0<m.infos.length){z=!0;c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f);l=b.create("tbody",{},c);(a._hoverLabel||
a._hoverLabels)&&this._createHoverAction(c,a,n);var s=[];h.forEach(m.infos,function(b){var f=null;a._editable&&a.types&&(f=this._getTemplateFromTypes(a.types,b.value));var n=b.label;null==n&&(n=b.value);-1===h.indexOf(s,n)&&(s.push(n),this._buildRow_Renderer(a,b.symbol,k,n,f,l))},this)}}else m instanceof J?m.infos&&0<m.infos.length&&(z=!0,c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f),l=b.create("tbody",{},c),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,
a,n),h.forEach(m.infos,function(b){var f=b.label;null==f&&(f=b.minValue+" - "+b.maxValue);this._buildRow_Renderer(a,b.symbol,k,f,null,l)},this)):m instanceof C&&(z=!0,c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},f),l=b.create("tbody",{},c),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,n),r=null,a._editable&&(a.templates&&0<a.templates.length)&&(r=a.templates[0]),c=u&&p?null:u||p,this._buildRow_Renderer(a,m.symbol,k,c?c.alias||c.name:m.label,
r,l),r=m.symbol&&m.symbol.color,c&&(u=p=null));z&&(m.colorInfo&&(!m.hasAlphaValues||r)&&this._showColorRamp(a,n,m,r,f,u),m.proportionalSymbolInfo&&this._showProportionalLegend(a,n,m,k,f,p));!a._hideDefaultSymbol&&m.defaultSymbol&&(z=!0,this._buildRow_Renderer(a,m.defaultSymbol,null,m.defaultLabel||"others",null,l))}z&&(t.set(g.byId(this.id+"_"+a.id+"_"+n.id),"display","block"),-1<d&&(t.set(g.byId(this.id+"_"+a.id+"_"+d+"_group"),"display","block"),this._findParentGroup(a.id,d)));return z},_showColorRamp:function(a,
n,f,d,c,e){var l;l=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);c=b.create("tbody",{},l);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(l,a,n);e&&this._addSubHeader(c,e.alias||e.name);n=this._getRampStops(f,d);n.length&&this._drawColorRamp(c,n,a)},_getMedianColor:function(a){var b=a.colorInfo,f,d;b.colors?(f=b.minDataValue,d=b.maxDataValue):b.stops&&(f=b.stops[0].value,d=b.stops[b.stops.length-1].value);return a.getColor(f+(d-f)/2)},_getRampStops:function(a,
b){var f,d,c=a.colorInfo,e;c.colors||c.alphaValues?(d=c.maxDataValue-c.minDataValue,f=h.map([0,0.25,0.5,0.75,1],function(a){e=c.minDataValue+a*d;return Number(e.toFixed(6))}),this._checkPrecision(0,4,f)):c.stops&&(f=h.map(c.stops,function(a){return a.value}));var g=f[0],k,m;d=f[f.length-1]-g;return h.map(f,function(f){a.hasAlphaValues?(k=new u(b.toRgba()),m=a.getAlpha(f),null!=m&&(k.a=m)):k=a.getColor(f);return{value:f,color:k,offset:1-(f-g)/d,label:l.format(f,{places:20,round:-1}).replace(this.reZerosFractional,
"$1").replace(this.reZeros,"")}},this).reverse()},_checkPrecision:function(a,b,f){var d=a+(b-a)/2,c=f[a],e=f[d],l=f[b],g=Math.floor(c),m=Math.floor(e),h=Math.floor(l);g===c&&(h===l&&m!==e&&g!==m&&h!==m)&&(f[d]=m);a+1!==d&&this._checkPrecision(a,d,f);d+1!==b&&this._checkPrecision(d,b,f)},_drawColorRamp:function(a,d,f){var c=b.create("tr",{},a),e,l,g,r,m,q,p;this.alignRight?(a=b.create("td",{align:this._isRightToLeft?"left":"right"},c),e=b.create("td",{align:this._isRightToLeft?"left":"right",width:34},
c)):(e=b.create("td",{width:34,align:"center"},c),a=b.create("td",{},c));l=b.create("div",{style:"position: relative; width:34px;"},e);g=b.create("div",{"class":"esriLegendColorRamp"},l);c=t.get(g,"width");e=t.get(g,"height");t.set(l,"height",e+"px");g=x.createSurface(g,c,e);9>k("ie")&&(m=g.getEventSource(),t.set(m,"position","relative"),t.set(m.parentNode,"position","relative"));try{q=g.createRect({width:c,height:e}),q.setFill({type:"linear",x1:0,y1:0,x2:0,y2:e,colors:d}).setStroke(null),g.createRect({width:c,
height:e}).setFill(new u([255,255,255,1-f.opacity])).setStroke(null),this._surfaceItems.push(g)}catch(s){g.clear(),g.destroy()}r=b.create("div",{"class":"esriLegendColorRampLabels"},a);h.forEach(d,function(a,f){p="top:"+100*a.offset+"%;";b.create("div",{"class":"esriLegendColorRampTick"+(f===d.length-1?" esriLegendColorRampTickLast":""),innerHTML:"\x26nbsp;",style:p},l);b.create("div",{"class":"esriLegendColorRampLabel",innerHTML:a.label,style:p},r)})},_showDotDensityLegend:function(a,d,f,c){var e=
f.legendOptions,g,l,k,m,r,u,p,t=this.dotDensitySwatchSize,s=Math.round(t/2);e&&(l=e.backgroundColor,k=e.outline,m=e.valueUnit,r=e.dotCoverage);r=(r||this.dotCoverage)/100;p=Math.round(t*t/Math.pow(f.dotSize,2)*r);c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},c);u=b.create("tbody",{},c);(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,d);this._addSubHeader(u,E.substitute({value:f.dotValue,unit:m||""},this.NLS_dotValue));h.forEach(f.fields,function(b){b=
q.mixin({},b);b.numPoints=p;g=new O(f._generateImageSrc(t,t,[b],{x:0,y:0},{x:t,y:t},l),k||f.outline,t,t);b=a._getField(b.name,!0)||b;this._buildRow_Renderer(a,g,null,b.alias||b.name,null,u,{type:"path",path:"M "+-s+","+-s+" L "+s+","+-s+" L "+s+","+s+" L "+-s+","+s+" L "+-s+","+-s+" E"})},this)},_showProportionalLegend:function(a,d,f,c,e,g){var k=f.proportionalSymbolInfo,r=k.legendOptions,r=r&&r.customValues,m,u=k.minDataValue,q=k.maxDataValue,p=this._getProportionalSymbol(f,c);"unknown"!==k.valueUnit||
(!p||!r&&(null==u||null==q))||(c=b.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),m=b.create("tbody",{},c),(a._hoverLabel||a._hoverLabels)&&this._createHoverAction(c,a,d),g&&this._addSubHeader(m,g.alias||g.name),d=r||this._getDataValues(u,q),h.forEach(d,function(b){p=D.fromJson(p.toJson());this._applySize(p,f,b);b=l.format(b,{places:20,round:-1}).replace(this.reZerosFractional,"$1").replace(this.reZeros,"");this._buildRow_Renderer(a,p,null,b,null,m)},this))},
_getProportionalSymbol:function(a,b){var f,d;if(a instanceof C)d=!0,f=a.symbol;else if(a instanceof I||a instanceof J)f=a.infos[0].symbol;if(f=-1!==f.type.indexOf("fillsymbol")?null:f)!d&&"picturemarkersymbol"===f.type?(f=new N,f.setStyle("square"),f.outline.setWidth(1)):f=D.fromJson(f.toJson()),b?f.setColor(new u(b.toRgba())):d||f.setColor(new u([127,127,127]));return f},_applySize:function(a,b,f){var d=a.type;b=b.getSize(f,-1!==d.indexOf("markersymbol")?{shape:a.style}:null);switch(d){case "simplemarkersymbol":a.setSize(b);
break;case "picturemarkersymbol":a.setWidth(b);a.setHeight(b);break;case "simplelinesymbol":case "cartographiclinesymbol":a.setWidth(b)}},_getDataValues:function(a,b){var f=[a,b],d=Math.LN10,c=Math.log(a),e=Math.log(b),g,l,m,k,r;h.forEach([1,2.5,5],function(a){k=Math.log(a);g=Math.ceil((c-k)/d);l=Math.floor((e-k)/d);if(!(Infinity===Math.abs(g)||Infinity===Math.abs(l)))for(m=g;m<l+1;m++)r=a*Math.pow(10,m),-1===h.indexOf(f,r)&&f.push(r)});f.sort(this._sorter);return f.reverse()},_sorter:function(a,
b){return a-b},_buildRow_Renderer:function(a,d,f,c,e,g,l){var k=b.create("tr",{},g),m;this.alignRight?(g=b.create("td",{align:this._isRightToLeft?"left":"right"},k),m=b.create("td",{align:this._isRightToLeft?"left":"right",width:35},k)):(m=b.create("td",{width:35,align:"center"},k),g=b.create("td",{},k));var r=k=30;"simplemarkersymbol"==d.type?(k=Math.min(Math.max(k,d.size+12),125),r=Math.min(Math.max(r,d.size+12),125)):"picturemarkersymbol"==d.type&&(k=Math.min(Math.max(k,d.width),125),r=Math.min(d.height||
r,125));m=b.create("div",{style:"width:"+k+"px;height:"+r+"px;"},m);E.isDefined(c)&&"number"===typeof c&&(c=""+c);b.create("td",{innerHTML:c||"",align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",{width:"95%"},g))));a=this._drawSymbol(m,d,f,k,r,e,a,l);this._surfaceItems.push(a)},_addSubHeader:function(a,d){var f=b.create("tr",{},a),f=b.create("td",{align:this._align,colspan:2},f);b.create("td",{innerHTML:d||"",align:this._align},b.create("tr",{},b.create("tbody",{},b.create("table",
{width:"95%"},f))))},_drawSymbol:function(a,b,f,d,c,e,g,l){b=D.fromJson(b.toJson());var m=g.opacity;f&&b.setColor(new u(f.toRgba()));if("simplelinesymbol"===b.type||"cartographiclinesymbol"===b.type||"textsymbol"===b.type){if(!b.color)return;f=b.color.toRgba();f[3]*=m;b.color.setColor(f)}else if("simplemarkersymbol"===b.type||"simplefillsymbol"===b.type){if(!b.color)return;f=b.color.toRgba();f[3]*=m;b.color.setColor(f);b.outline&&b.outline.color&&(f=b.outline.color.toRgba(),f[3]*=m,b.outline.color.setColor(f))}else"picturemarkersymbol"===
b.type&&(a.style.opacity=m,a.style.filter="alpha(opacity\x3d("+100*m+"))");a=x.createSurface(a,d,c);9>k("ie")&&(f=a.getEventSource(),t.set(f,"position","relative"),t.set(f.parentNode,"position","relative"));e=this._getDrawingToolShape(b,e)||D.getShapeDescriptors(b);var r;try{r=a.createShape(l||e.defaultShape).setFill(e.fill).setStroke(e.stroke)}catch(h){a.clear();a.destroy();return}var p=r.getBoundingBox();l=p.width;e=p.height;var m=-(p.x+l/2),s=-(p.y+e/2);f=a.getDimensions();m={dx:m+f.width/2,dy:s+
f.height/2};if("simplemarkersymbol"===b.type&&"path"===b.style)d=g._getScaleMatrix(p,b.size),r.applyTransform(w.scaleAt(d.xx,d.yy,{x:f.width/2,y:f.height/2}));else if(l>d||e>c)g=l/d>e/c,d=((g?d:c)-5)/(g?l:e),q.mixin(m,{xx:d,yy:d});r.applyTransform(m);return a},_getDrawingToolShape:function(a,b){var d;switch(b?b.drawingTool||null:null){case "esriFeatureEditToolArrow":d={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolTriangle":d={type:"path",
path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":d={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":d={type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":d={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:d,fill:a.getFill(),stroke:a.getStroke()}},_repaintItems:function(){h.forEach(this._surfaceItems,function(a){this._repaint(a)},this)},_repaint:function(a){if(a){a.getStroke&&
a.setStroke&&a.setStroke(a.getStroke());try{a.getFill&&a.setFill&&a.setFill(a.getFill())}catch(b){}a.children&&q.isArray(a.children)&&h.forEach(a.children,this._repaint,this)}},_createHoverAction:function(a,d,f){var e=d._hoverLabel||d._hoverLabels[f.id];e&&(d.mouseMoveHandler=d.mouseMoveHandler||{},d.mouseMoveHandler[f.id]=c.connect(a,"onmousemove",q.hitch(this,function(a,d){this.mouseX=d.clientX;this.mouseY=d.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,t.set(g.byId(this.id+"_hoverLabel"),
"display","none"));setTimeout(q.hitch(this,function(a,d,f){if(a==this.mouseX&&d==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,g.byId(this.id+"_hoverLabel")){var c=g.byId(this.id+"_hoverLabel");c.innerHTML="\x3cspan\x3e"+f+"\x3c/span\x3e";t.set(c,"top",d+"px");t.set(c,"left",a+15+"px");t.set(c,"display","")}else b.create("div",{innerHTML:"\x3cspan\x3e"+f+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:d+"px",left:a+15+"px"}},document.body)},d.clientX,
d.clientY,a),500)},e)),d.mouseOutHandler=d.mouseOutHandler||{},d.mouseOutHandler[f.id]=c.connect(a,"onmouseout",q.hitch(this,function(a){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,t.set(g.byId(this.id+"_hoverLabel"),"display","none"))})))},_removeHoverHandlers:function(){var a;h.forEach(this.layers,function(b){if(b.mouseMoveHandler)for(a in b.mouseMoveHandler)c.disconnect(b.mouseMoveHandler[a]);if(b.mouseOutHandler)for(a in b.mouseOutHandler)c.disconnect(b.mouseOutHandler[a])})},
_createDynamicLayers:function(a){var b=[],d;h.forEach(a.dynamicLayerInfos||a.layerInfos,function(c){d={id:c.id};d.source=c.source&&c.source.toJson();var e;a.layerDefinitions&&a.layerDefinitions[c.id]&&(e=a.layerDefinitions[c.id]);e&&(d.definitionExpression=e);var g;a.layerDrawingOptions&&a.layerDrawingOptions[c.id]&&(g=a.layerDrawingOptions[c.id]);g&&(d.drawingInfo=g.toJson());d.minScale=c.minScale||0;d.maxScale=c.maxScale||0;b.push(d)});return b},_getTemplateFromTypes:function(a,b){var d;for(d=0;d<
a.length;d++)if(a[d].id==b&&a[d].templates&&0<a[d].templates.length)return a[d].templates[0];return null},_findParentGroup:function(a,b,d){var c,e=b.dynamicLayerInfos||b.layerInfos;for(c=0;c<e.length;c++)if(d==e[c].id){-1<e[c].parentLayerId&&(t.set(g.byId(this.id+"_"+a+"_"+e[c].parentLayerId+"_group"),"display","block"),this._findParentGroup(a,b,e[c].parentLayerId));break}},_addSubLayersToHide:function(a){function b(d,c){var e=a.layer.dynamicLayerInfos||a.layer.layerInfos,g,l;for(g=0;g<e.length;g++)if(e[g].id===
d&&e[g].subLayerIds)for(l=0;l<e[g].subLayerIds.length;l++){var k=e[g].subLayerIds[l];-1===h.indexOf(c,k)&&(c.push(k),b(k,c))}}a.layer.layerInfos&&h.forEach(a.layer._hideLayersInLegend,function(d){b(d,a.layer._hideLayersInLegend)})},_isLayerInScale:function(a,b,d){var c,e=!0;if(a.legendResponse&&a.legendResponse.layers)for(c=0;c<a.legendResponse.layers.length;c++){var g=a.legendResponse.layers[c];if(b.id==g.layerId){var l,k;!a.minScale&&0!==a.minScale||!a.maxScale&&0!==a.maxScale?(0==g.minScale&&a.tileInfo&&
(l=a.tileInfo.lods[0].scale),0==g.maxScale&&a.tileInfo&&(k=a.tileInfo.lods[a.tileInfo.lods.length-1].scale)):(l=Math.min(a.minScale,g.minScale)||a.minScale||g.minScale,k=Math.max(a.maxScale,g.maxScale));if(0<l&&l<d||k>d)e=!1;break}}else if(a.minScale||a.maxScale)if(a.minScale&&a.minScale<d||a.maxScale&&a.maxScale>d)e=!1;return e},_getServiceTitle:function(a){var b=a._titleForLegend;b||((b=a.url)?-1<a.url.indexOf("/MapServer")?(b=a.url.substring(0,a.url.indexOf("/MapServer")),b=b.substring(b.lastIndexOf("/")+
1,b.length)):-1<a.url.indexOf("/ImageServer")?(b=a.url.substring(0,a.url.indexOf("/ImageServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):-1<a.url.indexOf("/FeatureServer")&&(b=a.url.substring(0,a.url.indexOf("/FeatureServer")),b=b.substring(b.lastIndexOf("/")+1,b.length)):b="",a.name&&(b=0<b.length?b+(" - "+a.name):a.name));return F.encode(b)},_getEffectiveScale:function(a,b){var d=b.minScale,c=b.maxScale;if(E.isDefined(b.parentLayerId)){var e=a.layerInfos,g=b.parentLayerId,l;for(l=e.length-
1;0<=l;l--)if(e[l].id==g)if(0==d&&0<e[l].minScale?d=e[l].minScale:0<d&&0==e[l].minScale||0<d&&0<e[l].minScale&&(d=Math.min(d,e[l].minScale)),c=Math.max(c||0,e[l].maxScale||0),-1<e[l].parentLayerId)g=e[l].parentLayerId;else break}return{minScale:d,maxScale:c}},_isSupportedLayerType:function(a){return a&&("esri.layers.ArcGISDynamicMapServiceLayer"===a.declaredClass||"esri.layers.ArcGISImageServiceLayer"===a.declaredClass&&10.2<=a.version||"esri.layers.ArcGISTiledMapServiceLayer"===a.declaredClass||
"esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.KMLLayer"===a.declaredClass||"esri.layers.GeoRSSLayer"===a.declaredClass||"esri.layers.WMSLayer"===a.declaredClass||"esri.layers.CSVLayer"===a.declaredClass)?!0:!1}});q.mixin(B,{ALIGN_LEFT:0,ALIGN_RIGHT:1});return B})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(v){var s=v.getObject("dojox.html.entities",!0),q=function(c,e){var h,k;if(e._encCache&&e._encCache.regexp&&e._encCache.mapper&&
e.length==e._encCache.length)h=e._encCache.mapper,k=e._encCache.regexp;else{h={};k=["["];var p;for(p=0;p<e.length;p++)h[e[p][0]]="\x26"+e[p][1]+";",k.push(e[p][0]);k.push("]");k=RegExp(k.join(""),"g");e._encCache={mapper:h,regexp:k,length:e.length}}return c=c.replace(k,function(d){return h[d]})},h=function(c,e){var h,k;if(e._decCache&&e._decCache.regexp&&e._decCache.mapper&&e.length==e._decCache.length)h=e._decCache.mapper,k=e._decCache.regexp;else{h={};k=["("];var p;for(p=0;p<e.length;p++){var d=
"\x26"+e[p][1]+";";p&&k.push("|");h[d]=e[p][0];k.push(d)}k.push(")");k=RegExp(k.join(""),"g");e._decCache={mapper:h,regexp:k,length:e.length}}return c=c.replace(k,function(d){return h[d]})};s.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];s.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],
["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],
["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],
["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],
["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393","Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7",
"Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1",
"thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044","frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203",
"exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],
["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309","rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],
["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019","rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];s.encode=function(c,e){c&&(e?c=q(c,e):(c=q(c,s.html),c=q(c,s.latin)));return c};s.decode=function(c,e){c&&(e?c=h(c,e):(c=h(c,s.html),c=h(c,s.latin)));return c};
return s})},"esri/renderers/ScaleDependentRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(v,s,q,h,c){return v(c,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(c){this.setRendererInfos(c&&c.rendererInfos||[])},setRendererInfos:function(c){this.rendererInfos=c;this._setRangeType();return this},getSymbol:function(c){var h=this.getRendererInfo(c);return h&&h.renderer.getSymbol(c)},getRendererInfo:function(c){c=
c.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(c.getZoom()):this.getRendererInfoByScale(c.getScale())},getRendererInfoByZoom:function(c){var h,k=this.rendererInfos,p,d=0;do h=k[d],c>=h.minZoom&&c<=h.maxZoom&&(p=h),d++;while(!p&&d<k.length);return p},getRendererInfoByScale:function(c){var h,k=this.rendererInfos,p,d=0,r,l,g,b;do h=k[d],r=h.minScale,l=h.maxScale,g=!r,b=!l,!g&&c<=r&&(g=!0),!b&&c>=l&&(b=!0),g&&b&&(p=h),d++;while(!p&&d<k.length);return p},addRendererInfo:function(c){var h,
k=0,p,d=this.rendererInfos,r=c.hasOwnProperty("minZoom")?"minZoom":"minScale",l=d.length;do{p=d[k];if(l===k||c[r]<p[r])d.splice(k,0,c),this._setRangeType(),h=!0;k++}while(!h&&k<l);return this},_setRangeType:function(){var c=this.rendererInfos;if(c=c&&c[0])this.rangeType=c.hasOwnProperty("minZoom")?"zoom":c.hasOwnProperty("minScale")?"scale":""},toJson:function(){}})})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/has ../kernel ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),
function(v,s,q,h,c,e,u,k,p){return v(e,{declaredClass:"esri.renderer.DotDensityRenderer",constructor:function(d){this.dotSize=d.dotSize||3;this.dotValue=d.dotValue;this.fields=d.fields;this.outline=d.outline;this.backgroundColor=d.backgroundColor;this.exactCount=d.exactCount||!0;this.dotShape=d.dotShape||"square";this.legendOptions=d.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=
null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(d){var c,e;this._currentGraphic=d;if(!this._supportsCanvas)return null;this._map||(this._map=d.getLayer()._map,this._objectIdField=d.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",
s.hitch(this,function(d){this._currentMapScale=this._map.getScale();this._currentResolution=d.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][d.attributes[this._objectIdField]])return c=this._symbolMap[this._currentMapScale][d.attributes[this._objectIdField]],e=this._getShapeProperties(d),c.setOffset(e.dx,e.dy),c;c=this._generateFieldsCount(this.fields,d.attributes,this.dotValue);e=this._getShapeProperties(d);
c=new u(this._generateImageSrc(e.width,e.height,c,e.minXY,e.maxXY),this.outline,e.width,e.height);c.setOffset(e.dx,e.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][d.attributes[this._objectIdField]]=c},_generateFieldsCount:function(d,c,e){var g,b;for(b=d.length-1;0<=b;b--)g=c[d[b].name]/e,d[b].numPoints=Math.round(g);return d},_getShapeProperties:function(d){var c,e,g,b;c=d.geometry.getExtent();c.contains(this._map.extent)&&
(c=this._map.extent);g=Math.ceil(c.getWidth()/this._currentResolution);b=Math.ceil(c.getHeight()/this._currentResolution);e=this._map.toScreen(new p(c.xmin,c.ymin,c.spatialReference));c=this._map.toScreen(new p(c.xmax,c.ymax,c.spatialReference));d=d.getLayer().getNode().getCTM();return{minXY:e,maxXY:c,dx:(e.x-d.e)%g,dy:(c.y-d.f)%b,width:g,height:b}},_generateImageSrc:function(d,c,e,g,b,h){var k=this.dotSize,p,q,s;this._canvas?(this._canvas.width=d,this._canvas.height=c):this._canvas=this._initCanvas(d,
c);p=this._canvas.getContext("2d");if(h=h||this.backgroundColor)p.fillStyle=h.toCss(!0),p.fillRect(0,0,d,c),p.fill();for(h=e.length-1;0<=h;h--){p.fillStyle=e[h].color.toCss(!0);for(q=e[h].numPoints-1;0<=q;q--)s=this._getRandomPoint(d,c,g,b),"square"===this.dotShape?p.fillRect(s.x,s.y,k,k):"circle"===this.dotShape&&(p.beginPath(),p.arc(s.x,s.y,k/2,0,2*Math.PI,!0)),p.fill()}return this._canvas.toDataURL()},_initCanvas:function(d,c){var e=q.create("canvas",{id:"canvas",width:d+"px",height:c+"px",style:"position: absolute; left: -10000px; top: 0px;"},
null);document.body.appendChild(e);return e},_getRandomInt:function(d,c){return Math.floor(Math.random()*(c-d+1)+d)},_getRandomPoint:function(d,c,e,g){var b={},h=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&d*c>this._exactCountMinArea){do b.x=this._getRandomInt(e.x,g.x),b.y=this._getRandomInt(g.y,e.y),d=new k(b.x,b.y),d=this._checkPointShapeBounds(d,this.dotSize+h,this._currentGraphic.geometry),!0===d&&(b.x-=e.x,b.y-=g.y);while(!1===d)}else b.x=this._getRandomInt(0,
d),b.y=this._getRandomInt(0,c);return b},_checkPointShapeBounds:function(d,c,e){var g=null,g=!1,b=!0,h=0;do{switch(h){case 1:d.x+=c;break;case 2:d.y+=c;break;case 3:d.x-=c}g=this._map.toMap(d);g=e.contains(g);!1===g&&(b=!1);h+=1}while(3>=h&&!0===b);return g},setDotSize:function(d){0<d&&(this.dotSize=d)},setDotValue:function(d){0<d&&(this.dotValue=d)},setOutline:function(d){this.outline=d},setBackgroundColor:function(d){this.backgroundColor=d},toJson:function(){}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\r\n    \x3cdiv class\x3d"label"\x3e\r\n      \x3cdiv class\x3d"label-left"\x3e${nls.itemOpaque}\x3c/div\x3e\r\n      \x3cdiv class\x3d"label-right"\x3e${nls.itemTransparent}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \r\n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3cdiv\x3e\r\n',
"url:widgets/LayerList/LayerListView.html":'\r\n\r\n\x3ctable class\x3d"layer-list-table"\x3e\r\n  \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e      \r\n\x3c/table\x3e\r\n',"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\r\n    \x3cdiv class\x3d" layer-list-title"\x3e${nls.titleLayers}\x3c/div\x3e\r\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/LayerList/css/style.css":".jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; color: #86909c; margin-top: 14px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{background-color: #ffffff; height: 40px; cursor: pointer;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid #ffffff; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word;}.jimu-widget-layerList .col3{width: 21px;}.jimu-widget-layerList .begin-blank-div{float: left; width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 13px; height: 13px; cursor: pointer; float: left; margin-right: 2px;}.jimu-widget-layerList .showLegend-image{position: relative; top: -1px; left: 3px;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{float: left; width: 33px; text-align: right;}.jimu-widget-layerList .noLegend-image{}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{float: left; position: relative;}.jimu-widget-layerList .div-content{float: left; position: relative; margin-left: 5px; color: #686868; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden;}.jimu-widget-layerList .legend-symbol{float: left;}.jimu-widget-layerList .legend-label{float: left; margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 13px; height: 13px; background-color: #d9dde0; cursor: pointer; border-radius: 2px; float: right; margin-right: 4px;}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #d9dde0; outline-color:#ffffff; outline-style:solid; outline-width:1px; width:184px; height:50px; padding-left: 2%; padding-right: 2%; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-transparency-body .label .label-left{float: left;}.jimu-widget-layerList .popup-menu-transparency-body .label .label-right{float: right;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 13px; height: 13px; min-height: 13px; min-width: 13px; border-radius: 2px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-color: #ffffff; border: 1px solid #ffffff;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; color: #686868; font-size: 12px; z-index: 2; min-width: 119px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{line-height: 25px; white-space: nowrap;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{color:#c1c1c1;}.jimu-widget-layerList .legends-loading-img{width: 30px; height: 30px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}",
"url:widgets/LayerList/config.json":'{\r\n  "showLegend": true\r\n}\r\n',"*now":function(v){v(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-geometry dojo/dom dojo/on dojo/_base/unload dojo/aspect dojo/query jimu/dijit/Selectionbox ./LayerListView ./PopupMenu dojo/dom-style ./NlsStrings jimu/LayerInfos/LayerInfoFactory jimu/LayerInfos/LayerInfos dojo/promise/all".split(" "),function(v,s,q,h,c,e,u,k,p,d,r,l,g,b,t,A,x,w,F){return s([v],{baseClass:"jimu-widget-layerList",name:"layerList",layerListView:null,operLayerInfos:null,startup:function(){A.value=
this.nls;if(this.map.itemId)w.getInstance(this.map,this.map.itemInfo).then(q.hitch(this,function(b){this.operLayerInfos=b;this.showLayers();this.own(k(this.operLayerInfos,"layerInfosChanged",q.hitch(this,this._onLayerInfosChanged)));u.setSelectable(this.layersSection,!1)}));else{var b=this._obtainMapLayers();w.create(this.map,b).then(q.hitch(this,function(b){this.operLayerInfos=b;this.showLayers();this.own(k(this.operLayerInfos,"layerInfosChanged",q.hitch(this,this._onLayerInfosChanged)));u.setSelectable(this.layersSection,
!1)}))}},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var b=[],d=[],c={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};h.forEach(this.map.graphicsLayerIds,function(b){b=this.map.getLayer(b);b.isOperationalLayer&&d.push({layerObject:b,title:b.label||b.title||b.name||b.id||" ",id:b.id||" "})},this);h.forEach(this.map.layerIds,function(c){c=this.map.getLayer(c);c.isOperationalLayer?d.push({layerObject:c,title:c.label||c.title||c.name||c.id||
" ",id:c.id||" "}):b.push({layerObject:c,id:c.id||" "})},this);c.itemData.baseMap.baseMapLayers=b;c.itemData.operationalLayers=d;return c},_layerFilter:function(b,c,d){b=this.map.getLayer(b);b.isOperationalLayer?d.push({layerObject:b,title:b.label||b.title||b.name||b.id||" ",id:b.id||" "}):c.push({layerObject:b,id:b.id||" "})},showLayers:function(){this.layerListView=(new g({operLayerInfos:this.operLayerInfos,layerListWidget:this,config:this.config})).placeAt(this.layerListBody)},_createPopupMenu:function(){this.popupMenu=
new b({layerListWidget:this});c.place(this.popupMenu.domNode,this.domNode)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},flag:!0,bindEvents:function(){var b;this.own(k(this.map,"layer-add-result",q.hitch(this,this._onLayersChange)));b=k(this.map,"layer-remove",q.hitch(this,this._onLayersChange));this.own(b);p.addOnUnload(function(){b.remove();(void 0).remove()})},_onLayersChange:function(b){"esri.layers.GraphicsLayer"!==b.layer.declaredClass&&
(this.operLayerInfos.update(),this._clearLayers(),this.showLayers())},_onLayerInfosChanged:function(b,c){this._clearLayers();this.showLayers()}})});