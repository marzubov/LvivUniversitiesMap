//>>built
require({cache:{"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/dom-style dojo/dom-attr dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/registry jimu/BaseWidgetSetting jimu/dijit/Message esri/SpatialReference esri/geometry/Extent jimu/dijit/ImageChooser jimu/dijit/ExtentChooser dojo/text!./Edit.html".split(" "),function(k,d,f,e,b,l,g,n,h,c,p,x,q,u,m,v,r,s,t){return k([q,p],{baseClass:"jimu-Bookmark-Edit",
ImageChooser:null,templateString:t,extent:{},portalUrl:null,itemId:null,postCreate:function(){this.inherited(arguments);this.imageChooser=new r({displayImg:this.showImageChooser});this.own(b(this.name,"Change",d.hitch(this,"_onNameChange")));e.addClass(this.imageChooser.domNode,"img-chooser");e.place(this.imageChooser.domNode,this.imageChooserBase,"replace");this.own(b(this.imageChooser,"imageChange",d.hitch(this,this.imageChange)));this.own(b(this.thumbnail,"change",d.hitch(this,this.onThumbnailChange)));
g.set(this.showImageChooser,"src",this.folderUrl+"images/thumbnail_default.png")},setConfig:function(a){a.name&&this.name.set("value",a.name);a.thumbnail&&this.thumbnail.set("value",a.thumbnail);this.extentChooser=a.extent?new s({portalUrl:this.portalUrl,itemId:this.itemId,initExtent:new v(a.extent)},this.extentChooserNode):new s({portalUrl:this.portalUrl,itemId:this.itemId},this.extentChooserNode);e.setAttr(this.imageChooserBase,"src",void 0);this.own(b(this.extentChooser,"extentChange",d.hitch(this,
this._onExtentChange)))},getConfig:function(){return{name:this.name.get("value"),extent:this.extentChooser.getExtent(),thumbnail:this.thumbnail.get("value")}},onThumbnailChange:function(){var a=this.thumbnail.get("value");-1<a.indexOf("data:image")?g.set(this.showImageChooser,"src",a):g.set(this.showImageChooser,"src",this.folderUrl+a);a=e.getMarginBox(this.showImageChooser).h;e.setStyle(this.imageChooser.domNode,"height",a+"px")},imageChange:function(a){this.thumbnail.set("value",a)},_onNameChange:function(){this._checkRequiredField()},
_onExtentChange:function(a){this.currentExtent=a},_checkRequiredField:function(){this.name.get("value")?this.popup&&this.popup.enableButton(0):this.popup&&this.popup.disableButton(0)}})})},"jimu/dijit/ImageChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/text!./templates/ImageChooser.html dojo/sniff ../utils jimu/dijit/Message".split(" "),function(k,d,f,e,b,l,g,n,h,c){return k([d,f],{templateString:g,displayImg:null,
displayCss:null,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.imageChooser},postCreate:function(){this._setupPosition();this._setupFileInput()},_setupPosition:function(){this.displayClass&&b.addClass(this.domNode,this.displayCss);b.setStyle(this.domNode,{opacity:0,visibility:"visible","float":"left",zIndex:9999,overflow:"hidden",position:"absolute"});b.setStyle(this.fileInput,{width:"100%",height:"100%",cursor:"pointer"})},_setupFileInput:function(){this.own(l(this.fileInput,
"change",e.hitch(this,function(d){!h.file.supportHTML5()&&!h.file.supportFileAPI()?new c({message:this.nls.unsupportReaderAPI}):h.file.readFile(d,"image/*",1048576,e.hitch(this,function(d,e,f){d?new c({message:this.nls[d.errCode]}):(this.onImageChange(f),this.displayImg&&b.setAttr(this.displayImg,"src",f))}))})))},onImageChange:function(b){}})})},"jimu/dijit/ExtentChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/arcgis/utils esri/geometry/Point esri/geometry/Extent esri/geometry/webMercatorUtils jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/utils".split(" "),
function(k,d,f,e,b,l,g,n,h,c,p,x,q,u,m){return k([g,n],{baseClass:"jimu-extent-chooser",portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=m.getServices().geometryService);this.shelter=new u({hidden:!0});this.shelter.placeAt(this.domNode);
this.shelter.startup();this.shelter.show();var c=f.create("div",{style:{width:"100%",height:"100%"}},this.domNode);if(this.portalUrl&&this.itemId){this.portalUrl=q.getStandardPortalUrl(this.portalUrl);var e={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new p(this.initExtent)),e.mapOptions={extent:this.initExtent});m.createWebMap(this.portalUrl,this.itemId,c,e).then(d.hitch(this,function(c){this.map=
c.map;this.map.webMapResponse=c;this.own(b(this.map,"extent-change",d.hitch(this,function(b){this.onExtentChange(b.extent)})));if(this.initExtent)this.onExtentChange(this.initExtent);else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map)}),d.hitch(this,function(b){console.error(b)}))}},getExtent:function(){return this.map&&this.map.extent},setExtent:function(b){if(this.map)return this.map.setExtent(b);var c=new l;setTimeout(d.hitch(this,function(){c.reject("map is null.")}),
0);return c},restoreToDefaultWebMapExtent:function(){m.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(b){this.emit("extent-change",b)}})})},"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/ImageChooser.html":'\x3cdiv class\x3d"jimu-image-chooser js-fileapi-wrapper"\x3e\r\n  \x3cinput type\x3d"file" accept\x3d"image/png, image/jpeg, image/bmp, image/gif" data-dojo-attach-point\x3d"fileInput"\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv style\x3d"width: 100%"\x3e\r\n  \x3ctable class\x3d"setting-table input-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e*${nls.title}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"name" \r\n            required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.thumbnail}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv style\x3d"display:none"\x3e\x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" \r\n            data-dojo-attach-point\x3d"thumbnail" placeHolder\x3d"images/street.jpg"\r\n            data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n            \x3cimg class\x3d"thumbnail-img" src\x3d"" data-dojo-attach-point\x3d"showImageChooser"\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;(${nls.thumbnailHint})\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e                                                                  \r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e \r\n    \x3cdiv class\x3d"extent-chooser" style\x3d"height: 400px" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"marks-table-div" data-dojo-attach-point\x3d"bookmarksDiv"\x3e\r\n\x3c!-- \x3cdiv class\x3d"bookmark-list" data-dojo-attach-point\x3d"bookmarkListNode"\x3e --\x3e\r\n     \x3cdiv class\x3d\'bookmark-add\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c!--     \x3c/div\x3e --\x3e\r\n\r\n \x3c/div\x3e \r\n\x3c/div\x3e\r\n',
"url:widgets/Bookmark/setting/css/style.css":".jimu-img-node{font-size: 12px; position: relative; float: left; border-radius: 4px; color: #686868; overflow: hidden;}.jimu-img-node .node-box{position: absolute; top: 0; bottom: 32px; left: 0; width: 100%; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{position: absolute; width: 100%; left: 0; bottom: 0; height: 30px; text-align: center;}.jimu-img-node:hover{color: #51b1fe;}.jimu-img-node.jimu-state-selected .node-label{background-color: #d9dde0;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.jimu-widget-bookmark-setting .bookmark-add{float: left; position:relative; width:176px; height:118px; line-height:18px; padding:3px; margin-left: 10px; text-align:center; color:#999999; font-size:16px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 80px; top: 20px; width:20px; height:20px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 50px;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;} .jimu-widget-bookmark-setting .mark-item-div{float: left; position:relative; width:176px; height: 145px; margin-left: 10px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:118px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%; background-repeat:no-repeat; background-position:center center; border:1px solid gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{border:3px solid #15a4fa; -webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{display: none; position:absolute; right:7px; bottom:7px; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; right:7px; top:7px; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.4); background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title{display:inline-block; width:100%; text-align:center; color:#333333; font-size:15px; margin-top: 0px; margin-bottom: 25px;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .thumbnail-img{width: 176px; height: 118px;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 176px; height: 118px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}",
"*now":function(k){k(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/dom-style dojo/dom-attr dojo/query dojo/mouse dojo/aspect dojo/string esri/geometry/Extent jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/Message ./Edit libs/storejs/store".split(" "),function(k,d,f,e,b,l,g,n,h,c,p,x,q,u,m,v,r,s,t){return k([m,d],{baseClass:"jimu-widget-bookmark-setting",bookmarks:[],edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.inherited(arguments);
this.setConfig(this.config)},setConfig:function(a){this.config=a;this.bookmarks=this.config.bookmarks2D;this.map.itemInfo&&(this.map.itemInfo.itemData&&this.map.itemInfo.itemData.bookmarks)&&e.forEach(this.map.itemInfo.itemData.bookmarks,function(a){a.isInWebmap=!0;a.name=a.name;for(var b=0,c=0;c<this.bookmarks.length;c++)this.bookmarks[c].name===a.name&&b++;b||this.bookmarks.push(a)},this);this.currentBookmark=null;this.displayBookmarks()},getConfig:function(a){this.config.bookmarks2D=this.bookmarks;
if(a){a=this._getKeysKey();for(var b in t.getAll())b.startWith(a)&&t.remove(b)}return this.config},displayBookmarks:function(){this._clearBookmarksDiv();this._createmarkItems()},_clearBookmarksDiv:function(){for(var a=c(".mark-item-div",this.domNode),w=0;w<a.length;w++)b.destroy(a[w])},destroy:function(){this.inherited(arguments)},_getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,
{})},getBookmarkByName:function(a){for(var b=this.bookmarks.length,c=0;c<b;c++)if(this.bookmarks[c].name===a)return this.editIndex=c,this.bookmarks[c]},_onEditClick:function(a){this.getBookmarkByName(a);a=this.bookmarks[this.editIndex];this.popupState="EDIT";this._openEdit(this.nls.edit,a)},_openEdit:function(a,c){this.edit=new s({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId});this.edit.setConfig(c||{});this.popup=new v({titleLabel:a,
autoHeight:!0,content:this.edit,container:"main-page",width:640,buttons:[{label:this.nls.ok,key:g.ENTER,disable:!0,onClick:f.hitch(this,"_onEditOk")},{label:this.nls.cancel,key:g.ESCAPE}],onClose:f.hitch(this,"_onEditClose")});b.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(){var a=this.edit.getConfig(),b=null;!a.name||!a.extent?new r({message:this.nls.warning}):("ADD"===this.popupState?(this.bookmarks.push(a),this.displayBookmarks(),b=!0):"EDIT"===this.popupState&&
(this.bookmarks.splice(this.editIndex,1,a),this.displayBookmarks(),b=!0),b?(this.popup.close(),this.popupState="",this.editIndex=null,b=!1):(a=e.mark(b.repeatFields,f.hitch(this,function(a){return a&&a.name})),new r({message:this.nls[b.errorCode]+a.toString()})))},_onEditClose:function(){this.popup=this.edit=null},_createmarkItems:function(){for(var a=0;a<this.bookmarks.length;a++){var c=this._createmarkItem(this.bookmarks[a]);b.place(c,this.bookmarksDiv)}},_createmarkItem:function(a){var d=b.toDom("\x3cdiv class\x3d'mark-item-div'\x3e\x3cdiv class\x3d'mark-item-bg'\x3e\x3cdiv class\x3d'mark-item-thumbnail'\x3e\x3c/div\x3e\x3cdiv class\x3d'mark-item-delete-icon'\x3e\x3c/div\x3e\x3cdiv class\x3d'mark-item-detail-icon'\x3e\x3c/div\x3e\x3cspan class\x3d'mark-item-title'\x3e\x3c/span\x3e\x3c/div\x3e"),
e=c(".mark-item-bg",d)[0],g=c(".mark-item-thumbnail",d)[0],k=c(".mark-item-title",d)[0],h=c(".mark-item-delete-icon",d)[0];this.own(l(h,"click",f.hitch(this,this._onmarkItemDeleteClick)));h=c(".mark-item-detail-icon",d)[0];this.own(l(h,"click",f.hitch(this,this._onmarkItemEditClick)));d.item=a;h=a.thumbnail&&a.thumbnail.startWith("data:")?a.thumbnail:a.thumbnail?this.folderUrl+a.thumbnail:this.folderUrl+"images/thumbnail_default.png";b.setStyle(g,"backgroundImage","url("+h+")");this.own(l(e,"click",
f.hitch(this,this._onmarkItemBgClick)));k.innerHTML=a.name;return d},_clearBasemarksDiv:function(){for(var a=c(".mark-item-div",this.domNode),d=0;d<a.length;d++)b.destroy(a[d])},_onmarkItemBgClick:function(a){a=(a.target||a.srcElement).parentNode;c(".mark-item-bg",this.domNode).removeClass("selected");b.addClass(a,"selected")},_onmarkItemEditClick:function(a){a=c(".mark-item-title",(a.target||a.srcElement).parentNode)[0];this._onEditClick(a.innerHTML)},_onmarkItemDeleteClick:function(a){a=c(".mark-item-title",
(a.target||a.srcElement).parentNode)[0];this.getBookmarkByName(a.innerHTML);null!==this.editIndex&&this.bookmarks.splice(this.editIndex,1);this.displayBookmarks()}})});