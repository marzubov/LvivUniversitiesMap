//>>built
require({cache:{"widgets/Query/Parameters":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./Parameters.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/registry jimu/filterUtils ./SingleParameter".split(" "),function(g,e,p,d,k,h,f,r,c,m,n,q,u){return g([e,p,d],{baseClass:"jimu-widget-query-parameters",templateString:k,nls:null,partsObj:null,layerInfo:null,OPERATORS:null,_filterUtils:null,postCreate:function(){this.inherited(arguments);
this._filterUtils=new q;this.OPERATORS=h.clone(this._filterUtils.OPERATORS);this.partsObj&&this.build(this.partsObj)},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getNewFilterExpr:function(){for(var c=h.mixin({},this.partsObj),d=this._getAllIntractiveSinglePartArray(c),e=0;e<d.length;e++){var a=d[e],l=a.spId;if(l&&(l=m("#"+l,this.tbody)[0])){l=n.byNode(l).getValueObj();if(!l)return null;a.valueObj=l}}return this._filterUtils.getExprByFilterObj(c)},clear:function(){var c=
m(".jimu-widget-query-single-parameter",this.tbody);r.forEach(c,h.hitch(this,function(c){n.byNode(c).destroy()}));f.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(c,d){this.clear();this.partsObj=h.mixin({},c);this.layerInfo=h.mixin({},d);var e=this._getAllIntractiveSinglePartArray(c);r.forEach(e,h.hitch(this,function(a){var c=f.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),c=m("td",c)[0],b=this._getFieldInfo(a.fieldObj.name,this.layerInfo),b=new u({nls:this.nls,
part:a,fieldInfo:b,OPERATORS:this.OPERATORS});b.placeAt(c);b.startup();a.spId=b.id}))},_getFieldInfo:function(c,d){for(var e=d.fields,a=0;a<e.length;a++){var l=e[a];if(c===l.name)return h.mixin({},l)}return null},_getAllIntractiveSinglePartArray:function(c){for(var d=[],e=0;e<c.parts.length;e++){var a=c.parts[e];if(a.parts)for(var l=0;l<a.parts.length;l++){var b=a.parts[l];b.interactiveObj&&d.push(b)}else a.interactiveObj&&d.push(a)}return d}})})},"widgets/Query/SingleParameter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SingleParameter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/json dojo/on dojo/query dojo/Deferred dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox dojo/store/Memory esri/request".split(" "),
function(g,e,p,d,k,h,f,r,c,m,n,q,u,w,t,v,a,l){return g([e,p,d],{baseClass:"jimu-widget-query-single-parameter",templateString:k,fieldInfo:null,part:null,nls:null,OPERATORS:null,_type:-1,postCreate:function(){this.inherited(arguments);this.fieldInfo&&this.part&&this.build(this.fieldInfo,this.part)},getValueObj:function(){var b=this.part.fieldObj.shortType;return"string"===b?this._getStirngValueObj():"number"===b?this._getNumberValueObj():"date"===b?this._getDateValueObj():null},_getStirngValueObj:function(){var b=
null;if(1===this._type){if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;b={};b.value=this.stringTextBox.get("value")}else if(2===this._type){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),null;var b={},a=this._getSelectedFilteringItem(this.stringCodedValuesFS);b.value=a.code}return b},_getNumberValueObj:function(){var b=null;if(1===this._type){if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),
null;b={};b.value=parseFloat(this.numberTextBox.get("value"))}else if(2===this._type){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),null;var b={},a=this._getSelectedFilteringItem(this.numberCodedValuesFS);b.value=parseFloat(a.code)}else if(3===this._type){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),
null;b={};b.value1=parseFloat(this.numberTextBox1.get("value"));b.value2=parseFloat(this.numberTextBox2.get("value"))}return b},_getDateValueObj:function(){var b=null;if(1===this._type){if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;b={};b.value=this.dateTextBox.get("value").toDateString()}else if(2===this._type){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),
null;b={};b.value1=this.dateTextBox1.get("value").toDateString();b.value2=this.dateTextBox2.get("value").toDateString()}return b},build:function(b,a){this.fieldInfo=b;this.part=a;var c=a.interactiveObj;this.promptNode.innerHTML=c.prompt||"";this.hintNode.innerHTML=c.hint||"";c=this.part.fieldObj.shortType;"string"===c?this._buildString(b,this.part):"number"===c?this._buildNumber(b,this.part):"date"===c&&this._buildDate(b,this.part)},_getCodedValues:function(b){var a=null;if((b=b.domain)&&"codedValue"===
b.type&&b.codedValues&&0<b.codedValues.length)a=b.codedValues;return a},_buildString:function(b,c){f.setStyle(this.stringTextBoxContainer,"display","block");f.setStyle(this.numberTextBoxContainer,"display","none");f.setStyle(this.dateTextBoxContainer,"display","none");var d=c.valueObj,e=this._getCodedValues(b);if(e){this._type=2;this._showDijit(this.stringCodedValuesFS);this._hideDijit(this.stringTextBox);var e=r.map(e,h.hitch(this,function(b,a){var c=h.mixin({},b);c.id=a;return c})),l=new a({data:e});
this.stringCodedValuesFS.set("store",l);d&&(l=r.filter(e,h.hitch(this,function(b){return b.code===d.value})),0<l.length?this.stringCodedValuesFS.set("value",l[0].id):this.stringCodedValuesFS.set("value",e[0].id))}else this._type=1,this._showDijit(this.stringTextBox),this._hideDijit(this.stringCodedValuesFS),this.stringTextBox.set("value",d.value||"")},_buildNumber:function(b,c){f.setStyle(this.stringTextBoxContainer,"display","none");f.setStyle(this.numberTextBoxContainer,"display","block");f.setStyle(this.dateTextBoxContainer,
"display","none");var d=c.valueObj,e=c.operator;if(e===this.OPERATORS.numberOperatorIsBetween||e===this.OPERATORS.numberOperatorIsNotBetween)this._type=3,f.setStyle(this.numberRangeTable,"display","table"),this._hideDijit(this.numberTextBox),this._hideDijit(this.numberCodedValuesFS),e=parseFloat(d.value1),d=parseFloat(d.value2),this.numberTextBox1.set("value",e),this.numberTextBox2.set("value",d);else{f.setStyle(this.numberRangeTable,"display","none");var e=parseFloat(d.value),l=this._getCodedValues(c);
if(l)if(this._type=2,this._showDijit(this.numberCodedValuesFS),this._hideDijit(this.numberTextBox),e=r.map(l,h.hitch(this,function(b,a){var c=h.mixin({},b);c.id=a;return c})),l=new a({data:e}),this.numberCodedValuesFS.set("store",l),d&&!isNaN(d.value)){var n=parseFloat(d.value),d=r.filter(e,h.hitch(this,function(b){return parseFloat(b.code)===n}));0<d.length?this.numberCodedValuesFS.set("value",d[0].id):this.numberCodedValuesFS.set("value",e[0].id)}else this.numberCodedValuesFS.set("value",e[0].id);
else this._type=1,this._showDijit(this.numberTextBox),this._hideDijit(this.numberCodedValuesFS),this.numberTextBox.set("value",e)}},_buildDate:function(b,a){f.setStyle(this.stringTextBoxContainer,"display","none");f.setStyle(this.numberTextBoxContainer,"display","none");f.setStyle(this.dateTextBoxContainer,"display","block");var c=a.valueObj,d=a.operator;d===this.OPERATORS.dateOperatorIsBetween||d===this.OPERATORS.dateOperatorIsNotBetween?(this._type=2,f.setStyle(this.dateRangeTable,"display","table"),
this._hideDijit(this.dateTextBox),this.dateTextBox1.set("value",new Date(c.value1)),this.dateTextBox2.set("value",new Date(c.value2))):(this._type=1,f.setStyle(this.dateRangeTable,"display","none"),this._showDijit(this.dateTextBox),this.dateTextBox.set("value",new Date(c.value)))},_getSelectedFilteringItem:function(b){if(b.validate()){var a=b.get("value");if(isNaN(a))this._showValidationErrorTip(b);else if(b=b.store.query({id:a}),0<b.length&&(b=b[0]))return b}else this._showValidationErrorTip(b);
return null},_showValidationErrorTip:function(b){!b.validate()&&b.domNode&&b.focusNode&&(b.focusNode.focus(),b.focusNode.blur())},_showDijit:function(b){b&&b.domNode&&f.setStyle(b.domNode,"display","inline-block")},_hideDijit:function(b){b&&b.domNode&&f.setStyle(b.domNode,"display","none")},_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var b=parseFloat(this.numberTextBox1.get("value")),a=parseFloat(this.numberTextBox2.get("value"));b>a&&(this.numberTextBox1.set("value",
a),this.numberTextBox2.set("value",b))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var b=this.dateTextBox1.get("value"),a=b.getTime(),c=this.dateTextBox2.get("value"),d=c.getTime();a>d&&(this.dateTextBox1.set("value",c),this.dateTextBox2.set("value",b))}}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(g,e,p,d,k){return g("dijit.form.FilteringSelect",
[d,k],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(d,e,k,c){e&&e[this.searchAttr]!==this._lastQuery||!e&&d.length&&this.store.getIdentity(d[0])!=this._lastQuery||(d.length?this.set("item",d[0],c):this.set("value","",c||void 0===c&&!this.focused,this.textbox.value,null))},_openResultList:function(d,
e,k){e[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(d,f,k,c){this._onChangeActive||(f=null);if(void 0===c){if(null===d||""===d)if(d="",!e.isString(k)){this._setDisplayedValueAttr(k||"",f);return}var m=this;this._lastQuery=d;p(this.store.get(d),function(c){m._callbackSetLabel(c?[c]:[],void 0,void 0,f)})}else this.valueNode.value=
d,this.inherited(arguments,[d,f,k,c])},_setItemAttr:function(d,e,k){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(d){return d.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(d,k){null==d&&(d="");if(!this._created){if(!("displayedValue"in this.params))return;k=!1}if(this.store){this.closeDropDown();var g=e.clone(this.query),c=this._getDisplayQueryString(d),m;this.store._oldAPI?m=c:(m=this._patternToRegExp(c),m.toString=function(){return c});
this._lastQuery=g[this.searchAttr]=m;this._lastDisplayedValue=this.textbox.value=d;this._set("displayedValue",d);var n=this,q={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};e.mixin(q,this.fetchProperties);this._fetchHandle=this.store.query(g,q);p(this._fetchHandle,function(c){n._fetchHandle=null;n._callbackSetLabel(c||[],g,q,k)},function(c){n._fetchHandle=null;n._cancelingQuery||console.error("dijit.form.FilteringSelect: "+c.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},
"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(g,e,p){return g("dijit.form.DateTextBox",p,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:e,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(g,e,p,d,k,h,f,r,c,m,n,q,u,w,t,v,a){var l=d("dijit.Calendar",[u,w,t],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(b){r.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",b)},_createMonthWidget:function(){return new l._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:m.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(n(this.domNode,"keydown",m.hitch(this,"_onKeyDown")),n(this.dateRowsNode,"mouseover",m.hitch(this,"_onDayMouseOver")),n(this.dateRowsNode,"mouseout",m.hitch(this,"_onDayMouseOut")),n(this.dateRowsNode,"mousedown",m.hitch(this,"_onDayMouseDown")),n(this.dateRowsNode,"mouseup",m.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(b){var a=
new this.dateClassObj(this.currentFocus);a.setDate(1);a.setMonth(b);b=this.dateModule.getDaysInMonth(a);var c=this.currentFocus.getDate();a.setDate(Math.min(c,b));this._setCurrentFocusAttr(a)},_onDayMouseOver:function(b){if((b=h.contains(b.target,"dijitCalendarDateLabel")?b.target.parentNode:b.target)&&(b.dijitDateValue&&!h.contains(b,"dijitCalendarDisabledDate")||b==this.previousYearLabelNode||b==this.nextYearLabelNode))h.add(b,"dijitCalendarHoveredDate"),this._currentNode=b},_onDayMouseOut:function(b){this._currentNode&&
!(b.relatedTarget&&b.relatedTarget.parentNode==this._currentNode)&&(b="dijitCalendarHoveredDate",h.contains(this._currentNode,"dijitCalendarActiveDate")&&(b+=" dijitCalendarActiveDate"),h.remove(this._currentNode,b),this._currentNode=null)},_onDayMouseDown:function(b){if((b=b.target.parentNode)&&b.dijitDateValue&&!h.contains(b,"dijitCalendarDisabledDate"))h.add(b,"dijitCalendarActiveDate"),this._currentNode=b},_onDayMouseUp:function(b){(b=b.target.parentNode)&&b.dijitDateValue&&h.remove(b,"dijitCalendarActiveDate")},
handleKey:function(b){var a=-1,d,e=this.currentFocus;switch(b.keyCode){case c.RIGHT_ARROW:a=1;case c.LEFT_ARROW:d="day";this.isLeftToRight()||(a*=-1);break;case c.DOWN_ARROW:a=1;case c.UP_ARROW:d="week";break;case c.PAGE_DOWN:a=1;case c.PAGE_UP:d=b.ctrlKey||b.altKey?"year":"month";break;case c.END:e=this.dateModule.add(e,"month",1),d="day";case c.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}d&&(e=this.dateModule.add(e,d,a));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(b){this.handleKey(b)||
(b.stopPropagation(),b.preventDefault())},onValueSelected:function(){},onChange:function(b){this.onValueSelected(b)},getClassForDate:function(){}});l._MonthDropDownButton=d("dijit.Calendar._MonthDropDownButton",a,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new l._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(b){var a=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.dropDown.set("months",
a);this.containerNode.innerHTML=(6==q("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+a[b.getMonth()]+"\x3c/div\x3e"}});l._MonthDropDown=d("dijit.Calendar._MonthDropDown",[w,v,t],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'onclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(b){this.domNode.innerHTML="";g.forEach(b,
function(b,a){f.create("div",{className:"dijitCalendarMonthLabel",month:a,innerHTML:b},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(b){this.onChange(k.get(b.target,"month"))},onChange:function(){}});return l})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(g,e,p,d,k,h,f,r,c,m,n,q,u,w,t){var v=e("dijit.CalendarLite",[u,w],{templateString:t,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var c=new this.dateClassObj(a);
c.setHours(0,0,0,0);c.getDate()<a.getDate()&&(c=this.dateModule.add(c,"hour",1));return c}return null},_setValueAttr:function(a,c){"string"==typeof a&&(a=h.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(c||"undefined"==typeof c))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),
a.setHours(1,0,0,0));return a},_setText:function(a,c){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(c))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),c=a.getDay(),b=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,n=p.getFirstDayOfWeek(this.lang);n>c&&(n-=7);if(!this.summary){var m=this.dateLocaleModule.getNames("months",
"wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",m[a.getMonth()])}this._date2cell={};g.forEach(this.dateCells,function(m,k){var f=k+n,h=new this.dateClassObj(a),g="dijitCalendar",q=0;f<c?(f=d-c+f+1,q=-1,g+="Previous"):f>=c+b?(f=f-c-b+1,q=1,g+="Next"):(f=f-c+1,g+="Current");q&&(h=this.dateModule.add(h,"month",q));h.setDate(f);this.dateModule.compare(h,e,"date")||(g="dijitCalendarCurrentDate "+g);this.isDisabledDate(h,this.lang)?(g="dijitCalendarDisabledDate "+g,m.setAttribute("aria-disabled",
"true")):(g="dijitCalendarEnabledDate "+g,m.removeAttribute("aria-disabled"),m.setAttribute("aria-selected","false"));(q=this.getClassForDate(h,this.lang))&&(g=q+" "+g);m.className=g+"Month dijitCalendarDateTemplate";g=h.valueOf();0==k&&console.log("setting date2cell["+g+"]");this._date2cell[g]=m;m.dijitDateValue=g;this._setText(this.dateLabels[k],h.getDateLocalized?h.getDateLocalized(this.lang):h.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);
this.monthWidget.set("month",a);var c=a.getFullYear()-1,b=new this.dateClassObj;g.forEach(["previous","current","next"],function(a){b.setFullYear(c++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(b,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?c.getObject(a.datePackage,!1):d;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?c.getObject(a.datePackage+
".locale",!1):k},_createMonthWidget:function(){return v._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),b=p.getFirstDayOfWeek(this.lang);this.dayCellsHtml=q.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return c[b++%7]});a=q.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=
[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);f.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=c.hitch(this,function(a,b,d){return m(this[a],"click",c.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,d))}))});this.own(a("incrementMonth",
"month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,c){var b=this.currentFocus,d=this._getNodeByDate(b);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(b,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);b=this._getNodeByDate(a);b.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&b.focus();d&&d!=b&&(n("webkit")?
d.setAttribute("tabIndex","-1"):d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!r.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function d(a,c){r.toggle(c,"dijitCalendarSelectedDate",
a);c.setAttribute("aria-selected",a?"true":"false")}g.forEach(this._selectedCells||[],c.partial(d,!1));this._selectedCells=g.filter(g.map(a,this._getNodeByDate,this),function(a){return a});g.forEach(this._selectedCells,c.partial(d,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});v._MonthWidget=e("dijit.CalendarLite._MonthWidget",u,{_setMonthAttr:function(a){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),b=6==n("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+
g.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=b+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+c[a.getMonth()]+"\x3c/div\x3e"}});return v})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(g,e,p,d,k,h,f,r){new Date("X");return d("dijit.form._DateTimeTextBox",
[h,f],{templateString:r,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:e.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(c,d){var e=this._isInvalidDate(c),k=this._isInvalidDate(d);if(e||k)return e&&k?0:!e?1:-1;var e=this.format(c,this._unboundedConstraints),k=this.format(d,this._unboundedConstraints),h=this.parse(e,this._unboundedConstraints),f=this.parse(k,this._unboundedConstraints);
return e==k?0:g.compare(h,f,this._selector)},autoWidth:!0,format:function(c,d){return!c?"":this.dateLocaleModule.format(c,d)},parse:function(c,d){return this.dateLocaleModule.parse(c,d)||(this._isEmpty(c)?null:void 0)},serialize:function(c,d){c.toGregorian&&(c=c.toGregorian());return p.toISOString(c,d)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(c){this.dateModule=c.datePackage?k.getObject(c.datePackage,!1):g;this.dateClassObj=
this.dateModule.Date||Date;this.dateLocaleModule=c.datePackage?k.getObject(c.datePackage+".locale",!1):e;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(c){c.selector=this._selector;c.fullYear=!0;var d=
p.fromISOString;"string"==typeof c.min&&(c.min=d(c.min));"string"==typeof c.max&&(c.max=d(c.max));this.inherited(arguments);this._unboundedConstraints=k.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(c){return!c||isNaN(c)||"object"!=typeof c||c.toString()==this._invalidDate},_setValueAttr:function(c,d,e){void 0!==c&&("string"==typeof c&&(c=p.fromISOString(c)),this._isInvalidDate(c)&&(c=null),c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c)));
this.inherited(arguments);this.value instanceof Date&&(this.filterString="");this.dropDown&&this.dropDown.set("value",c,!1)},_set:function(c,d){var e=this._get("value");"value"==c&&e instanceof Date&&0==this.compare(d,e)||this.inherited(arguments)},_setDropDownDefaultValueAttr:function(c){this._isInvalidDate(c)&&(c=new this.dateClassObj);this._set("dropDownDefaultValue",c)},openDropDown:function(c){this.dropDown&&this.dropDown.destroy();var d=k.isString(this.popupClass)?k.getObject(this.popupClass,
!1):this.popupClass,e=this,g=this.get("value");this.dropDown=new d({onChange:function(c){e.set("value",c,!0)},id:this.id+"_popup",dir:e.dir,lang:e.lang,value:g,textDir:e.textDir,currentFocus:!this._isInvalidDate(g)?g:this.dropDownDefaultValue,constraints:e.constraints,filterString:e.filterString,datePackage:e.params.datePackage,isDisabledDate:function(c){return!e.rangeCheck(c,e.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(c,
d){this._setValueAttr(this.parse(c,this.constraints),d,c)}})})},"widgets/Query/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Query/Parameters.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\r\n    \x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',"url:widgets/Query/SingleParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"100px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"display:none;width:100%;height:25px;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;height:25px;"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"display:none;width:100%;height:25px;" /\x3e\r\n\r\n              \x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;height:25px;"\x3e\x3c/div\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;height:25px;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;height:25px;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n              \x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'required:true, trim:true, constraints:{datePattern:"yyyy-MM-dd"}\' class\x3d"dijit-form-DateTextBox" style\x3d"display:none;width:100%;height:25px;" /\x3e\r\n\r\n              \x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                \x3ctbody\x3e\r\n                  \x3ctr\x3e\r\n                    \x3ctd style\x3d"width:40%;"\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true,constraints:{datePattern: "yyyy-MM-dd"}\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;height:25px;" /\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n                      \x3cspan\x3e${nls.and}\x3c/span\x3e\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                      \x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true,constraints:{datePattern: "yyyy-MM-dd"}\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;height:25px;" /\x3e\r\n                    \x3c/td\x3e\r\n                  \x3c/tr\x3e\r\n                \x3c/tbody\x3e\r\n              \x3c/table\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" class\x3d"dijitCalendarContainer" role\x3d"grid" aria-labelledby\x3d"${id}_mddb ${id}_year" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\x3cthead\x3e\r\n\t\t\x3ctr class\x3d"dijitReset dijitCalendarMonthContainer" valign\x3d"top"\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' data-dojo-attach-point\x3d"decrementMonth" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset\' colspan\x3d"5" scope\x3d"col"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode"\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\t\x3cth class\x3d\'dijitReset dijitCalendarArrow\' scope\x3d"col" data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\t\x3cspan class\x3d"dijitInline dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\t\x3c/th\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t${!dayCellsHtml}\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/thead\x3e\r\n\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t${!dateRowsHtml}\r\n\t\x3c/tbody\x3e\r\n\t\x3ctfoot class\x3d"dijitReset dijitCalendarYearContainer"\x3e\r\n\t\t\x3ctr\x3e\r\n\t\t\t\x3ctd class\x3d\'dijitReset\' valign\x3d"top" colspan\x3d"7" role\x3d"presentation"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/td\x3e\r\n\t\t\x3c/tr\x3e\r\n\t\x3c/tfoot\x3e\r\n\x3c/table\x3e\r\n',
"url:widgets/Query/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"query-widget-content"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"queryList" class\x3d"query-step query-list"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"queriesNode" class\x3d"queries"\x3e\r\n        \x3cdiv class\x3d"execute-tip"\x3e\r\n          ${nls.executeQueryTip}\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"queries-table-container"\x3e\r\n          \x3ctable data-dojo-attach-event\x3d"onclick:_onQueryListClicked" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"queries-table" onselectstart\x3d"return false;"\x3e\r\n            \x3ccolgroup\x3e\r\n              \x3ccol width\x3d"14px;"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n              \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n            \x3c/colgroup\x3e\r\n            \x3ctbody data-dojo-attach-point\x3d"queriesTbody"\x3e\r\n            \x3c/tbody\x3e\r\n          \x3c/table\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"invalidConfigNode" class\x3d"invalid-config"\x3e\r\n        \x3cdiv class\x3d"error"\x3e\r\n          ${nls.invalidConfig}\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noQueryTipSection" class\x3d"no-query-tip"\x3e\r\n        ${nls.noneQueryTip}\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"queryParams" class\x3d"query-step query-params"\x3e\r\n      \x3cdiv class\x3d"step-head query-params-head"\x3e\r\n        \x3cdiv class\x3d"step-title params-title"\x3e${nls.queryParams}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back" data-dojo-attach-event\x3d"onclick:_onBtnParamsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip"\x3e${nls.queries}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"apply" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"onclick:_onBtnApplyClicked"\x3e${nls.apply}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"params-container" data-dojo-attach-point\x3d"paramsContainer"\x3e\r\n        \x3cdiv class\x3d"attributes-section" data-dojo-attach-point\x3d"parametersDiv"\x3e\r\n          \x3cspan style\x3d"display:block;margin-bottom:10px;"\x3e${nls.specifyParamsTip} :\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"spatial-section" style\x3d"margin-top:20px; margin-bottom:20px;"\x3e\r\n          \x3cdiv\x3e\r\n            \x3cinput type\x3d"checkbox" checked\x3d"false" data-dojo-attach-point\x3d"cbxUseSpatial" data-dojo-attach-event\x3d"onclick: _onCbxUseSpatialClicked" /\x3e\r\n            \x3cspan\x3e${nls.useSpatialFilter}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"selectSpatialDiv" style\x3d"margin-left:7px; margin-top:7px;"\x3e\r\n            \x3ctable class\x3d"current-view" valign\x3d"top" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd\x3e\r\n                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"cbxUseMapExtent" checked data-dojo-attach-event\x3d"onclick:_onCbxUseMapExtentClicked" /\x3e  \r\n                  \x3c/td\x3e\r\n                  \x3ctd style\x3d"padding-left:8px;"\x3e\r\n                    \x3cspan class\x3d"map-extent-tip"\x3e${nls.useCurrentMapExtent}\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd style\x3d"padding-top:5px;"\x3e\r\n                    \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"cbxDrawGraphic" data-dojo-attach-event\x3d"onclick:_onCbxDrawGraphicClicked" /\x3e\r\n                  \x3c/td\x3e\r\n                  \x3ctd style\x3d"padding-top:5px;padding-left:8px;"\x3e\r\n                    \x3cspan class\x3d"draw-graphic-tip"\x3e${nls.drawGraphicOnMap}\x3c/span\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n            \x3cdiv class\x3d"draw-graphic" data-dojo-attach-point\x3d"drawBoxDiv"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"operational"\x3e\r\n          \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"cbxOperational" checked\x3d"false" /\x3e\r\n          \x3cspan\x3e${nls.operationalLayerTip}\x3c/span\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"operationalTipDiv" style\x3d"width:auto;margin-top:5px;margin-left:15px;color:#ccc;"\x3e${nls.operationalTip}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"queryResults" class\x3d"query-step query-results"\x3e\r\n      \x3cdiv class\x3d"step-head query-results-head"\x3e\r\n        \x3cdiv class\x3d"step-title results-title"\x3e${nls.queryResults}\x3c/div\x3e\r\n        \x3cdiv class\x3d"operations"\x3e\r\n          \x3cdiv class\x3d"params-back" data-dojo-attach-event\x3d"onclick:_onBtnResultsBackClicked"\x3e\r\n            \x3cdiv class\x3d"back-icon"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"back-tip"\x3e${nls.parameters}\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-number" data-dojo-attach-point\x3d"resultsNumberDiv"\x3e\r\n        \x3cspan\x3e${nls.numberFound}: \x3c/span\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"numSpan"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"results-container" data-dojo-attach-point\x3d"resultsContainer" data-dojo-attach-event\x3d"onscroll:_onResultsScroll" onselectstart\x3d"return false;"\x3e\r\n        \x3ctable data-dojo-attach-point\x3d"resultsTable" valign\x3d"top" class\x3d"results-table" data-dojo-attach-event\x3d"onclick:_onResultsTableClicked" cellpadding\x3d"0" cellspacing\x3d"0" \x3e\r\n          \x3ctbody data-dojo-attach-point\x3d"resultsTbody"\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"btn-section"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"btnClearAll" data-dojo-attach-event\x3d"onclick:_onBtnClearAllClicked" class\x3d"jimu-btn btn-clear-all" \x3e${nls.clearResults}\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Query/css/style.css":".jimu-widget-query{position: relative; width: 100%; height: 100%; min-width: 222px; min-height: 237px; overflow-x: hidden;}.jimu-widget-query .query-widget-content{position: absolute; width: 100%; left: 0; right: 0; height: auto; top: 0; bottom: 60px;}.jimu-widget-query .btn-section{position: absolute; width: 100%; left: 0; right: 0; bottom: 0; height: auto; text-align: center;}.jimu-widget-query .btn-section .btn-clear-all{margin-left: auto; margin-right: auto; color: #528cc9; background: transparent;}.jimu-widget-query .query-step{position: absolute; width: 100%; height: 100%; top: 0;}.jimu-widget-query .query-list{left: 0;}.jimu-widget-query .query-list .queries{position: absolute; width: 100%; height: 100%; left: 0; top: 0; overflow-y: auto;}.jimu-widget-query .query-list .queries .execute-tip{line-height: 20px; color: #66696c; font-size: 14px;}.jimu-widget-query .query-list .queries .queries-table-container{width: 100%; margin-top: 15px;}.jimu-widget-query .query-list .queries .queries-table{width: 100%; border-collapse: collapse; table-layout: fixed;}.jimu-widget-query .query-list .queries .queries-table td{height: 30px; line-height: 30px; cursor: pointer;}.jimu-widget-query .query-list .queries .queries-table tr *{cursor: pointer;}.jimu-widget-query .query-list .queries .queries-table .second-td{color: #686868; font-size: 12px;}.jimu-widget-query .query-list .queries .queries-table .query-name-div{width: 100%; overflow: hidden; text-overflow: ellipsis; height: 100%;}.jimu-widget-query .query-list .queries .queries-table .third-td .arrow{background-repeat: no-repeat; background-position: center; background-image: url(images/arrow_right1.png); width: 100%; height: 100%;}.jimu-widget-query .query-list .queries .queries-table\x3etbody\x3etr.selected td{background: #d9dde0;}.jimu-widget-query .query-list .queries .queries-table\x3etbody\x3etr:hover td{background: #d9dde0; border-top: 1px solid #ffffff;}.jimu-widget-query .query-list .queries .queries-table\x3etbody\x3etr.selected .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-widget-query .query-list .queries .queries-table\x3etbody\x3etr:hover .third-td .arrow{background-image: url(images/arrow_right2.png);}.jimu-widget-query .query-list .invalid-config{display: none; position: absolute; width: 100%; height: 100%; left: 0; top: 0;}.jimu-widget-query .query-list .no-query-tip{display: none; line-height: 20px; color: #66696c; font-size: 14px;}.jimu-widget-query .step-head{position: relative; width: 100%; height: 30px; line-height: 30px;}.jimu-widget-query .step-title{position: absolute; width: 100%; height: 100%; left: 0; top: 0; text-align: center; font-size: 14px; color: #86909c;}.jimu-widget-query .step-head .operations{position: absolute; width: 100%; height: 100%; left: 0; top: 0;}.jimu-widget-query .step-head .operations .params-back{float: left; text-align: left; color: blue; cursor: pointer; height: 100%;}.jimu-widget-query .step-head .operations .params-back .back-icon{float: left; width: 8px; height: 100%; background:no-repeat no-repeat center center url(images/arrow_left.png); margin-right: 5px;}.jimu-widget-query .step-head .operations .params-back .back-tip{float: left; height: 100%; color: #51b1fe; text-decoration: underline;}.jimu-widget-query .query-params{left: 100%;}.jimu-widget-query .query-params .query-params-head .operations .apply{float: right; text-align: right; cursor: pointer; height: 100%; color: #51b1fe; text-decoration: underline;}.jimu-widget-query .query-params .params-container{position: absolute; width: 100%; left: 0; top: 40px; bottom: 0; overflow-y: auto;}.jimu-widget-query .query-params table.current-view{width: auto; border-collapse: collapse; margin-top: 10px;}.jimu-widget-query .query-params table.current-view td{vertical-align: top; text-align: left;}.jimu-widget-query .query-params .draw-graphic{margin-top:5px;}.jimu-widget-query .query-results{left: 200%;}.jimu-widget-query .query-results .query-results-head .clear{float: right; text-align: right; color: blue; cursor: pointer;}.jimu-widget-query .query-results .results-container{position: absolute; width: 100%; left: 0; top: 50px; bottom: 0; overflow-x: hidden; overflow-y: auto;}.jimu-widget-query .query-results .results-table{table-layout: fixed; width: 100%; border-collapse: collapse;}.jimu-widget-query .query-results .feature-attributes{max-width: 100%; border-collapse: collapse;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd{padding-left: 15px; padding-top: 12px; padding-bottom: 12px; cursor: pointer;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item.even\x3etd{background-color: #f0f0f0;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item.odd\x3etd{background-color: #ffffff;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item.selected\x3etd{background-color: #D9DDE0;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd:hover{background-color: #D9DDE0;}.jimu-widget-query .query-results .results-table\x3etbody\x3etr.query-result-item\x3etd .feature-attributes{margin-top: 4px;}.jimu-widget-query .query-results .query-result-item td.attr-name{padding: 2px 5px 5px 2px; color: #888888;}.jimu-widget-query .query-results .query-result-item td.attr-value{padding: 2px 0 5px 2px;}.jimu-widget-query-single-parameter .dijit-form-Select\x3etbody\x3etr\x3etd{height: 23px;}.jimu-widget-query-single-parameter .dijit-form-Select\x3etbody\x3etr\x3etd\x3e.dijitButtonText{height: 20px; height: 20px !important;}.jimu-widget-query-single-parameter .dijit-form-FilteringSelect\x3ediv.dijitArrowButton.dijitDownArrowButton{width:20px; height: 100%;}.jimu-widget-query-single-parameter .dijit-form-FilteringSelect\x3ediv.dijitArrowButton.dijitDownArrowButton\x3einput{padding: 0; border: 0; display: inline-block; height: 100%; height: 100% !important;}.jimu-widget-query-single-parameter .dijit-form-FilteringSelect\x3ediv.dijitInputField\x3einput.dijitInputInner{height: 20px;}.jimu-widget-query-single-parameter .dijit-form-ValidationTextBox\x3ediv.dijitInputField\x3einput.dijitInputInner{margin: 0; padding:0; height: 100%; height: 100% !important;}.jimu-widget-query-single-parameter .dijit-form-NumberTextBox\x3ediv.dijitInputField\x3einput.dijitInputInner{margin: 0; padding: 0; height: 100%; padding:0 !important; height: 100% !important;}.jimu-widget-query-single-parameter .dijit-form-DateTextBox\x3e.dijitRight{width:17px; width:17px !important;}.jimu-widget-query-single-parameter .dijit-form-DateTextBox\x3ediv.dijitInputField\x3einput.dijitInputInner{margin: 0; padding: 0; height: 100%; padding:0 !important; height: 100% !important;}.jimu-widget-query-single-parameter .dijitSelectLabel.dijitValidationTextBoxLabel{width:52px; max-width:52px; overflow:hidden; max-width:52px !important; overflow:hidden !important;}.jimu-widget-query-single-parameter .prompt{font-size: 12px; color: #686868;}.jimu-widget-query-single-parameter .hint{font-style: italic; font-size: 12px; color: #d9dde0; margin-top: 5px;}",
"url:widgets/Query/config.json":'{\r\n  "queries": []\r\n}',"*now":function(g){g(['dojo/i18n!*preload*widgets/Query/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/query dojo/_base/html dojo/_base/array dojo/_base/fx dojo/promise/all dojo/on dojo/Deferred dijit/_WidgetsInTemplateMixin jimu/BaseWidget jimu/dijit/Message jimu/dijit/LoadingShelter jimu/dijit/DrawBox jimu/utils ./Parameters esri/tasks/query esri/tasks/QueryTask esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/renderers/SimpleRenderer esri/graphic esri/geometry/Point esri/geometry/Polyline esri/geometry/Extent esri/InfoTemplate esri/symbols/jsonUtils esri/lang esri/request esri/graphicsUtils".split(" "),function(g,
e,p,d,k,h,f,r,c,m,n,q,u,w,t,v,a,l,b,z,A,E,H,F,G,B,x,y,C,D){return g([n,m],{name:"Query",baseClass:"jimu-widget-query",isValidConfig:!1,currentAttrs:null,tempResultLayer:null,operationalLayers:[],_resetCurrentAttrs:function(){this.currentAttrs={queryTr:null,config:null,layerInfo:null,askForValues:null,query:{maxRecordCount:1E3,resultLayer:null,where:"",nextIndex:0,objectIds:[]}}},postMixInProperties:function(){this.inherited(arguments);this.nls.operationalTip=y.substitute({clearResults:this.nls.clearResults},
this.nls.operationalTip)},postCreate:function(){this.inherited(arguments);this._initDrawBox();this._resetAndAddTempResultLayer();this._initSelf()},onOpen:function(){this.tempResultLayer&&this.tempResultLayer.show()},onClose:function(){this.tempResultLayer&&this.tempResultLayer.hide();this._hideInfoWindow();this._resetDrawBox();this.inherited(arguments)},destroy:function(){this._hideInfoWindow();this._resetDrawBox();this._removeAllResultLayers(!0);this.inherited(arguments)},_resetAndAddTempResultLayer:function(){this._removeTempResultLayer();
this.tempResultLayer=new b;this.map.addLayer(this.tempResultLayer)},_removeTempResultLayer:function(){this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null},_removeAllResultLayers:function(a){this._hideInfoWindow();this._removeTempResultLayer();this._removeAllOperatonalLayers();this._clearResultPage();a||this._fromCurrentPageToQueryList()},_fromCurrentPageToQueryList:function(){d.setStyle(this.queryList,"display","block");"block"===d.getStyle(this.queryParams,
"display")?(this._slide(this.queryList,-100,0),this._slide(this.queryParams,0,100)):"block"===d.getStyle(this.queryResults,"display")&&(this._slide(this.queryList,-100,0),this._slide(this.queryResults,0,100))},_removeAllOperatonalLayers:function(){for(var a=this.operationalLayers;0<a.length;){var c=a[0];c&&this.map.removeLayer(c);a[0]=null;a.splice(0,1)}this.operationalLayers=[]},_isConfigValid:function(){return this.config&&"object"===typeof this.config},_initDrawBox:function(){this.drawBox=new w({types:["point",
"polyline","polygon"],map:this.map,showClear:!0,keepOneGraphic:!0});this.drawBox.placeAt(this.drawBoxDiv);this.drawBox.startup()},_initSelf:function(){var a="Query_"+t.getRandomString();this.cbxUseMapExtent.name=a;this.cbxDrawGraphic.name=a;this.paramsDijit=new v({nls:this.nls});this.paramsDijit.placeAt(this.parametersDiv);this.paramsDijit.startup();(this.isValidConfig=this._isConfigValid())?(a=this.config.queries,0===a.length?(d.setStyle(this.queriesNode,"display","none"),d.setStyle(this.noQueryTipSection,
"display","block"),d.setStyle(this.btnClearAll,"display","none")):k.forEach(a,e.hitch(this,function(a,c){var b=a.name,s=d.toDom('\x3ctr class\x3d"single-query"\x3e\x3ctd class\x3d"first-td"\x3e\x3c/td\x3e\x3ctd class\x3d"second-td"\x3e\x3cdiv class\x3d"query-name-div"\x3e\x3c/div\x3e\x3c/td\x3e\x3ctd class\x3d"third-td"\x3e\x3cdiv class\x3d"arrow"\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e');p(".query-name-div",s)[0].innerHTML=b;d.place(s,this.queriesTbody);s.singleConfig=a;0===c%2?d.addClass(s,"even"):
d.addClass(s,"odd")}))):(d.setStyle(this.queriesNode,"display","none"),d.setStyle(this.invalidConfigNode,{display:"block",left:0}),d.setStyle(this.btnClearAll,"display","none"))},_slide:function(a,c,b){d.setStyle(a,"display","block");d.setStyle(a,"left",c+"%");h.animateProperty({node:a,properties:{left:{start:c,end:b,units:"%"}},duration:500,onEnd:e.hitch(this,function(){d.setStyle(a,"left",b);0===b?d.setStyle(a,"display","block"):d.setStyle(a,"display","none")})}).play()},_onQueryListClicked:function(a){if(a=
t.getAncestorDom(a.target||a.srcElement,e.hitch(this,function(a){return d.hasClass(a,"single-query")}),10)){var c=a.singleConfig;this._resetCurrentAttrs();this.currentAttrs.queryTr=a;this.currentAttrs.config=e.clone(c);this.currentAttrs.layerInfo=this.currentAttrs.queryTr.layerInfo;this.currentAttrs.askForValues=k.some(this.currentAttrs.config.filter.parts,e.hitch(this,function(a){return a.parts?k.some(a.parts,e.hitch(this,function(a){return a.interactiveObj})):a.interactiveObj}));this.currentAttrs.askForValues?
d.setStyle(this.parametersDiv,"display","block"):d.setStyle(this.parametersDiv,"display","none");p("tr.single-query",this.queriesTbody).removeClass("selected");d.addClass(this.currentAttrs.queryTr,"selected");var b=e.hitch(this,function(){this.currentAttrs.layerInfo=this.currentAttrs.queryTr.layerInfo;this._fromQueryListToQueryParams()});this.currentAttrs.queryTr.layerInfo?b():(a=this.currentAttrs.config.url,this.shelter.show(),C({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(e.hitch(this,
function(a){this.domNode&&(this.shelter.hide(),this.currentAttrs.queryTr.layerInfo=a,this.currentAttrs.layerInfo=this.currentAttrs.queryTr.layerInfo,b())}),e.hitch(this,function(a){console.error(a);if(this.domNode){this.shelter.hide();var c="";a&&403===a.httpCode&&(c=this.nls.noPermissionsMsg);this._showQueryErrorMsg(c)}})))}},_onCbxUseSpatialClicked:function(){this.cbxUseSpatial.checked?d.setStyle(this.selectSpatialDiv,"display","block"):d.setStyle(this.selectSpatialDiv,"display","none");this.cbxUseMapExtent.checked?
this._onCbxUseMapExtentClicked():this._onCbxDrawGraphicClicked();this._resetDrawBox()},_onCbxUseMapExtentClicked:function(){this.cbxUseMapExtent.checked&&(this._resetDrawBox(),d.setStyle(this.drawBoxDiv,"display","none"))},_onCbxDrawGraphicClicked:function(){this.cbxDrawGraphic.checked&&d.setStyle(this.drawBoxDiv,"display","block")},_onBtnClearAllClicked:function(){this._removeAllResultLayers()},_resetDrawBox:function(){this.drawBox.deactivate();this.drawBox.clear()},_resetQueryParamsPage:function(){this.paramsDijit.clear();
this.cbxOperational.checked=!1;this.cbxUseSpatial.checked=!1;this._onCbxUseSpatialClicked();this._resetDrawBox()},_getLayerIndexByLayerUrl:function(a){var c=a.lastIndexOf("/");a=a.slice(c+1,a.length);return parseInt(a,10)},_getServiceUrlByLayerUrl:function(a){var c=a.lastIndexOf("/");return a.slice(0,c)},_fromQueryListToQueryParams:function(){this._resetQueryParamsPage();var a=e.clone(this.currentAttrs.config.filter);this.paramsDijit.build(a,this.currentAttrs.layerInfo);var a=this.queryParams,c=this.queryResults;
d.setStyle(this.queryList,{left:0,display:"block"});d.setStyle(a,{left:"100%",display:"block"});d.setStyle(c,"display","none");this._slide(this.queryList,0,-100);this._slide(a,100,0)},_onBtnParamsBackClicked:function(){this._resetDrawBox();d.setStyle(this.queryList,"display","block");d.setStyle(this.queryParams,"display","block");d.setStyle(this.queryResults,"display","none");this._slide(this.queryList,-100,0);this._slide(this.queryParams,0,100)},_onBtnApplyClicked:function(){this._clearResultPage();
d.setStyle(this.resultsNumberDiv,"display","none");var a=this.currentAttrs.layerInfo;if(this.currentAttrs.askForValues){var c=this.paramsDijit.getNewFilterExpr();if(!(c&&"string"===typeof c))return;this.currentAttrs.query.where=c}else this.currentAttrs.query.where=this.currentAttrs.config.filter.expr;this.currentAttrs.query.maxRecordCount=a.maxRecordCount||1E3;this.currentAttrs.query.nextIndex=0;this.currentAttrs.query.objectIds=[];var c=this.currentAttrs.query.where,b=null;if(this.cbxUseSpatial.checked){if(this.cbxUseMapExtent.checked)b=
this.map.extent;else{var e=this.drawBox.drawLayer.graphics;0<e.length&&(b=e[0].geometry)}if(!b){new q({message:this.nls.specifySpatialFilterMsg});return}}this.tempResultLayer&&this.map.removeLayer(this.tempResultLayer);this.tempResultLayer=null;this._createQueryResultLayer();this._resetDrawBox();d.setStyle(this.queryList,"display","none");d.setStyle(this.queryParams,"display","block");d.setStyle(this.queryResults,"display","block");this._slide(this.queryParams,0,-100);this._slide(this.queryResults,
100,0);e=0;a.currentVersion&&(e=parseFloat(a.currentVersion));10<e?this._doQuery_SupportObjectIds(c,b):this._doQuery_NotSupportObjectIds(c,b)},_createQueryResultLayer:function(){var a=null,c=x.fromJson(this.currentAttrs.config.resultsSymbol),c=new A(c);if(this.cbxOperational.checked){var a=e.clone(this.currentAttrs.layerInfo),b=this._getBestQueryName(this.currentAttrs.config.name||"");a.name=b;a.drawingInfo.renderer=c.toJson();a.drawingInfo.transparency=0;a.minScale=0;a.maxScale=0;a.effectiveMinScale=
0;a.effectiveMaxScale=0;a.defaultVisibility=!0;a=new z({layerDefinition:a,featureSet:null});this.operationalLayers.push(a);this.map.addLayer(a)}else this._resetAndAddTempResultLayer(),a=this.tempResultLayer;this.currentAttrs.query.resultLayer=a;this.queryResults.resultLayer=a;a.setRenderer(c);return a},_getBestQueryName:function(a){for(var c=a=a?a+(" _"+this.nls.queryResult):a+this.nls.queryResult,b=k.map(this.map.graphicsLayerIds,e.hitch(this,function(a){return this.map.getLayer(a).name})),d=2;0<=
k.indexOf(b,c);)c=a+"_"+d,d++;return c},_doQuery_SupportObjectIds:function(a,c){d.setStyle(this.resultsNumberDiv,"display","block");var b=this.currentAttrs.query.resultLayer;this.shelter.show();this._queryIds(a,c).then(e.hitch(this,function(a){if(this.domNode)if(a&&0<a.length){var c=a.length;this.numSpan.innerHTML=t.localizeNumber(c);this.currentAttrs.query.objectIds=a;this.currentAttrs.query.nextIndex=0;var d=this.currentAttrs.query.maxRecordCount,s=[],s=c>d?a.slice(0,d):a;this._queryByObjectIds(s,
!0).then(e.hitch(this,function(a){this.domNode&&(this.shelter.hide(),a=a.features,this.currentAttrs.query.maxRecordCount=a.length,this.currentAttrs.query.nextIndex+=a.length,this._addResultItems(a,b),this._zoomToLayer(b))}),e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),b&&this.map.removeLayer(b),b=null,this._showQueryErrorMsg())}))}else this.shelter.hide()}),e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),b&&this.map.removeLayer(b),b=null,
this._showQueryErrorMsg())}))},_onResultsScroll:function(){if(t.isScrollToBottom(this.resultsContainer)){var a=this.currentAttrs.layerInfo,c=0;a.currentVersion&&(c=parseFloat(a.currentVersion));if(!(10>c)){var b=this.currentAttrs.query.resultLayer,d=this.currentAttrs.query.maxRecordCount,a=this.currentAttrs.query.objectIds,c=this.currentAttrs.query.nextIndex;c>=a.length||(d=Math.min(a.length-c,d),a=a.slice(c,c+d),0!==a.length&&(this.shelter.show(),this._queryByObjectIds(a,!0).then(e.hitch(this,function(a){this.domNode&&
(this.shelter.hide(),a=a.features,this.currentAttrs.query.nextIndex+=a.length,this._addResultItems(a,b))}),e.hitch(this,function(a){console.error(a);this.domNode&&(this._showQueryErrorMsg(),this.shelter.hide())}))))}}},_doQuery_NotSupportObjectIds:function(a,c){d.setStyle(this.resultsNumberDiv,"display","none");var b=this.currentAttrs.query.resultLayer;this.shelter.show();this._query(a,c).then(e.hitch(this,function(a){this.domNode&&(this.shelter.hide(),this._addResultItems(a.features,b),this._zoomToLayer(b))}),
e.hitch(this,function(a){console.error(a);this.domNode&&(this.shelter.hide(),b&&this.map.removeLayer(b),b=null,this._showQueryErrorMsg())}))},_clearResultPage:function(){this._hideInfoWindow();this._unSelectResultTr();d.empty(this.resultsTbody);this.numSpan.innerHTML="0"},_unSelectResultTr:function(){this.queryResults.resultTr&&d.removeClass(this.queryResults.resultTr,"selected");this.queryResults.resultTr=null},_selectResultTr:function(a){this._unSelectResultTr();this.queryResults.resultTr=a;this.queryResults.resultTr&&
d.addClass(this.queryResults.resultTr,"selected")},_zoomToLayer:function(a){try{var c=D.graphicsExtent(a.graphics);c&&(c=c.expand(1.4),this.map.setExtent(c))}catch(b){console.log(b)}},_getOutputFields:function(){var a=this.currentAttrs.config.objectIdField,c=k.map(this.currentAttrs.config.popup.fields,e.hitch(this,function(a){return a.name}));0>k.indexOf(c,a)&&c.push(a);return c},_queryIds:function(c,b){var d=new a;d.where=c;b&&(d.geometry=b);d.returnGeometry=!1;d.outSpatialReference=this.map.spatialReference;
return(new l(this.currentAttrs.config.url)).executeForIds(d)},_queryByObjectIds:function(c,b){var d=new a;d.returnGeometry=!!b;d.outSpatialReference=this.map.spatialReference;d.outFields=this._getOutputFields();d.objectIds=c;return(new l(this.currentAttrs.config.url)).execute(d)},_query:function(c,b){var d=new a;d.where=c;b&&(d.geometry=b);d.outSpatialReference=this.map.spatialReference;d.returnGeometry=!0;d.outFields=this._getOutputFields();return(new l(this.currentAttrs.config.url)).execute(d)},
_addResultItems:function(a,c){var b=x.fromJson(this.currentAttrs.config.resultsSymbol),d=this.currentAttrs.config.popup;k.map(d.fields,e.hitch(this,function(a){return a.name}));var g=k.filter(d.fields,e.hitch(this,function(a){return a.showInInfoWindow}));k.forEach(a,e.hitch(this,function(a,s){var h="",h=0===s%2?"even":"odd",f=a.attributes;k.forEach(d.fields,e.hitch(this,function(a){var c=a.name;if(f.hasOwnProperty(c)){var b=f[c];"esriFieldTypeDate"===a.type&&b&&(b=(new Date(parseInt(b,10))).toLocaleDateString(),
f[c]=b);null===b&&(f[c]=this.nls.noValue)}}));a.geometry&&(a.setSymbol(b),c.add(a));this._createQueryResultItem({feature:a,titleTemplate:d.title,fieldInfosInAttrContent:g,trClass:h})}))},_createQueryResultItem:function(a){var c=a.feature,b=a.titleTemplate,g=a.fieldInfosInAttrContent,f=a.trClass,h=c&&c.attributes;if(h){a=d.toDom('\x3ctr class\x3d"query-result-item" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctd\x3e\x3cspan class\x3d"title"\x3e\x3c/span\x3e\x3ctable class\x3d"feature-attributes" valign\x3d"top"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/td\x3e\x3c/tr\x3e');
d.addClass(a,f);d.place(a,this.resultsTbody);a.feature=c;var f=p("span.title",a)[0],l=p("tbody",a)[0],b=y.substitute(h,b);b||(b=this.nls.noValue);f.innerHTML=b;var m="";k.forEach(g,e.hitch(this,function(a,c){var b=a.name,e=a.alias||b,f=h[b],k=f,b=f,s=a.specialType;"image"===s?f&&"string"===typeof f&&(k='\x3ca href\x3d"'+f+'" target\x3d"_blank"\x3e'+f+"\x3c/a\x3e",b='\x3cimg src\x3d"'+f+'" /\x3e'):"link"===s&&(f&&"string"===typeof f)&&(b=k='\x3ca href\x3d"'+f+'" target\x3d"_blank"\x3e'+f+"\x3c/a\x3e");
f=d.toDom('\x3ctr\x3e\x3ctd class\x3d"attr-name"\x3e'+e+':\x3c/td\x3e\x3ctd class\x3d"attr-value"\x3e'+k+"\x3c/td\x3e\x3c/tr\x3e");d.place(f,l);e=e+": "+b;c!==g.length-1&&(e+="\x3cbr/\x3e");m+=e}));a.infoTemplateTitle=b;a.infoTemplateContent=m;a=new B;a.setTitle(b);a.setContent(m||"\x3cspan\x3e\x3c/span\x3e");c.setInfoTemplate(a)}},_showQueryErrorMsg:function(a){new q({message:a||this.nls.queryError})},_onResultsTableClicked:function(a){a=a.target||a.srcElement;if(d.isDescendant(a,this.resultsTable)){var b=
t.getAncestorDom(a,e.hitch(this,function(a){return d.hasClass(a,"query-result-item")}),10);if(b){this._selectResultTr(b);p("span.title",b);a=p(".feature-attributes",b)[0];e.clone(a);d.addClass(b,"selected");var f=b.feature;if(a=f.geometry){var g=b.infoTemplateTitle||"",k=b.infoTemplateContent||"\x3cspan\x3e\x3c/span\x3e",b=a.type,h,l=null;if("point"===b||"multipoint"===b){var m=e.hitch(this,function(){l=new c;var a=this.map.getNumLevels(),b=this.map.getLevel(),a=Math.max(b,Math.floor(2*a/3));this.map.setLevel(a).then(e.hitch(this,
function(){this.map.centerAt(h).then(e.hitch(this,function(){l.resolve()}))}))});if("point"===b)h=a,m();else if("multipoint"===b)if(1===a.points.length)h=a.getPoint(0),m();else if(1<a.points.length&&(b=a.getExtent()))b=b.expand(1.4),h=a.getPoint(0),l=this.map.setExtent(b)}else"polyline"===b?(b=a.getExtent(),b=b.expand(1.4),h=b.getCenter(),l=this.map.setExtent(b)):"polygon"===b?(b=a.getExtent(),b=b.expand(1.4),h=b.getCenter(),l=this.map.setExtent(b)):"extent"===b&&(b=a.expand(1.4),h=b.getCenter(),
l=this.map.setExtent(b));l&&l.then(e.hitch(this,function(){this.map.infoWindow.setFeatures([f]);this.map.infoWindow.setTitle(g);this.map.infoWindow.setContent(k);this.map.infoWindow.reposition();this.map.infoWindow.show(h)}))}}}},_hideInfoWindow:function(){this.map&&this.map.infoWindow&&(this.map.infoWindow.hide(),this.map.infoWindow.setFeatures([]),this.map.infoWindow.setTitle(""),this.map.infoWindow.setContent(""))},_onBtnResultsBackClicked:function(){var a;a=this.queryParams;d.setStyle(this.queryList,
"display","none");d.setStyle(a,{display:"block",left:"-100%"});this._slide(a,-100,0);this._slide(this.queryResults,0,100)}})});