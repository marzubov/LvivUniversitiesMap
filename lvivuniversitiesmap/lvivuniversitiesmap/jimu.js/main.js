//>>built
require({cache:{"jimu/ConfigManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/_base/config dojo/topic dojo/aspect dojo/i18n dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr dojo/request/script require ./utils jimu/tokenUtils jimu/portalUtils ./portalUrlUtils esri/IdentityManager esri/config esri/tasks/GeometryService esri/urlUtils esri/request".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w,C){function D(a,e){function h(e,
b){var n,m,c=a[e],l="widgetOnScreen"===e;if(c){if(c.groups)for(n=0;n<c.groups.length&&!b(c.groups[n],n,c.groups[n].id,l);n++)for(m=0;m<c.groups[n].widgets.length&&!b(c.groups[n].widgets[m],m,c.groups[n].id,l);m++);if(c.widgets)for(n=0;n<c.widgets.length&&!b(c.widgets[n],n,e,l);n++);}}h("widgetOnScreen",e);h("widgetPool",e)}function E(a,e){var h;if("map"===e)return a.map;D(a,function(a){if(a.id===e)return h=a,!0});return h}function x(a){var e=0,h;D(a,function(a){if(a.id){var b=a.id.lastIndexOf("_");
-1<b&&(h=a.id.substr(b+1),e=Math.max(e,h))}});D(a,function(a){a.id||(e++,a.id=a.uri?a.uri+"_"+e:"_"+e)})}function v(a){var e=0;D(a,function(a){!a.widgets&&!a.uri&&(e++,a.placeholderIndex=e)})}function I(a){a=d.clone(a);var e="inPanel isController hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle".split(" ");delete a.mode;D(a,function(a){a.widgets?(delete a.isPreload,delete a.gid,delete a.icon,delete a.openType):(delete a.panel,delete a.folderUrl,
delete a.amdFolder,delete a.thumbnail,delete a.configFile,delete a.gid,delete a.isPreload,e.forEach(function(e){delete a[e]}),a.icon&&(!a.icon.startWith("data")&&!a.originIcon)&&delete a.icon,a.visible&&delete a.visible)});delete a.rawConfig;delete a._ssl;delete a.getConfigElementById;delete a.processNoUriWidgets;delete a.addElementId;delete a.getCleanConfig;delete a.visitElement;delete a.agolConfig;delete a._itemData;return a}var F=null,u;u=q(null,{urlParams:null,config:null,rawConfig:null,configFile:null,
_configLoaded:!1,portalSelf:null,constructor:function(a){this._removeHash(a);this.urlParams=a||{};this.listenBuilderEvents();"config"===this.urlParams.mode&&(window.parent.setConfigViewerTopic&&d.isFunction(window.parent.setConfigViewerTopic))&&window.parent.setConfigViewerTopic(p);"preview"===this.urlParams.mode&&(window.parent.setPreviewViewerTopic&&d.isFunction(window.parent.setPreviewViewerTopic))&&window.parent.setPreviewViewerTopic(p)},listenBuilderEvents:function(){p.subscribe("configChanged",
d.hitch(this,this.onConfigChanged));p.subscribe("resetConfig",d.hitch(this,this.onConfigReset));p.subscribe("themeChanged",d.hitch(this,this.onThemeChanged));p.subscribe("layoutChanged",d.hitch(this,this.onLayoutChanged));p.subscribe("styleChanged",d.hitch(this,this.onStyleChanged));p.subscribe("appConfigLoaded",d.hitch(this,this._addDefaultGeometryService));p.subscribe("appConfigChanged",d.hitch(this,this._addDefaultGeometryService))},_tryLoadConfig:function(){var a=new b;window.isRunInPortal=!1;
if(this.urlParams.id||this.urlParams.appid){window.isRunInPortal=!0;var e=z.getPortalUrlFromLocation();n.setPortalUrl(e);this._proesssWebTierAndSignin(e).then(d.hitch(this,function(){this._checkLocale();this.urlParams.id?this._getAppConfigFromAppId(this.urlParams.id).then(function(e){a.resolve(e)},function(e){a.reject(e)}):this.urlParams.appid&&this._getAppConfigFromTemplateAppId(this.urlParams.appid).then(function(e){a.resolve(e)},function(e){a.reject(e)})}));return a}this.configFile=this.urlParams.config?
this.urlParams.config:"config.json";return m(this.configFile,{handleAs:"json"})},loadConfig:function(){console.time("Load Config");if("preview"!==this.urlParams.mode){var a=this._tryLoadConfig(),e=new b;a.then(d.hitch(this,function(a){var h=this.checkConfig(a);if(h)p.publish("appConfigLoadError",h),console.error(h),e.reject(h);else{this.rawConfig=d.clone(a);this.postProcess(a);this.config=a;var m=z.getStandardPortalUrl(a.portalUrl);window.isRunInPortal?this._loadWidgetsManifest(a).then(d.hitch(this,
function(){var h;a._itemData?(a.getConfigElementById=function(e){return E(a,e)},h=this._mergeTemplateAppConfigToAppConfig(a._itemData,a)):(h=new b,h.resolve());h.then(d.hitch(this,function(){this._configLoaded=!0;console.timeEnd("Load Config");p.publish("appConfigLoaded",this.getConfig());e.resolve(this.getConfig())}))})):this._proesssWebTierAndSignin(m).then(d.hitch(this,function(){n.setPortalUrl(m);return this._loadWidgetsManifest(a)})).then(d.hitch(this,function(){this._configLoaded=!0;console.timeEnd("Load Config");
p.publish("appConfigLoaded",this.getConfig());e.resolve(this.getConfig())}))}}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e}},_proesssWebTierAndSignin:function(a){var e=new b,n=!1;this._processWebTier(a).then(d.hitch(this,function(e){n=e;return h.getPortal(a).loadSelfInfo()})).then(d.hitch(this,function(e){this.portalSelf=e;return this._processSignIn(a,n)})).then(d.hitch(this,function(){e.resolve()}),function(a){e.reject(a)});return e},_processWebTier:function(a){var e=new b,
h=a+"/sharing";n.isWebTierPortal(a).then(d.hitch(this,function(a){a?esri.id.getCredential(h).then(d.hitch(this,function(){e.resolve(!0)}),d.hitch(this,function(a){e.reject(a)})):e.resolve(!1)}),d.hitch(this,function(a){e.reject(a)}));return e},_processSignIn:function(a,e){var m=new b,c=h.getPortal(a),l=z.getSharingUrl(a);if(window.isRunInPortal)l=A.checkSignInStatus(l),l.promise.always(d.hitch(this,function(){m.resolve()}));else return!n.isInBuilderWindow()&&(!n.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&
this.rawConfig.appId&&!e)&&n.registerOAuthInfo(a,this.rawConfig.appId),l=A.checkSignInStatus(l),l.promise.always(d.hitch(this,function(){n.xtGetCredentialFromCookie(a);c.loadSelfInfo().then(d.hitch(this,function(a){this.portalSelf=a;m.resolve()}))})),m},onThemeChanged:function(a){this._getAppConfigFromTheme(a).then(d.hitch(this,function(a){this.config=a;p.publish("appConfigChanged",this.getConfig(),"themeChange")}))},onLayoutChanged:function(a){var e=a.layoutConfig,h=e.widgetOnScreen,b=this.config.widgetOnScreen;
h&&(h.panel&&h.panel.uri&&(b.panel.uri=h.panel.uri),g.forEach(h.widgets,function(a,e){b.widgets[e]&&h.widgets[e]&&(h.widgets[e].position&&(b.widgets[e].position=h.widgets[e].position),h.widgets[e].positionRelativeTo&&(b.widgets[e].positionRelativeTo=h.widgets[e].positionRelativeTo),b.widgets[e].panel={uri:b.panel.uri,position:b.widgets[e].position,positionRelativeTo:b.widgets[e].positionRelativeTo})},this),g.forEach(h.groups,function(a,e){b.groups[e]&&(h.groups[e]&&h.groups[e].panel)&&(b.groups[e].panel=
h.groups[e].panel)},this));e.map&&(this.config.map.position=e.map.position);e.widgetPool&&(e.widgetPool.panel&&(this.config.widgetPool.panel=e.widgetPool.panel),g.forEach(e.widgetPool.groups,function(a,h){this.config.widgetPool.groups[h]&&(e.widgetPool.groups[h]&&e.widgetPool.groups[h].panel)&&(this.config.widgetPool.groups[h].panel=e.widgetPool.groups[h].panel)},this));p.publish("appConfigChanged",this.getConfig(),"layoutChange")},onStyleChanged:function(a){this.config.theme.styles=this._genStyles(this.config.theme.styles,
a.name);p.publish("appConfigChanged",this.getConfig(),"styleChange")},_getAppConfigFromTemplateAppId:function(a){var e=new b;this._getWabAppIdAndDataFromTemplateAppId(a).then(d.hitch(this,function(a){var h=a.itemData;this._getAppConfigFromAppId(a.appId).then(function(a){a._itemData=h;e.resolve(a)})}));return e},_getWabAppIdAndDataFromTemplateAppId:function(a){var e=new b,n=z.getPortalUrlFromLocation(),m=h.getPortal(n),n=z.getSharingUrl(n);A.checkSignInStatus(n).promise.always(d.hitch(this,function(){m.getItemData(a).then(d.hitch(this,
function(a){m.getItemById(a.source).then(d.hitch(this,function(h){h=w.urlToObject(h.url);e.resolve({appId:h.query.id,itemData:a})}))}),function(a){e.reject(a)})}));return e},_getAppConfigFromAppId:function(a){var e=new b,h=z.getPortalUrlFromLocation(),n=z.getSharingUrl(h),n=A.checkSignInStatus(n);this.configFile=z.getItemDataUrl(h,a)+"?f\x3djson";n.promise.always(d.hitch(this,function(){C({url:this.configFile}).then(function(a){e.resolve(a)},function(a){console.error(a);e.reject()})}));return e},
_mergeTemplateAppConfigToAppConfig:function(a,n){function m(a){var e=[];g.forEach(a,function(a){a&&e.push(a)},this);return e}function c(){n.widgetPool.widgets=m(n.widgetPool.widgets);r.widgets=m(r.widgets);if(n.widgetPool.groups)for(l=0;l<n.widgetPool.groups.length;l++)n.widgetPool.groups[l].widgets=m(n.widgetPool.groups[l].widgets);if(r.groups)for(l=0;l<r.groups.length;l++)r.groups[l].widgets=m(r.groups[l].widgets)}var l,r=n.widgetOnScreen,s=z.getPortalUrlFromLocation();n.agolConfig=a;n.map.itemId=
a.values.webmap;n.map.portalUrl=s;var k=null,f=null,t;for(t in a.values)"webmap"!==t&&e.setConfigByTemplateWithId(n,t,a.values[t]),"app_title"===t&&(k=a.values[t]),"app_subtitle"===t&&(f=a.values[t]);var C=new b;!k||!f?h.getPortal(s).getItemById(a.values.webmap).then(d.hitch(this,function(a){k||(n.title=a.title);f||(n.subtitle=a.snippet);c();C.resolve()})):(c(),C.resolve());return C},_removeHash:function(a){for(var e in a)a[e]&&(a[e]=a[e].replace("#",""))},_genStyles:function(a,e){var h=[];h.push(e);
g.forEach(a,function(a){0>h.indexOf(a)&&h.push(a)});return h},_getAppConfigFromTheme:function(a){var e=new b,h,n=[];if(a.appConfig)return h=d.clone(a.appConfig),h.map=this.getConfig().map,h.map.position=a.appConfig.map.position,e.resolve(h),e;var n=a.getCurrentLayout(),m=a.getCurrentStyle();h=d.clone(this.getConfig()).getCleanConfig();this.processUrlParams(h);delete h.widgetManifestsMerged;h.widgetOnScreen=n.layoutConfig.widgetOnScreen;h.widgetPool=n.layoutConfig.widgetPool;n.layoutConfig.map&&n.layoutConfig.map.position&&
(h.map.position=n.layoutConfig.map.position);n=this._genStyles(g.map(a.getStyles(),function(a){return a.name}),m.name);h.theme={name:a.getName(),styles:n};this._addNeedValues(h);this._loadWidgetsManifest(h).then(function(){e.resolve(h)});return e},getConfig:function(){var a=d.clone(this.config);a.rawConfig=this.rawConfig;a.getConfigElementById=function(a){return E(this,a)};a.processNoUriWidgets=function(){v(this)};a.addElementId=function(){x(this)};a.getCleanConfig=function(){return I(this)};a.visitElement=
function(a){D(this,a)};return a},onConfigReset:function(a){a=e.reCreateObject(a);this.config?(a.map.itemId&&a.map.itemId!==this.config.map.itemId&&a.map.mapOptions&&delete a.map.mapOptions.extent,this.config=a,p.publish("appConfigChanged",this.getConfig(),"resetConfig",a)):(this.config=a,p.publish("appConfigLoaded",this.getConfig()))},_addNeedValues:function(a){v(a);x(a);this.addDefaultValues(a)},postProcess:function(a){this.processUrlParams(a);this._addNeedValues(a);this._processProxy(a);A.tokenValidity=
10080;return a},_processProxy:function(a){B.defaults.io.alwaysUseProxy=a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;B.defaults.io.proxyUrl="";B.defaults.io.proxyRules=[];a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.url)&&(B.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.rules)&&g.forEach(a.httpProxy.rules,function(a){w.addProxyRule(a)})},_loadWidgetsManifest:function(a){var e=[],h=new b;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(d.hitch(this,
function(e){D(a,d.hitch(this,function(a){!a.widgets&&a.uri&&(this._addNeedValuesForManifest(e[a.uri]),d.mixin(a,e[a.uri].properties),a.label||(a.label=e[a.uri].label))}));h.resolve(e)})):(D(a,d.hitch(this,function(a){!a.widgets&&a.uri&&e.push(this._loadWidgetManifest(a))})),r(e).then(function(a){var e={};g.forEach(a,function(a){d.mixin(e,a)});h.resolve(e)},function(){h.resolve(null)}));setTimeout(function(){h.isResolved()||h.resolve(null)},jimuConfig.timeout);return h},_loadMergedWidgetManifests:function(){return m(path+
"widgets/widgets-manifest.json",{handleAs:"json"})},_loadWidgetManifest:function(a){var h=new b;m(a.folderUrl+"manifest.json",{handleAs:"json"}).then(d.hitch(this,function(b){var n=d.hitch(this,function(){this._addNeedValuesForManifest(b);d.mixin(a,b.properties);a.label||(a.label=b.label);var e={};e[a.uri]=b;h.resolve(e)});b.category="widget";b.url=a.amdFolder;a.label?n():e.addI18NLabel(b).then(function(){n()})}),function(a){h.reject(a)});return h},_addNeedValuesForManifest:function(a){e.addManifestProperies(a);
e.processManifestLabel(a,k.locale)},_addDefaultPortalUrl:function(a){"undefined"===typeof a.portalUrl&&(a.portalUrl="http://www.arcgis.com/");a.portalUrl&&"/"!==a.portalUrl.substr(a.portalUrl.length-1)&&(a.portalUrl+="/")},_addDefaultGeometryService:function(a){var e=a&&a.geometryService,e=e&&"string"===typeof e&&d.trim(e)?d.trim(e):this.portalSelf.helperServices.geometry.url;a.geometryService=e;B.defaults.geometryService=new y(a.geometryService)},_checkLocale:function(){var a=this.portalSelf.user&&
this.portalSelf.user.culture||this.portalSelf.culture||k.locale,a=a.toLowerCase();e.isLocaleChanged(k.locale,a)&&(l("appbuilder_locale",a),window.location.reload())},_addDefaultStyle:function(a){if(a.theme&&(!a.theme.styles||0===a.theme.styles.length))a.theme.styles=["default"]},_addDefaultMap:function(a){a.map.id="map";"undefined"===typeof a.map["3D"]&&"undefined"===typeof a.map["2D"]&&(a.map["2D"]=!0);"undefined"===typeof a.map.position&&(a.map.position={left:0,right:0,top:0,bottom:0});"undefined"===
typeof a.map.portalUrl&&(a.map.portalUrl=a.portalUrl)},_addDefaultVisible:function(a){D(a,function(a){void 0===a.visible&&(a.visible=!0)})},_addDefaultPanelAndPosition:function(a){var e,h,b=a.widgetOnScreen,n=a.widgetPool;"undefined"===typeof b.panel||"undefined"===typeof b.panel.uri?b.panel={uri:"jimu/BaseWidgetPanel",positionRelativeTo:"map"}:"undefined"===typeof b.panel.positionRelativeTo&&(b.panel.positionRelativeTo="map");"undefined"===typeof n.panel||"undefined"===typeof n.panel.uri?n.panel=
{uri:"jimu/BaseWidgetPanel",positionRelativeTo:"map"}:"undefined"===typeof n.panel.positionRelativeTo&&(n.panel.positionRelativeTo="map");if(b.widgets)for(e=0;e<b.widgets.length;e++)b.widgets[e].position||(b.widgets[e].position={left:0,top:0}),b.widgets[e].positionRelativeTo||(b.widgets[e].positionRelativeTo="map"),b.widgets[e].panel||(b.widgets[e].panel=d.clone(b.panel),b.widgets[e].panel.position=b.widgets[e].position,b.widgets[e].panel.positionRelativeTo=b.widgets[e].positionRelativeTo);if(b.groups)for(e=
0;e<b.groups.length;e++){b.groups[e].position||(b.groups[e].position={left:0,top:0});b.groups[e].panel||(b.groups[e].panel=b.panel);for(h=0;h<b.groups[e].widgets.length;h++)b.groups[e].widgets[h].panel=b.groups[e].panel}if(n){if(n.groups)for(e=0;e<n.groups.length;e++){n.groups[e].panel?n.groups[e].panel.positionRelativeTo||(n.groups[e].panel.positionRelativeTo="map"):n.groups[e].panel=n.panel;for(h=0;h<n.groups[e].widgets.length;h++)n.groups[e].widgets[h].panel=n.groups[e].panel}if(n.widgets)for(e=
0;e<n.widgets.length;e++)n.widgets[e].panel||(n.widgets[e].panel=a.widgetPool.panel)}},_addDefaultOfWidgetGroup:function(a){D(a,d.hitch(this,function(a,h,b,n){a.isPreload=n;a.widgets?(a.gid=a.id,1===a.widgets.length?(a.label||(a.label=a.widgets[0].label?a.widgets[0].label:"Group"),a.icon||(a.icon=a.widgets[0].uri?this._getDefaultIconFromUri(a.widgets[0].uri):"jimu.js/images/group_icon.png")):(a.icon=a.icon?a.icon:"jimu.js/images/group_icon.png",a.label=a.label?a.label:"Group_"+h)):(a.gid=b,a.uri&&
(h=a.uri.split("/"),h.pop(),h=h.pop(),a.name=h,e.processWidgetSetting(a)))}))},_getDefaultIconFromUri:function(a){a=a.split("/");a.pop();return a.join("/")+"/images/icon.png"},addDefaultValues:function(a){this._addDefaultPortalUrl(a);this._addDefaultStyle(a);this._addDefaultMap(a);this._addDefaultVisible(a);"undefined"===typeof a.widgetOnScreen&&(a.widgetOnScreen={});"undefined"===typeof a.widgetPool&&(a.widgetPool={});this._addDefaultPanelAndPosition(a);this._addDefaultOfWidgetGroup(a);(a.widgetPool.widgets&&
0<a.widgetPool.widgets.length&&void 0===a.widgetPool.widgets[0].index||a.widgetPool.groups&&0<a.widgetPool.groups.length&&void 0===a.widgetPool.groups[0].index)&&this._addIndexForWidgetPool(a)},_addIndexForWidgetPool:function(a){var e=0,h,b;if(a.widgetPool.widgets)for(h=0;h<a.widgetPool.widgets.length;h++)a.widgetPool.widgets[h].index=e,e++;if(a.widgetPool.groups)for(h=0;h<a.widgetPool.groups.length;h++){a.widgetPool.groups[h].index=e;e++;for(b=0;b<a.widgetPool.groups[h].widgets.length;b++)a.widgetPool.groups[h].widgets[b].index=
b}},checkConfig:function(a){return(a=this._getRepeatedId(a))?"repeated id:"+a:null},_getRepeatedId:function(a){var e=[],h;D(a,function(a){if(0<e.indexOf(a.id))return h=a.id,!0;e.push(a.id)});return h},showError:function(a){document.body.innerHTML='\x3cdiv class\x3d"jimu-error-code"\x3e\x3cspan\x3e'+this.nls.errorCode+":\x3c/span\x3e\x3cspan\x3e"+a.response.status+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-message"\x3e\x3cspan\x3e'+this.nls.errorMessage+":\x3c/span\x3e\x3cspan\x3e"+a.message+
'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-detail"\x3e\x3cspan\x3e'+this.nls.errorDetail+":\x3c/span\x3e\x3cspan\x3e"+a.response.text+"\x3cspan\x3e\x3c/div\x3e"},processUrlParams:function(a){this.urlParams.style&&a.theme&&(a.theme.styles?(a.theme.styles.splice(a.theme.styles.indexOf(this.urlParams.style),1),a.theme.styles=[this.urlParams.style].concat(a.theme.styles)):a.theme.styles=[this.urlParams.style]);this.urlParams.webmap&&(a.map.itemId=this.urlParams.webmap);this.urlParams.mode&&
(a.mode=this.urlParams.mode)},onConfigChanged:function(a,h,b){var n;if("app"===a)d.mixin(this.config,h),n="attributeChange",this._processProxy(h);else if("map"===a)h.itemId&&h.itemId!==this.config.map.itemId&&this.config.map.mapOptions&&this.config.map.mapOptions.extent&&delete this.config.map.mapOptions.extent,d.mixin(this.config.map,h),n="mapChange";else if("widgetPool"===a)this.config.widgetPool.widgets=h.widgets,this.config.widgetPool.groups=h.groups,n="widgetPoolChange";else{a=E(this.config,
a);for(n in h)a[n]=h[n];n=a.widgets?"groupChange":"widgetChange"}this._addNeedValues(this.config);p.publish("appConfigChanged",e.reCreateObject(this.getConfig()),n,h,b)},_processPoolChangeEvent:function(a,e){var h=E(e.controllerId);h.controlledWidgets=g.map(a.widgets,function(a){return a.label});h.controlledGroups=g.map(a.groups,function(a){return a.label})}});u.getInstance=function(a){null===F?F=new u(a):F.urlParams=a;return F};u.getConfig=function(){return u.getInstance().config};window.getConfig=
function(){return u.getInstance().config};return u})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/request/xhr dojo/i18n dojo/number dojo/date/locale esri/arcgis/utils esri/SpatialReference esri/geometry/Extent esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters jimu/portalUrlUtils esri/urlUtils".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w,C,D){function E(a,e){var h=a.match(/url\([^)]+\)/gi),b,n;if(null===h||""===e)return a;for(b=0;b<h.length;b++)if(n=h[b].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=n.length){var m=n[2];e.endWith("/")||(e+="/");a=a.replace(n[1]+m+n[3],n[1]+e+m+n[3])}return a}function x(a,e){var h=Array.isArray(e),b=h&&[]||{};h?(a=a||[],b=b.concat(a),e.forEach(function(e,h){"undefined"===typeof a[h]?b[h]=e:"object"===typeof e?b[h]=x(a[h],e):-1===a.indexOf(e)&&b.push(e)})):
(a&&"object"===typeof a&&Object.keys(a).forEach(function(e){b[e]=a[e]}),Object.keys(e).forEach(function(h){b[h]="object"!==typeof e[h]||!e[h]?e[h]:a[h]?x(a[h],e[h]):e[h]}));return b}function v(a){var e,h={};e=a.indexOf("/");a.substring(0,e);a=a.substring(0,a.lastIndexOf("/")+1);h.folderUrl=require(u.getRequireConfig()).toUrl(a);h.amdFolder=a;return h}function I(a){a.panels.forEach(function(a){a.uri="panels/"+a.name+"/Panel.js"});a.styles.forEach(function(a){a.uri="styles/"+a.name+"/style.css"});a.layouts.forEach(function(a){a.uri=
"layouts/"+a.name+"/config.json";a.icon="layouts/"+a.name+"/icon.png"})}function F(a){"undefined"!==typeof a["2D"]&&(a.support2D=a["2D"]);"undefined"!==typeof a["3D"]&&(a.support3D=a["3D"]);"undefined"===typeof a["2D"]&&"undefined"===typeof a["3D"]&&(a.support2D=!0);delete a["2D"];delete a["3D"];"undefined"===typeof a.properties&&(a.properties={});"inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle".split(" ").forEach(function(e){"undefined"===
typeof a.properties[e]&&(a.properties[e]=!0)});"undefined"===typeof a.properties.isController&&(a.properties.isController=!1)}var u={},M={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"},J=[];require.on("error",function(a){d.forEach(J,function(e){a.info[0]&&-1<a.info[0].indexOf(e.resKey)&&e.def.reject(a);for(var h in a.info)-1<h.indexOf(e.resKey)&&e.def.reject(a)})});u.checkError=function(a,e){J.push({resKey:a,def:e})};u.replacePlaceHolder=function(a,
e){var h=JSON.stringify(a),b=h.match(/\$\{(\w)+\}/g),n;if(null===b)return a;for(n=0;n<b.length;n++){var m=b[n].match(/(\w)+/g)[0];e[m]&&(h=h.replace(b[n],e[m]))}return JSON.parse(h)};u.changeUnit=function(a){var e=Math.abs(a),h;a=Math.floor(e);h=Math.floor(60*(e-a));e=(60*(60*(e-a)-h)).toFixed(2);return a+"\u00b0"+(10>h?"0"+h:h)+"'"+(10>e?"0"+e:e)+'"'};u.formatTime=function(a){var e=a/1E3;a=Math.floor(e/60);e=Number(e-60*a).toFixed(1);return(10>a?"0"+a:a)+":"+(10>e?"0"+e:e)};u.parseTime=function(a){var e=
/(\d{2,})\:(\d{2})\.(\d{1})/;if(!e.test(a))return console.log("wrong time format."),-1;a=a.match(e);return 1E3*(60*parseInt(a[1],10)+parseInt(a[2],10)+parseInt(a[3],10)/10)};u.preloadImg=function(a,e){var h=[],h="string"===typeof a?[a]:a;d.forEach(h,function(a){(new Image).src=e?e+a:a})};u.getPositionStyle=function(a){var e={},h;for(h in a)0<=d.indexOf("left top right bottom width height".split(" "),h)&&("number"===typeof a[h]?e[h]=a[h]+"px":a[h]&&(e[h]=a[h]));return e};u.isEqual=function(a,e){function h(a,
e){var m;if(isNaN(a)&&isNaN(e)&&"number"===typeof a&&"number"===typeof e||a===e)return!0;if("function"===typeof a&&"function"===typeof e||a instanceof Date&&e instanceof Date||a instanceof RegExp&&e instanceof RegExp||a instanceof String&&e instanceof String||a instanceof Number&&e instanceof Number)return a.toString()===e.toString();if(-1<b.indexOf(a)||-1<n.indexOf(e))return!1;if(null!==e){for(m in e)if(e.hasOwnProperty(m)!==a.hasOwnProperty(m)||typeof e[m]!==typeof a[m])return!1;for(m in a){if(e.hasOwnProperty(m)!==
a.hasOwnProperty(m)||typeof e[m]!==typeof a[m])return!1;switch(typeof a[m]){case "object":case "function":b.push(a);n.push(e);if(!h(a[m],e[m]))return!1;b.pop();n.pop();break;default:if(a[m]!==e[m])return!1}}}return!0}var b,n;b=[];n=[];return!h(a,e)?!1:!0};u.file={supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return f("safari")&&6>f("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},containSeparator:function(a){return 0<=
a.indexOf("/")?!0:0<=a.indexOf("\\")?!0:!1},getNameFromPath:function(a){var e="",e=0<=a.indexOf("/")?"/":"\\";a=a.split(e);return 0<a.length?a[a.length-1]:null},getFolderFromPath:function(a){return a.substr(0,a.length-u.file.getNameFromPath(a).length)},readFile:function(a,e,h,b){if(this.supportHTML5()){var n=a.target.files[0];n&&(n.type.match(e)?n.size>=h?b({errCode:"exceed"}):(a=new FileReader,a.onload=function(a){b(null,n.name,a.target.result)},a.readAsDataURL(n)):b({errCode:"invalidType"}))}else if(this.supportFileAPI()){var m=
window.FileAPI.getFiles(a);m[0].type.match(e)?m[0].size>=h?b({errCode:"exceed"}):window.FileAPI.readAsDataURL(m[0],function(a){a&&a.result?b(null,m[0].name,a.result):b({errCode:"enableFlash"})}):b({errCode:"invalidType"})}}};u.checkFileExist=function(e){var h=new l,b=require(u.getRequireConfig()).toUrl(e);if(require.cache["url:"+b])return h.resolve(!0),h;for(var n in a.cache){var m=e.substr(0,e.length-3);if(n.startWith(m))return h.resolve(!0),h}t(b).then(function(){h.resolve(!0)},function(){h.resolve(!1)});
return h};u.processWidgetSetting=function(a){if(!a.uri)return a;q.mixin(a,v(a.uri));a.icon||(a.icon=a.folderUrl+"images/icon.png");a.thumbnail||(a.thumbnail=a.folderUrl+"images/thumbnail.png");return a};u.getRequireConfig=function(){if(jimuConfig){var a=[];jimuConfig.widgetsPackage&&(a=a.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(a=a.concat(jimuConfig.themesPackage));return{packages:a}}return{}};u.getTypeByGeometryType=function(a){var e=null,h="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),
b=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(a)?e="point":0<=h.indexOf(a)?e="polyline":0<=b.indexOf(a)&&(e="polygon");return e};u.getServices=function(){return M};u.getArcGISDefaultGeometryService=function(){return new y(M.geometryService)};u.restoreToDefaultWebMapExtent=function(a,e,h){var b=new l;if(!(a&&"esri.Map"===a.declaredClass))return setTimeout(function(){b.reject("Invalid map.")},0),b;e=e&&e.itemInfo;if(!e)return setTimeout(function(){b.reject("Invalid itemInfo")},
0),b;e=e.item&&e.item.extent;if(!e)return setTimeout(function(){b.reject("Invalid itemInfo.item.extent")}),b;var n=new z({wkid:4326}),n=new A(e[0][0],e[0][1],e[1][0],e[1][1],n);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(n);if(a.spatialReference.isWebMercator())return n=B.geographicToWebMercator(n),a.setExtent(n);e=new w;e.geometries=[n];e.outSR=a.spatialReference;n=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;n&&"esri.tasks.GeometryService"===n.declaredClass||
(h&&"string"===typeof h&&q.trim(h)?(h=q.trim(h),n=new y(h)):n=u.getArcGISDefaultGeometryService());n.project(e).then(function(e){if(e=e&&e[0])return a.setExtent(e);b.reject("Invalid projected geometry.");return b},function(a){console.error(a);b.reject(a);return b});return b};u.getAncestorWindow=function(){for(var a=window;a&&a.parent&&a!==a.parent;)a=a.parent;return a};u.getAncestorDom=function(a,e,h){if(a&&1===a.nodeType&&e&&"function"===typeof e){var b=100,n=document.body;h&&("number"===typeof h?
(h=parseInt(h,10),0<h&&(b=h)):1===h.nodeType&&(n=h));for(h=0;a.parentNode&&h<b&&g.isDescendant(a.parentNode,n);){if(e(a.parentNode))return a.parentNode;a=a.parentNode;h++}}return null};u.bindClickAndDblclickEvents=function(a,e,h,n){var m=null;if(a&&1===a.nodeType&&e&&"function"===typeof e&&h&&"function"===typeof h){var c=200;n&&"number"===typeof n&&(n=parseInt(n,10),0<n&&(c=n));var l=0,m=b(a,"click",function(a){l++;1===l?setTimeout(function(){1===l&&(l=0,e(a))},c):2===l&&(l=0,h(a))})}return m};u.isScrollToBottom=
function(a){var e=g.getContentBox(a);return 0===a.scrollHeight-(a.scrollTop+e.h)};u.getAllItemTypes=function(){var a=[],a=a.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service","Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In",
"Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return a=a.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer","Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};
u.getItemQueryStringByTypes=function(a){var e="",h=u.getAllItemTypes();if(a&&0<a.length&&0<a.length){var b="";d.forEach(a,function(e,h){b+=' type:"'+e+'" ';h!==a.length-1&&(b+=" OR ")});e=" ( "+b+" ) ";d.forEach(h,function(h){var b="";0>d.indexOf(a,h)&&(b=' -type:"'+h+'" ');e+=b})}return e};u.isNotEmptyString=function(a,e){var h=a&&"string"===typeof a;return h?e?h&&q.trim(a):!0:!1};u.isObject=function(a){return a&&"object"===typeof a};u.createWebMap=function(a,e,b,n){a=C.getStandardPortalUrl(a);a=
C.getBaseItemUrl(a);h.arcgisUrl=a;return h.createMap(e,b,n)};u.getRandomString=function(){var a=Math.random().toString();return a=a.slice(2,a.length)};u._getDomainsByServerName=function(a){var e=a.split("."),h=e.length;return d.map(e,q.hitch(this,function(a,b){var n=e.slice(b,h),m="",c=n.length-1;d.forEach(n,q.hitch(this,function(a,e){m+=a;e!==c&&(m+=".")}));return m}))};u.removeCookie=function(a,e){var h=this._getDomainsByServerName(window.location.hostname);d.forEach(h,q.hitch(this,function(h){m(a,
null,{expires:-1,path:e});m(a,null,{expires:-1,path:e,domain:h});m(a,null,{expires:-1,path:e,domain:"."+h})}))};u.isLocaleChanged=function(a,e){return!a.startWith(e)};u.hashToObject=function(a){a=a.replace("#","");a=p.queryToObject(a);for(var e in a)if(a.hasOwnProperty(e))try{a[e]=r.parse(a[e])}catch(h){}return a};u.reCreateObject=function(a){function e(a){var b=[];a.forEach(function(a){Array.isArray(a)?b.push(e(a)):"object"===typeof a?b.push(h(a)):b.push(a)});return b}function h(a){var b={},n;for(n in a)a.hasOwnProperty(n)&&
(Array.isArray(a[n])?b[n]=e(a[n]):b[n]="object"===typeof a[n]?h(a[n]):a[n]);return b}return Array.isArray(a)?e(a):h(a)};u.setVerticalCenter=function(a){setTimeout(function(){var e=c(".jimu-vcenter-text",a),h,b;d.forEach(e,function(a){h=g.getContentBox(a).h;g.setStyle(a,{lineHeight:h+"px"})},this);e=c(".jimu-vcenter",a);d.forEach(e,function(a){h=g.getContentBox(a).h;b=g.getContentBox(c(a).parent()[0]).h;g.setStyle(a,{marginTop:(b-h)/2+"px"})},this)},10)};u.merge=x;u.loadStyleLink=function(a,e,h){var n=
new l,m=require(u.getRequireConfig()).toUrl(e);if(require.cache["url:"+m]){var c=require.cache["url:"+m],r=m.split("/").pop(),m=m.substr(0,m.length-r.length),c=E(c,m);h?g.create("style",{id:a,type:"text/css",innerHTML:c},g.byId(h),"before"):g.create("style",{id:a,type:"text/css",innerHTML:c},document.getElementsByTagName("head")[0]);n.resolve("load");return n}a=h?g.create("link",{id:a,rel:"stylesheet",type:"text/css",href:m},g.byId(h),"before"):g.create("link",{id:a,rel:"stylesheet",type:"text/css",
href:m},document.getElementsByTagName("head")[0]);b(a,"load",function(){n.resolve("load")});var s=setInterval(function(){var a;d.some(document.styleSheets,function(h){if(h.href&&h.href.substr(h.href.indexOf(e),h.href.length)===e)return a=h,!0})&&(!n.isFulfilled()&&(a.cssRules&&a.cssRules.length||a.rules&&a.rules.length)&&n.resolve("load"),clearInterval(s))},50);return n};u.changeLocation=function(a){window.history.pushState&&window.history.pushState({path:a},"",a)};u.urlToObject=function(a){var e=
null;-1===a.indexOf("#")?(e=D.urlToObject(a),e.hash=null):(a=a.split("#"),e=D.urlToObject(a[0]),e.hash=a[1]?-1<a[1].indexOf("\x3d")?p.queryToObject(a[1]):a[1]:null);return e};u.setConfigByTemplate=function(a,e,h){e=function(a){var e=[];a.split("_").forEach(function(a){var h=!1,b;"--"===a.slice(a.length-2)&&(h=!0,a=a.slice(0,a.length-2));b=a.search(/\[[0-9]+\]/);-1===b&&(b=a.length);e.push({key:a.slice(0,b),index:Number(a.slice(b+1,-1)),deleteFlag:h})});return e}(e);for(var b=1;b<e.length-1;b++)if(a=
q.isArray(a[e[b].key])?a[e[b].key][e[b].index]:a[e[b].key],!a)return;e[e.length-1].deleteFlag?!0===h&&(q.isArray(a[e[e.length-1].key])?delete a[e[e.length-1].key][e[e.length-1].index]:delete a[e[e.length-1].key]):q.isArray(a[e[e.length-1].key])?a[e[e.length-1].key][e[e.length-1].index]=h:a[e[e.length-1].key]=h};u.setConfigByTemplateWithId=function(a,e,h){function b(h){var n;n=e;var m=-1;h=n.search(RegExp(h));0<=h&&(n=n.slice(h,n.length),n=n.indexOf("]"),m=h+n+1);n=m;m=e.slice(h,n);return-1!==h?(h=
e.slice(h+m.indexOf("[")+1,n-1),n=e.slice(n+1,n.length),(h=a.getConfigElementById(h))?{object:h,key:"section_"+n,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var n=a,m=e,c=b("groups\\[.+\\]");"deleted"!==c.state&&("isSection"===c.state&&(n=c.object,m=c.key),c=b("widgets\\[.+\\]"),"delete"!==c.state&&("isSection"===c.state&&(n=c.object,m=c.key),u.setConfigByTemplate(n,m,h)))};u.addManifestProperies=function(a){a.icon=a.url+"images/icon.png";"theme"===a.category?I(a):F(a)};u.processManifestLabel=
function(a,e){a.label=a.i18nLabels&&(a.i18nLabels[e]||a.i18nLabels.defaultLabel)||a.label||a.name;a.layouts&&d.forEach(a.layouts,function(h){var b="i18nLabels_layout_"+h.name;h.label=a[b]&&(a[b][e]||a[b].defaultLabel)||h.label||h.name});a.styles&&d.forEach(a.styles,function(h){var b="i18nLabels_style_"+h.name;h.label=a[b]&&(a[b][e]||a[b].defaultLabel)||h.label||h.name})};u.addI18NLabel=function(a){var e=new l;if(a.i18nLabels)return e.resolve(a),e;a.i18nLabels={};if(a.properties&&!1===a.properties.hasLocale)return e.resolve(a),
e;var h="widget"===a.category?"_widgetLabel":"_themeLabel";require(["dojo/i18n!"+a.url+"/nls/strings.js"],function(b){a.i18nLabels[dojoConfig.locale]=b[h];"theme"===a.category&&(a.layouts&&a.layouts.forEach(function(e){a["i18nLabels_layout_"+e.name]={};a["i18nLabels_layout_"+e.name][dojoConfig.locale]=b["_layout_"+e.name]}),a.styles&&a.styles.forEach(function(e){a["i18nLabels_style_"+e.name]={};a["i18nLabels_style_"+e.name][dojoConfig.locale]=b["_style_"+e.name]}));e.resolve(a)});return e};u.localizeNumber=
function(a,h){var b={locale:k.locale};q.mixin(b,h||{});return e.format(a,b)};u.parseNumber=function(a,h){var b={locale:k.locale};q.mixin(b,h||{});return e.parse(a,b)};u.localizeDate=function(a,e){var h={locale:k.locale};q.mixin(h,e||{});return n.format(a,h)};u.addRelativePathInCss=E;return u})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(q,d,g){var f=q.NodeList;d.extend(f,{_buildArrayFromCallback:function(k){for(var d=[],c=0;c<this.length;c++){var s=
k.call(this[c],this[c],d);s&&(d=d.concat(s))}return d},_getUniqueAsNodeList:function(k){for(var d=[],c=0,s;s=k[c];c++)1==s.nodeType&&-1==g.indexOf(d,s)&&d.push(s);return this._wrap(d,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(k,d){var c=this._getUniqueAsNodeList(k),c=d?q._filterResult(c,d):c;return c._stash(this)},_getRelatedUniqueNodes:function(d,f){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(f),d)},children:function(k){return this._getRelatedUniqueNodes(k,
function(k,c){return d._toArray(k.childNodes)})},closest:function(d,f){return this._getRelatedUniqueNodes(null,function(c,s){do if(q._filterResult([c],d,f).length)return c;while(c!=f&&(c=c.parentNode)&&1==c.nodeType);return null})},parent:function(d){return this._getRelatedUniqueNodes(d,function(d,c){return d.parentNode})},parents:function(d){return this._getRelatedUniqueNodes(d,function(d,c){for(var s=[];d.parentNode;)d=d.parentNode,s.push(d);return s})},siblings:function(d){return this._getRelatedUniqueNodes(d,
function(d,c){for(var s=[],l=d.parentNode&&d.parentNode.childNodes,b=0;b<l.length;b++)l[b]!=d&&s.push(l[b]);return s})},next:function(d){return this._getRelatedUniqueNodes(d,function(d,c){for(var s=d.nextSibling;s&&1!=s.nodeType;)s=s.nextSibling;return s})},nextAll:function(d){return this._getRelatedUniqueNodes(d,function(d,c){for(var s=[],l=d;l=l.nextSibling;)1==l.nodeType&&s.push(l);return s})},prev:function(d){return this._getRelatedUniqueNodes(d,function(d,c){for(var s=d.previousSibling;s&&1!=
s.nodeType;)s=s.previousSibling;return s})},prevAll:function(d){return this._getRelatedUniqueNodes(d,function(d,c){for(var s=[],l=d;l=l.previousSibling;)1==l.nodeType&&s.push(l);return s})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(d,f){return 0!=f%2})},odd:function(){return this.filter(function(d,f){return 0==
f%2})}});return f})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(q,d,g,f,k,p,c,s){return q(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var l=g.map(this.geometries,function(b){return b.toJson()}),b={};b.outSR=this.outSR.wkid||f.toJson(this.outSR.toJson());b.inSR=this.geometries[0].spatialReference.wkid||
f.toJson(this.geometries[0].spatialReference.toJson());b.geometries=f.toJson({geometryType:s.getJsonType(this.geometries[0]),geometries:l});this.transformation&&(b.transformation=this.transformation.wkid||f.toJson(this.transformation));c.isDefined(this.transformForward)&&(b.transformForward=this.transformForward);return b}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang"],function(q){var d={};String.prototype.startWith=function(d){return this.substr(0,d.length)===d?!0:!1};String.prototype.endWith=
function(d){return this.substr(this.length-d.length,d.length)===d?!0:!1};d.getServerByUrl=function(d){d=q.trim(d||"");d=d.replace(/http(s?):\/\//gi,"");return d.split("/")[0]};d.getServerWithProtocol=function(g){var f="";if(g=q.trim(g||""))f=d.getProtocol(g)||"http",g=d.getServerByUrl(g),f=f+"://"+g;return f};d.isSameServer=function(g,f){g=d.getServerByUrl(g);f=d.getServerByUrl(f);return g===f};d.isOnline=function(g){return 0<=d.getServerByUrl(g).toLowerCase().indexOf(".arcgis.com")};d.isArcGIScom=
function(g){g=d.getServerByUrl(g).toLowerCase();return"www.arcgis.com"===g||"arcgis.com"===g};d.getStandardPortalUrl=function(g){var f=d.getServerByUrl(g);if(""===f)return"";d.isOnline(f)?(d.isArcGIScom(f)&&(f="www.arcgis.com"),g=(d.getProtocol(g)||"http")+"://"+f):(g=q.trim(g||"").replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),g=d.addProtocol(g),g.replace(RegExp("http(s?)://"+f,"g"),"")||(g+="/arcgis"));return g};d.isSamePortalUrl=function(g,f){var k=/^http(s?):\/\//gi;g=d.getStandardPortalUrl(g).toLowerCase().replace(k,
"");f=d.getStandardPortalUrl(f).toLowerCase().replace(k,"");return g===f};d.addProtocol=function(d){-1>=d.indexOf("http://")&&-1>=d.indexOf("https://")&&(d=d.startWith("//")?window.location.protocol+d:d.startWith("/")?window.location.protocol+"//"+window.location.host+d:window.location.protocol+"//"+d);return d};d.getProtocol=function(d){var f="";0===d.indexOf("https://")?f="https":0===d.indexOf("http://")&&(f="http");return f};d.setHttpProtocol=function(g){g=d.addProtocol(g);return g.replace(/^https:\/\//,
"http://")};d.setHttpsProtocol=function(g){g=d.addProtocol(g);return g.replace(/^http:\/\//,"https://")};d.getSharingUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing");return f};d.getOAuth2Url=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing/oauth2");return f};d.getAppIdUrl=function(g,f){var k="",p=d.getStandardPortalUrl(g);p&&(k=p+"/sharing/oauth2/apps/"+f);return k};d.getSignInUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/signin.html");
return f};d.getBaseSearchUrl=function(g){var f="";g=d.getStandardPortalUrl(g);(g=g.replace(/\/*$/g,""))&&(f=g+"/sharing/rest/search");return f};d.getBaseItemUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing/rest/content/items");return f};d.getItemUrl=function(g,f){var k="",p=d.getBaseItemUrl(g);p&&f&&(k=p+"/"+f);return k};d.getItemDataUrl=function(g,f){var k="",p=d.getItemUrl(g,f);p&&(k=p+"/data");return k};d.getGenerateTokenUrl=function(g){var f="";g&&(g=d.getStandardPortalUrl(g),
f=g+"/sharing/generateToken");return f};d.getItemDetailsPageUrl=function(g,f){var k="";g&&f&&(g=d.getStandardPortalUrl(g),k=g+"/home/item.html?id\x3d"+f);return k};d.getUserProfilePageUrl=function(g,f){var k="";g&&f&&(g=d.getStandardPortalUrl(g),k=g+"/home/user.html?user\x3d"+f);return k};d.getBaseGroupUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing/rest/community/groups");return f};d.getPortalSelfInfoUrl=function(g){var f="";(g=d.getStandardPortalUrl(g||""))&&(f=g+"/sharing/portals/self");
return f};d.getCommunitySelfUrl=function(g){var f="";(g=d.getStandardPortalUrl(g||""))&&(f=g+"/sharing/rest/community/self");return f};d.getBaseUserUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing/rest/community/users");return f};d.getUserUrl=function(g,f){var k="",p=d.getBaseUserUrl(g);g&&f&&(k=p+"/"+f);return k};d.getUserTagsUrl=function(g,f){var k="",p=d.getUserUrl(g,f);g&&f&&(k=p+"/tags");return k};d.getContentUrl=function(g){var f="";g&&(g=d.getStandardPortalUrl(g),f=g+
"/sharing/rest/content");return f};d.getUserContentUrl=function(g,f,k){var p="",p="";g&&f&&(p=d.getContentUrl(g),p=k?p+"/users/"+f+"/"+k:p+"/users/"+f);return p};d.getAddItemUrl=function(g,f,k){var p="",p="";g&&f&&(p=d.getUserContentUrl(g,f,k),p+="/addItem");return p};d.getDeleteItemUrl=function(g,f,k){var p="";(g=d.getUserItemsUrl(g,f))&&(p=g+"/"+k+"/delete");return p};d.getUserItemsUrl=function(g,f,k){var p="",p="";g&&f&&(p=d.getUserContentUrl(g,f,k),p+="/items");return p};d.getUpdateItemUrl=function(g,
f,k,p){var c="",c="";g&&f&&(c=d.getUserItemsUrl(g,f,p),c=c+"/"+k+"/update");return c};d.shareItemUrl=function(g,f,k,p){var c="",c="";g&&f&&(c=d.getUserItemsUrl(g,f,p),c=c+"/"+k+"/share");return c};d.getHomeIndexUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/index.html");return f};d.getHomeMapViewerUrl=function(g,f){var k="",p=d.getStandardPortalUrl(g);p&&(k=p+"/home/webmap/viewer.html",k=f?k+("?webmap\x3d"+f):k+"?useExisting\x3d1");return k};d.getHomeGalleryUrl=function(g){var f=
"";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/gallery.html");return f};d.getHomeGroupsUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/groups.html");return f};d.getHomeMyContentUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/content.html");return f};d.getHomeMyOrganizationUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/organization.html");return f};d.getHomeUserUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/home/user.html");
return f};d.getPortalHelpUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/portalhelp/en/website/help/");return f};d.getPortalProxyUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=(g+"/sharing/proxy").replace("https://","http://"));return f};d.getOAuth2SignOutUrl=function(g){var f="";(g=d.getStandardPortalUrl(g))&&(f=g+"/sharing/oauth2/signout");return f};d.getNewPrintUrl=function(g){var f="";if(g=d.getStandardPortalUrl(g))g=d.setHttpProtocol(g),f=g+"/sharing/tools/newPrint";
return f};d.getPortalUrlFromLocation=function(){return d.getPortalServerFromLocation()+d.getDeployContextFromLocation()};d.getPortalSignInUrlFromLocation=function(){return d.getPortalUrlFromLocation()+"home/signin.html"};d.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};d.getDeployContextFromLocation=function(){var d=window.location.href.split("?")[0],f=d.indexOf("/home");0>f&&(f=d.indexOf("/apps"));d=d.substring(d.indexOf(window.location.host)+window.location.host.length+
1,f);"/"!==d&&(d="/"+d+"/");return d};d.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+d.getDeployContextFromLocation()+"sharing/rest/"};return d})},"jimu/tokenUtils":function(){define(["jimu/BaseTokenUtils","dojo/topic","dojo/aspect","dojo/_base/lang"],function(q,d,g,f){q=new q;var k=null;q.declaredClass="jimu.TokenUtils";q.getAppConfig=function(){return k};q.setAppConfig=function(d){k=f.mixin({},d);this.setPortalUrl(k.portalUrl)};q.isRightWindowScope=
function(){return!this.isInBuilderWindow()};q.getAppMode=function(){var d="";k&&(d=k.mode);return d};q.tryPublishUserSignInToExternal=function(k){if(this.isRightWindowScope()){var c=this.getAppMode();"config"===c?d.publish("configUserSignIn",k):"preview"===c&&d.publish("previewUserSignIn",k)}};q.tryPublishUserSignOutToExternal=function(k){if(this.isRightWindowScope()){var c=this.getAppMode();"config"===c?d.publish("configUserSignOut",k):"preview"===c&&d.publish("previewUserSignOut",k)}};q.bindEvents=
function(){if(this._bind||this.isRightWindowScope())this._bind=!0,this._bindEvents(),d.subscribe("appConfigLoaded",f.hitch(this,function(d){this.isRightWindowScope()&&this.setAppConfig(d)})),d.subscribe("appConfigChanged",f.hitch(this,function(d){this.isRightWindowScope()&&this.setAppConfig(d)}))};q.startup();return q})},"jimu/BaseTokenUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/request esri/IdentityManager esri/Credential esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n){"function"!==typeof c.getAll&&(c.getAll=function(a){var e=[];(a=c(a))&&e.push(a);return e});return q([],{portalUrl:null,cookiePath:"/",_started:!1,isRightWindowScope:function(){},isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(e){console.log(e),a=!1}return!!a},isRunInPortal:function(){return window.isRunInPortal},
isStringStartWith:function(a,e){return a.substr(0,e.length)===e},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=e.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var n=new p;a=e.getStandardPortalUrl(a);var m=a+"/sharing";a=e.setHttpsProtocol(a+"/sharing/generateToken?f\x3djson");b.get(a,{jsonp:"callback"}).then(d.hitch(this,function(a){a.token?(this.removeWabAuthCookie(),esri.id.getCredential(m).then(d.hitch(this,
function(e){e.token||(e.token=a.token);n.resolve(!0)}),d.hitch(this,function(){n.resolve(!0)}))):n.resolve(!1)}),d.hitch(this,function(a){console.error(a);n.reject(a)}));return n},tryRegisterCredential:function(a){return!this.isValidCredential(a)?!1:!g.some(esri.id.credentials,d.hitch(this,function(e){return a.token===e.token}))?(esri.id.credentials.push(a),!0):!1},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&d.trim(a)},signInPortal:function(a){var b=new p;if(this._isInvalidPortalUrl(a)){a=
e.getStandardPortalUrl(a);var n=e.getSharingUrl(a),m=this.getPortalCredential(a);m?setTimeout(d.hitch(this,function(){b.resolve(m)}),0):b=esri.id.getCredential(n)}else setTimeout(d.hitch(this,function(){b.reject("Invalid portalurl.")}),0);return b},_loadPortalSelfInfo:function(a){a=e.getPortalSelfInfoUrl(a);return r({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(e,b){if(!e||!("string"===typeof e&&b&&"string"===typeof b))return null;var n=esri.id.findOAuthInfo(e);
n||(n=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",n=new a({appId:b,expiration:20160,portalUrl:e,authNamespace:"/",popup:!0,popupCallbackUrl:n}),esri.id.registerOAuthInfos([n]));n.appId=b;return n},signOutAll:function(){var a=e.getStandardPortalUrl(this.portalUrl),b=!!esri.id.findCredential(a+"/sharing/rest");this.removeWabAuthCookie();this.removeEsriAuthCookieStorage();esri.id.destroyCredentials();b&&this._publishCurrentPortalUserSignOut(a)},signOutPortal:function(a){if(a=
d.trim(a||"")){var b=e.isSamePortalUrl(a,this.portalUrl),n=this.getPortalCredential(a)&&b;this._removePortalCredential(a);b&&(this.isRunInPortal()?this.removeCookie("esri_auth"):this.removeCookie("wab_auth"));n&&this._publishCurrentPortalUserSignOut(a)}},userHaveSignInPortal:function(a){return!!this.getPortalCredential(d.trim(a||""))},isValidCredential:function(a){var e=!1;if(a){var e=a.token,b=a.server,n=a.scope,e=e&&"string"===typeof e&&d.trim(e),b=b&&"string"===typeof b&&d.trim(b),n="portal"===
n||"server"===n,m=!0;a.expires&&(a=parseInt(a.expires,10),m=(new Date).getTime(),m=a>m);e=e&&b&&n&&m}return e},isValidPortalCredentialOfPortalUrl:function(a,b){var n=!1;if(this.isValidCredential(b))var n="portal"===b.scope,m=e.isSameServer(a,b.server),n=n&&m;return n},getPortalCredential:function(a){var b=null;a=d.trim(a||"");if(!a)return null;a=e.getStandardPortalUrl(a);return b=this._filterPortalCredential(a,esri.id.credentials)},saveAndRegisterCookieToCredential:function(a){a=d.clone(a);a.referer=
window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var e=a.server+"/sharing/rest";a.server=e;esri.id.registerToken(a);return esri.id.findCredential(e,a.userId)},registerAuth2Hash:function(a){a=d.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,n=e.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:n,token:a.access_token,expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},
saveWabCookie:function(a){this.removeCookie("wab_auth");c("wab_auth",JSON.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,e){var b=null;if(e&&0<e.length){var n=g.filter(e,d.hitch(this,
function(e){return this.isValidPortalCredentialOfPortalUrl(a,e)}));0<n.length&&(b=n[n.length-1])}return b},_removePortalCredential:function(a){var b=d.trim(a||"");if(b){b=e.getStandardPortalUrl(b);for(a=g.filter(esri.id.credentials,d.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);esri.id.credentials=g.filter(esri.id.credentials,d.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,a)}))}},getUserIdByToken:function(a,
b){var n=new p;if(a&&"string"===typeof a&&b&&"string"===typeof b){var m=e.getStandardPortalUrl(b),c=g.filter(esri.id.credentials,d.hitch(this,function(b){var n=b.token===a&&b.userId;b=e.isSameServer(m,b.server);return n&&b}));if(0<c.length){var l=c[0];setTimeout(d.hitch(this,function(){n.resolve(l.userId)}),0);return n}c=e.getCommunitySelfUrl(m);r({url:c,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(d.hitch(this,function(a){n.resolve(a&&a.username||"")}),d.hitch(this,function(a){console.error(a);
n.reject("fail to get userId by token")}))}else setTimeout(d.hitch(this,function(){n.reject("invalid parameters")}),0);return n},xtGetCredentialFromCookie:function(a){var b=c("wab_auth"),n=null;if(b)try{n=s.parse(b)}catch(m){console.error(m)}if(!(n&&"object"===typeof n)||!e.isSameServer(a,n.server)||window.location.host!==n.referer)return null;n.expires=parseInt(n.expires,10);b=(new Date).getTime();if(!(n.expires>b))return this.removeCookie("wab_auth"),null;a+="/sharing/rest";n.server=a;(b=esri.id.findCredential(a))||
esri.id.registerToken(n);return b=esri.id.findCredential(a)},removeCookie:function(a){var e=this.getCookiePath();n.removeCookie(a,e)},_getDomainsByServerName:function(a){var e=a.split("."),b=e.length;return g.map(e,d.hitch(this,function(a,n){var h=e.slice(n,b),m="",c=h.length-1;g.forEach(h,d.hitch(this,function(a,e){m+=a;e!==c&&(m+=".")}));return m}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{l.publish("userSignIn",a)}catch(e){console.error(e)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{l.publish("anyUserSignIn",
a)}catch(e){console.error(e)}},_publishCurrentPortalUserSignOut:function(a){try{l.publish("userSignOut",a)}catch(e){console.error(e)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a),this._isNormalScope(a)}catch(e){console.error(e)}},_isNormalScope:function(a){var e=!0;esri.id._isRESTService&&(a.resources&&0<a.resources.length)&&(e=g.every(a.resources,d.hitch(this,function(e){return(esri.id._isRESTService(e)?
"server":"portal")===a.scope})));return e},tryPublishUserSignInToExternal:function(a){},tryPublishUserSignOutToExternal:function(a){},_bindEvents:function(){this.isRightWindowScope()&&k.after(esri.id,"signIn",d.hitch(this,function(a,e){console.log(e[1]);k.after(a,"callback",d.hitch(this,function(a,e){this._signInSuccess(e[0],!1)}));return a}))},_bind:!1,bindEvents:function(){if(this._bind||this.isRightWindowScope())this._bind=!0,this._bindEvents()},isStart:function(){return this._started},startup:function(){if(this.isInConfigOrPreviewWindow()){var a=
window.parent;if(a&&(a=a.esri&&a.esri.id))window.esri.id=a}this.isRightWindowScope()&&(this._started||this.bindEvents(),this._started=!0)}})})},"jimu/portalUtils":function(){define(["jimu/BasePortalUtils","jimu/tokenUtils"],function(q,d){var g=new q;g.declaredClass="jimu.PortalUtils";g.setTokenUtils(d);return g})},"jimu/BasePortalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic esri/request ./utils ./portalUrlUtils".split(" "),
function(q,d,g,f,k,p,c,s,l){var b=q([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,tokenUtils:null,constructor:function(a){this.portalUrl=l.getStandardPortalUrl(a);this.selfUrl=l.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=new k;c({url:this.selfUrl,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(e){var b=e.user;delete e.user;d.mixin(this,e);e.user=b;a.resolve(e)}),d.hitch(this,function(e){console.error(e);
a.reject(e)}));return a},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=this.tokenUtils.getPortalCredential(this.portalUrl))},signIn:function(){var a=new k;this.updateCredential();this.isValidCredential()?setTimeout(d.hitch(this,function(){a.resolve(this.credential)}),
0):a=this.tokenUtils.signInPortal(this.portalUrl);return a},haveSignIn:function(){return this.tokenUtils.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new k;this.user&&"jimu.PortalUser"===this.user.declaredClass?setTimeout(d.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(d.hitch(this,
function(e){this.user=e;a.resolve(this.user)}),d.hitch(this,function(e){console.error(e);a.reject(e)})):this.tokenUtils.getUserIdByToken(this.credential.token,this.portalUrl).then(d.hitch(this,function(e){this.credential.userId=e;this._getUser(this.credential.userId).then(d.hitch(this,function(e){this.user=e;a.resolve(this.user)}),d.hitch(this,function(e){console.error(e);a.reject(e)}))}),d.hitch(this,function(e){console.error(e);a.reject(e)})):setTimeout(d.hitch(this,function(){a.reject("credential is null.")}),
0);return a},queryItems:function(a){this.updateCredential();var e=new k,b=l.getBaseSearchUrl(this.portalUrl),h={f:"json"};a&&(h=d.mixin(h,a));this.isValidCredential()&&(h.token=this.credential.token);!h.sortField&&!h.sortOrder&&(h.sortField="title",h.sortOrder="asc");c({url:b,handleAs:"json",content:h,callbackParamName:"callback"}).then(d.hitch(this,function(a){a.results=g.map(a.results,d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=
this;return new t(a)}));e.resolve(a)}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e},getItemData:function(a){this.updateCredential();a={url:l.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return c(a)},getItemById:function(a){var e=new k;this.updateCredential();a={url:l.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential()&&(a.content.token=this.credential.token);c(a).then(d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;a=new t(a);e.resolve(a)}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e},getAppById:function(a){var e=new k;this.updateCredential();this.isValidCredential()?(a=l.getAppIdUrl(this.portalUrl,a),e=c({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(d.hitch(this,
function(){e.reject("token is null.")}),0);return e},queryGroups:function(a){this.updateCredential();var e=new k,b=l.getBaseGroupUrl(this.portalUrl),h={f:"json"};a&&(h=d.mixin(h,a));this.isValidCredential()&&(h.token=this.credential.token);c({url:b,handleAs:"json",content:h,callbackParamName:"callback"}).then(d.hitch(this,function(a){a.results=g.map(a.results,d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;return new m(a)}));
e.resolve(a)}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e},registerApp:function(a,e,b){var h=new k;this.updateCredential();if(this.isValidCredential())var m=this.credential&&this.credential.token,r=l.getOAuth2Url(this.portalUrl),h=c({url:r+"/registerApp",content:{itemId:a,appType:e,redirect_uris:JSON.stringify(b),token:m,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(d.hitch(this,function(){h.reject("token is null.")}),0);return h},createAndRegisterApp:function(a){var e=
new k;this.updateCredential();this.isValidCredential()?this.getUser().then(d.hitch(this,function(b){b.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(d.hitch(this,function(b){b.success?this.registerApp(b.id,"browser",a).then(d.hitch(this,function(a){e.resolve(a)}),d.hitch(this,function(a){console.error(a);e.reject(a)})):e.reject("create app failed")}),d.hitch(this,function(a){console.error(a);e.reject(a)}))}),d.hitch(this,
function(a){console.error(a);e.reject(a)})):setTimeout(d.hitch(this,function(){e.reject("token is null.")}),0);return e},_getUser:function(a){this.updateCredential();var e=new k;a=l.getUserUrl(this.portalUrl,a);c({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;this.user=new r(a);e.resolve(this.user)}),d.hitch(this,function(a){console.error(a);e.reject(a)}));
return e}}),r=q([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,tokenUtils:null,portal:null,constructor:function(a){a&&d.mixin(this,a)},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getGroups:function(){var a=
[];this.groups&&(a=g.map(this.groups,d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this.portal;return new m(a)})));return a},getItemsByKeywords:function(a,e){return this.portal.queryItems({start:e||1,num:100,q:"owner:"+this.username+" AND typekeywords:"+a})},getContent:function(){this.updateCredential();var a={url:l.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};
this.isValidCredential&&(a.content.token=this.credential.token);return c(a)},getTags:function(){this.updateCredential();var a={url:l.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return c(a)},addItem:function(a,e){this.updateCredential();var b=new k;if(this.isValidCredential()){var h={f:"json",token:this.credential.token};a&&(h=d.mixin(h,a));c({url:l.getAddItemUrl(this.portalUrl,
this.username,e),handleAs:"json",callbackParamName:"callback",content:h},{usePost:!0}).then(d.hitch(this,function(a){b.resolve(a)}),d.hitch(this,function(a){console.error(a);b.reject(a)}))}else setTimeout(d.hitch(this,function(){b.reject("token is null.")}),0);return b},deleteItem:function(a){this.updateCredential();var e=new k;this.isValidCredential()?(a=l.getDeleteItemUrl(this.portalUrl,this.username,a),e=c({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(d.hitch(this,
function(){e.reject("token is null.")}),0);return e},getItemById:function(a,e){this.updateCredential();var b=new k,h={url:l.getUserItemsUrl(this.portalUrl,this.username,e)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(h.content.token=this.credential.token);c(h).then(d.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;a=new t(a);b.resolve(a)}),d.hitch(this,function(a){console.error(a);
b.reject(a)}));return b},shareItem:function(a,e,b){this.updateCredential();var h=new k;this.isValidCredential()?(e={url:l.shareItemUrl(this.portalUrl,this.username,e,b),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(e.content=d.mixin(e.content,a)),c(e,{usePost:!0}).then(d.hitch(this,function(a){h.resolve(a)}),d.hitch(this,function(a){console.error(a);h.reject(a)}))):setTimeout(d.hitch(this,function(){h.reject("token is null.")}),0);return h},updateItem:function(a,
e){this.updateCredential();var b=new k;this.isValidCredential()?this.portal.getItemById(a).then(d.hitch(this,function(h){var m={f:"json",token:this.credential.token};e&&(m=d.mixin(m,e));c({url:l.getUpdateItemUrl(this.portalUrl,this.username,a,h.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:m},{usePost:!0}).then(d.hitch(this,function(a){b.resolve(a)}),d.hitch(this,function(a){console.error(a);b.reject(a)}))}),d.hitch(this,function(a){console.error(a);b.reject(a)})):
setTimeout(d.hitch(this,function(){b.reject("token is null.")}),0);return b}}),m=q([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,tokenUtils:null,portal:null,constructor:function(a){a&&d.mixin(this,a)},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),
this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),t=q([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,tokenUtils:null,portal:null,token:null,constructor:function(a){a&&d.mixin(this,a);this.itemUrl=l.getItemUrl(this.portalUrl,this.id);!this.thumbnailUrl&&(this.thumbnail&&this.itemUrl)&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=
this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=l.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=l.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)}});return q([],{portals:[],webMapQueryStr:" "+s.getItemQueryStringByTypes(["Web Map"])+" ",tokenUtils:null,constructor:function(){p.subscribe("userSignOut",d.hitch(this,function(a){(a=this._findPortal(a))&&a.clearCredentialAndUser()}))},setTokenUtils:function(a){this.tokenUtils=a},_findPortal:function(a){for(var e=
0;e<this.portals.length;e++){var b=this.portals[e];if(l.isSamePortalUrl(a,b.portalUrl))return b.updateCredential(),b}return null},getPortal:function(a){if(!a||!("string"===typeof a&&d.trim(a)))return null;a=l.getStandardPortalUrl(a);var e=this._findPortal(a);e||(e=new b(a),e.tokenUtils=this.tokenUtils,e.credential=e.tokenUtils.getPortalCredential(e.portalUrl),e.updateCredential(),this.portals.push(e));return e},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,
"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var e="english",b="",h=new k;this.getPortal(a).getUser().then(d.hitch(this,function(a){a&&a.units?e=a.units:(b=f.locale,e=b.startWith("en")?"english":"metric");h.resolve(e)}),d.hitch(this,function(m){console.warn(m);this.getPortalSelfInfo(a).then(d.hitch(this,function(a){b=a&&a.culture||f.locale}),d.hitch(this,function(a){console.warn(a);b=f.locale})).always(d.hitch(this,
function(){e=b.startWith("en")?"english":"metric";h.resolve(e)}))}));return h.promise},_getPortalSelfGroup:function(a,e){var b=new k,h=this.getPortal(a);h||setTimeout(d.hitch(this,function(){b.reject()}),0);this.getPortalSelfInfo(a).then(d.hitch(this,function(a){h.queryGroups({f:"json",q:a[e]}).then(d.hitch(this,function(a){0<a.results.length?(a=a.results[0],a.portalUrl=h.portalUrl,a.credential=h.credential,a.tokenUtils=h.tokenUtils,a.portal=h,a=new m(a),b.resolve(a)):b.reject("Can't find portal self group.")}),
d.hitch(this,function(a){console.error(a);b.reject(a)}))}),d.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getWebMapsFromBasemapGalleryGroup:function(a){var e=new k;this.getBasemapGalleryGroup(a).then(d.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(d.hitch(this,function(a){e.resolve(a)}),d.hitch(this,function(a){console.error(a);e.reject(a)})):e.reject()}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e},getDefaultWebMap:function(a){var e=
new k;this.getPortalSelfInfo(a).then(d.hitch(this,function(b){var h=b.defaultBasemap&&b.defaultBasemap.id;h?e.resolve(h):this._getDefaultWebMapByBasemapGallery(a,b).then(d.hitch(this,function(b){b?e.resolve(b):this._getMostNumViewsWebMap(a).then(d.hitch(this,function(a){a?e.resolve(a):e.reject()}),d.hitch(this,function(a){console.error(a);e.reject(a)}))}),d.hitch(this,function(a){console.error(a);e.reject(a)}))}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e},_getDefaultWebMapByBasemapGallery:function(a,
e){var b=new k,h=this.getPortal(a),m=e.defaultBasemap&&e.defaultBasemap.title;h.queryGroups({f:"json",q:e.basemapGalleryGroupQuery}).then(d.hitch(this,function(a){a=a.results;0<a.length?h.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+a[0].id+" AND title:"+m}).then(d.hitch(this,function(a){a=a.results;a=g.filter(a,d.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),
h.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+m}).then(d.hitch(this,function(a){a=a.results;a=g.filter(a,d.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):(console.log("Can't find web map by defaultBasemap.title."),b.resolve(null))}),d.hitch(this,function(a){console.error(a);b.reject(a)})))}),d.hitch(this,function(a){console.error(a);b.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),b.resolve(null))}),
d.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getMostNumViewsWebMap:function(a){var e=new k;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr,sortField:"numViews",sortOrder:"desc"}).then(d.hitch(this,function(a){a=a.results;a=g.filter(a,d.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?e.resolve(a[0].id):e.reject("Can't find most-num-views web map.")}),d.hitch(this,function(a){console.error(a);e.reject(a)}));return e}})})},
"jimu/LayoutManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dojo/topic dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/aspect dojo/cookie dojo/Deferred dojo/promise/all dojo/_base/fx dojo/fx require ./WidgetManager ./ConfigManager ./PanelManager ./MapManager ./utils ./PreloadWidgetIcon ./WidgetPlaceholder ./dijit/LoadingShelter".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w,C,D,E){var x=null,v;v=q([k],
{constructor:function(a,e){this.widgetManager=z.getInstance();this.panelManager=B.getInstance();this.own(p.subscribe("appConfigLoaded",d.hitch(this,this.onAppConfigLoaded)));this.own(p.subscribe("appConfigChanged",d.hitch(this,this.onAppConfigChanged)));this.own(p.subscribe("mapLoaded",d.hitch(this,this.onMapLoaded)));this.own(p.subscribe("mapChanged",d.hitch(this,this.onMapChanged)));this.own(p.subscribe("beforeMapDestory",d.hitch(this,this.onBeforeMapDestory)));this.own(p.subscribe("actionTriggered",
d.hitch(this,this.onActionTriggered)));this.widgetPlaceholders=[];this.preloadWidgetIcons=[];this.preloadGroupPanels=[];this.invisibleWidgetIds=[];this.own(c(window,"resize",d.hitch(this,this.resize)));this.id=e},postCreate:function(){this.containerNode=this.domNode},map:null,mapId:"map",hlDiv:null,animTime:500,resize:function(){g.forEach(this.widgetManager.getAllWidgets(),function(a){!1===a.inPanel&&a.resize()},this)},onAppConfigLoaded:function(a){this.appConfig=d.clone(a);this.appConfig.theme&&
this._loadTheme(this.appConfig.theme);this._loadMap()},onAppConfigChanged:function(a,e,b){a=d.clone(a);switch(e){case "themeChange":this._onThemeChange(a);break;case "styleChange":this._onStyleChange(a);break;case "layoutChange":this._onLayoutChange(a);break;case "widgetChange":this._onWidgetChange(a,b);break;case "groupChange":this._onGroupChange(a,b);break;case "widgetPoolChange":this._onWidgetPoolChange(a);break;case "resetConfig":this._onResetConfig(a)}this.appConfig=a},onMapLoaded:function(a){this.map=
a;this.panelManager.map=a;this._loadSplash();this._loadPreloadWidgets(this.appConfig)},onMapChanged:function(a){this.map=a;this.panelManager.map=a;this._loadPreloadWidgets(this.appConfig)},onBeforeMapDestory:function(){this.panelManager.destroyAllPanels();this._destroyPreloadPanelessWidgets();this._destroyWidgetPlaceholders();this._destroyPreloadWidgetIcons()},onActionTriggered:function(a,e,b){"highLight"===e&&(g.forEach(this.widgetPlaceholders,function(e){e.configId===a&&this._highLight(e)},this),
g.forEach(this.preloadWidgetIcons,function(e){e.configId===a&&this._highLight(e)},this),g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(e){e.configId===a&&this._highLight(e)},this));"removeHighLight"===e&&this._removeHighLight()},_highLight:function(a){if(a.domNode){this.hlDiv&&this._removeHighLight(a);var e=b.getMarginBox(a.domNode);this.hlDiv=s.create("div",{style:{position:"absolute",left:e.l-2+"px",top:e.t-2+"px",width:e.w+"px",height:e.h+"px"},"class":"icon-highlight"},a.domNode,
"before")}},_removeHighLight:function(){this.hlDiv&&(s.destroy(this.hlDiv),this.hlDiv=null)},_onWidgetChange:function(a,e){e=a.getConfigElementById(e.id);e.isController?this._reloadControllerWidget(a):(g.forEach(this.widgetPlaceholders,function(a){a.configId===e.id&&(a.destroy(),this._loadPreloadWidget(e))},this),this._removeDestroyed(this.widgetPlaceholders),g.forEach(this.preloadWidgetIcons,function(a){if(a.configId===e.id){var b=a.state;a.destroy();this._loadPreloadWidget(e).then(function(a){if("opened"===
b)a.onClick()})}},this),this._removeDestroyed(this.preloadWidgetIcons),g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(a){a.configId===e.id&&(a.destroy(),!1===e.visible?0>this.invisibleWidgetIds.indexOf(e.id)&&this.invisibleWidgetIds.push(e.id):this._loadPreloadWidget(e))},this),g.forEach(this.preloadGroupPanels,function(a){a.reloadWidget(e)},this),this._updatePlaceholder(a),g.forEach(this.invisibleWidgetIds,function(a){a===e.id&&!1!==e.visible&&(this._loadPreloadWidget(e),a=this.invisibleWidgetIds.indexOf(e.id),
this.invisibleWidgetIds.splice(a,1))},this),e.isPreload||this._reloadControllerWidget(a))},_onGroupChange:function(a,e){e=a.getConfigElementById(e.id);g.forEach(this.panelManager.panels,function(a){a.config.id===e.id&&a.updateConfig(e)},this);e.isPreload||this._reloadControllerWidget(a)},_updatePlaceholder:function(a){g.forEach(this.widgetPlaceholders,function(e){e.setIndex(a.getConfigElementById(e.configId).placeholderIndex)},this)},_onWidgetPoolChange:function(a){this._reloadControllerWidget(a)},
_reloadControllerWidget:function(a){var e=0<this.widgetManager.getControllerWidgets().length?this.widgetManager.getControllerWidgets()[0]:null;if(e){var b=e.getOpenedIds(),h=e.windowState;this.appConfig.getConfigElementById(e.id);this.appConfig.visitElement(d.hitch(this,function(a,e,b,h){h||this.panelManager.destroyPanel(a.id+"_panel")}));this.widgetManager.destroyWidget(e);this._loadPreloadWidget(a.getConfigElementById(e.id)).then(d.hitch(this,function(a){this.widgetManager.changeWindowStateTo(a,
h);a.setOpenedIds(b)}))}},_removeDestroyed:function(a){var e=[];g.forEach(a,function(a){a._destroyed&&e.push(a)});g.forEach(e,function(e){e=a.indexOf(e);a.splice(e,1)})},_destroyPreloadWidgetIcons:function(){g.forEach(this.preloadWidgetIcons,function(a){a.destroy()},this);this.preloadWidgetIcons=[]},_destroyPreloadPanelessWidgets:function(){g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(a){this.widgetManager.destroyWidget(a)},this)},_destroyWidgetPlaceholders:function(){g.forEach(this.widgetPlaceholders,
function(a){a.destroy()},this);this.widgetPlaceholders=[]},_destroyPreloadGroupPanels:function(){g.forEach(this.preloadGroupPanels,function(a){this.panelManager.destroyPanel(a)},this);this.preloadGroupPanels=[]},_changeMapPosition:function(a){var e={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};this.map&&(e=d.mixin(e,w.getPositionStyle(a.map.position)),f.setStyle(this.mapId,e),this.map.resize())},_onThemeChange:function(a){this._destroyPreloadWidgetIcons();this._destroyWidgetPlaceholders();
this._destroyPreloadPanelessWidgets();this.panelManager.destroyAllPanels();this._updateCommonStyle(a);this._onStyleChange(a);this._changeMapPosition(a);this._loadPreloadWidgets(a)},_onResetConfig:function(a){a.map.itemId!==this.appConfig.map.itemId?(p.publish("appConfigChanged",a,"mapChange",a),this._updateCommonStyle(a),this._onStyleChange(a),this._changeMapPosition(a)):this._onThemeChange(a)},_updateCommonStyle:function(a){var e=this.appConfig.theme;f.removeClass(this.domNode,e.name);f.destroy(this._getThemeCommonStyleId(e));
this._loadThemeCommonStyle(a.theme)},_onStyleChange:function(a){var e=this.appConfig.theme;e.styles!==a.theme.styles&&(e.styles[0]!==a.theme.styles[0]&&f.removeClass(this.domNode,e.styles[0]),f.destroy(this._getThemeCurrentStyleId(e)),this._loadThemeCurrentStyle(a.theme))},_onLayoutChange:function(a){var e={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},e=d.mixin(e,w.getPositionStyle(a.map.position));f.setStyle(this.mapId,e);this.map.resize();g.forEach(this.widgetPlaceholders,
function(e){e.moveTo(a.getConfigElementById(e.configId).panel.position)},this);g.forEach(this.preloadWidgetIcons,function(e){e.moveTo(a.getConfigElementById(e.configId).panel.position)},this);g.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(b){e={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};var h=w.getPositionStyle(a.getConfigElementById(b.id).panel.position);e=d.mixin(e,h);f.setStyle(b.domNode,e);b.onPositionChange(h)},this);g.forEach(this.preloadGroupPanels,
function(b){e={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};e=d.mixin(e,w.getPositionStyle(a.getConfigElementById(b.config.id).panel.position));f.setStyle(b.domNode,e);b.resize()},this)},_loadSplash:function(){if(this.appConfig.splashPage&&"false"!==m("isfirst")){var a={};a.uri=this.appConfig.splashPage;a.id=this.appConfig.splashPage+"_1";a.label="splashPage";a.hasConfig=!1;this.widgetManager.loadWidget(a).then(d.hitch(this,function(a){f.place(a.domNode,this.id);a.startup()}))}},
_loadTheme:function(a){h(["themes/"+a.name+"/main"],d.hitch(this,function(){this._loadThemeCommonStyle(a);this._loadThemeCurrentStyle(a)}))},_loadThemeCommonStyle:function(a){w.loadStyleLink(this._getThemeCommonStyleId(a),"themes/"+a.name+"/common.css");f.addClass(this.domNode,a.name)},_loadThemeCurrentStyle:function(a){w.loadStyleLink(this._getThemeCurrentStyleId(a),"themes/"+a.name+"/styles/"+a.styles[0]+"/style.css");f.addClass(this.domNode,a.styles[0])},_getThemeCommonStyleId:function(a){return"theme_"+
a.name+"_style_common"},_getThemeCurrentStyleId:function(a){return"theme_"+a.name+"_style_"+a.styles[0]},_loadMap:function(){var a=f.create("div",{id:this.mapId,style:d.mixin({position:"absolute",backgroundColor:"#EEEEEE",overflow:"hidden",minWidth:"1px",minHeight:"1px"},w.getPositionStyle(this.appConfig.map.position))});f.place(a,this.id);y.getInstance(this.appConfig,this.mapId).showMap()},_createPreloadWidgetPlaceHolder:function(a){var e;e="map"===a.panel.positionRelativeTo?this.mapId:this.id;var b=
d.clone(a);delete b.position.width;delete b.position.height;var h=w.getPositionStyle(b.position);a=new D({index:b.placeholderIndex,configId:a.id});f.setStyle(a.domNode,h);f.place(a.domNode,e);this.widgetPlaceholders.push(a);return a},_createPreloadWidgetIcon:function(a){var e=new C({panelManager:this.panelManager,widgetConfig:a,configId:a.id});"map"===a.panel.positionRelativeTo?f.place(e.domNode,this.mapId):f.place(e.domNode,this.id);f.setStyle(e.domNode,w.getPositionStyle({top:a.position.top,left:a.position.left,
right:a.position.right,bottom:a.position.bottom}));e.startup();!this.openAtStartWidget&&a.openAtStart&&(e.switchToOpen(),this.openAtStartWidget=a.name);this.preloadWidgetIcons.push(e);return e},_loadPreloadWidgets:function(e){console.time("Load widgetOnScreen");var b=new E,h=[];b.placeAt(this.id);b.startup();g.forEach(e.widgetOnScreen.widgets,function(a){!1===a.visible?this.invisibleWidgetIds.push(a.id):h.push(this._loadPreloadWidget(a))},this);g.forEach(e.widgetOnScreen.groups,function(a){h.push(this._loadPreloadGroup(a))},
this);a(h).then(d.hitch(this,function(){b&&(b.destroy(),b=null);console.timeEnd("Load widgetOnScreen");p.publish("preloadWidgetsLoaded");this._doPostLoad()}),d.hitch(this,function(){b&&(b.destroy(),b=null);console.timeEnd("Load widgetOnScreen");p.publish("preloadWidgetsLoaded");this._doPostLoad()}))},_doPostLoad:function(){h(["dynamic-modules/postload"])},_loadPreloadWidget:function(a){var e=new t;if("config"===this.appConfig.mode&&!a.uri){var b=this._createPreloadWidgetPlaceHolder(a);e.resolve(b);
return e}if(!a.uri)return e.resolve(null),e;a.inPanel?(b=this._createPreloadWidgetIcon(a),e.resolve(b)):this.widgetManager.loadWidget(a).then(d.hitch(this,function(b){"map"===b.panel.positionRelativeTo?f.place(b.domNode,this.mapId):f.place(b.domNode,this.id);f.setStyle(b.domNode,w.getPositionStyle(b.position));f.setStyle(b.domNode,"position","absolute");try{b.startup()}catch(h){console.log(console.error("fail to startup widget "+b.name+". "+h.stack))}b.configId=a.id;e.resolve(b)}),function(a){e.reject(a)});
return e},_loadPreloadGroup:function(a){var e=new t;this.panelManager.showPanel(a).then(d.hitch(this,function(a){this.preloadGroupPanels.push(a);e.resolve(a)}),function(a){e.reject(a)});return e}});v.getInstance=function(a,e){null===x&&(x=new v(a,e));return x};return v})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/aspect dojo/on dojo/json dojo/request/xhr dojo/i18n dojo/promise/all dojo/query dojo/NodeList-traverse dojo/dom-geometry dojo/dom-style esri/request ./utils jimu/tokenUtils ./dijit/Message".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B){var y=null,w=q(null,{constructor:function(){this.loaded=[];this.missedActions=[];p.subscribe("appConfigLoaded",d.hitch(this,this._onAppConfigLoaded));p.subscribe("appConfigChanged",d.hitch(this,this._onAppConfigChanged));p.subscribe("mapLoaded",d.hitch(this,this._onMapLoaded));p.subscribe("mapChanged",d.hitch(this,this._onMapChanged));p.subscribe("userSignIn",d.hitch(this,this._onUserSignIn));p.subscribe("userSignOut",d.hitch(this,this._onUserSignOut));
p.subscribe("actionTriggered",d.hitch(this,this._onActionTriggered))},loadWidget:function(a){var e=new k,b;a=d.clone(a);a.folderUrl||z.processWidgetSetting(a);(b=this.getWidgetById(a.id))?e.resolve(b):m([this.loadWidgetClass(a)]).then(d.hitch(this,function(b){var h=b[0];this.loadWidgetResources(a).then(d.hitch(this,function(b){try{var n=this.createWidget(a,h,b);console.log("widget ["+a.uri+"] created.")}catch(m){console.log("create ["+a.uri+"] error:"+m.stack),new B({message:"create widget error: "+
a.uri}),e.reject(m)}setTimeout(function(){e.resolve(n)},50)}),function(a){e.reject(a)})}),function(a){e.reject(a)});return e},loadWidgetClass:function(a){var e=new k;require(z.getRequireConfig(),[a.uri],d.hitch(this,function(a){e.resolve(a)}));z.checkError(a.uri,e);return e},loadWidgetResources:function(a){var e=new k,b,h,n,c=[];n=d.clone(a);a=this.tryLoadWidgetConfig(n);b=this._tryLoadResource(n,"i18n");h=this._tryLoadResource(n,"style");n=this._tryLoadResource(n,"template");c.push(a);c.push(b);
c.push(n);c.push(h);m(c).then(d.hitch(this,function(a){var b={};b.config=a[0];b.i18n=a[1];b.template=a[2];b.style=a[3];e.resolve(b)}),function(a){e.reject(a)});return e},createWidget:function(a,e,b){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);b.config&&b.i18n&&(b.config=z.replacePlaceHolder(b.config,b.i18n));a.rawConfig=a.config;a.config=b.config||{};this.appConfig.agolConfig&&this._mergeAgolConfig(a);a.nls=b.i18n||{};b.template&&(a.templateString=b.template);a["class"]="jimu-widget";
a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;b={};for(var h in a)a.hasOwnProperty(h)&&(b[h]=a[h]);a=new e(b);a.clazz=e;c.after(a,"startup",d.hitch(this,this._postWidgetStartup,a));c.before(a,"destroy",d.hitch(this,this._onDestroyWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=g.map(this.loaded,function(a){return a.id});g.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var e=
new k;a=d.clone(a);a.id+="_setting";m([this.loadWidgetSettingClass(a)]).then(d.hitch(this,function(b){var h=b[0];this.loadWidgetSettingPageResources(a).then(d.hitch(this,function(b){var n;b={nls:b.i18n,templateString:b.template,appConfig:this.appConfig,map:this.map,"class":"jimu-widget-setting"};for(var m in a)a.hasOwnProperty(m)&&(b[m]=a[m]);try{n=new h(b),c.before(n,"destroy",d.hitch(this,this._onDestroyWidgetSetting,n)),e.resolve(n)}catch(l){new B({message:"Create widget setting page error:"+a.uri}),
e.reject(l)}}),function(a){console.log(a)})}),function(a){e.reject(a)});return e},loadWidgetSettingClass:function(a){var e=new k;require(z.getRequireConfig(),[a.folderUrl+"setting/Setting.js"],d.hitch(this,function(a){e.resolve(a)}));z.checkError(a.folderUrl+"setting/Setting.js",e);return e},loadWidgetSettingPageResources:function(a){var e=new k,b,h,n=[];a=d.clone(a);b=this._tryLoadResource(a,"settingI18n");h=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");n.push(b);
n.push(h);n.push(a);m(n).then(d.hitch(this,function(a){var b={};b.i18n=a[0]||{};b.template=a[1];b.style=a[2];e.resolve(b)}),function(a){console.log(a)});return e},getWidgetById:function(a){var e;g.some(this.loaded,function(b){if(b.id===a)return e=b,!0},this);return e},changeWindowStateTo:function(a,e){"normal"===e?this.normalizeWidget(a):"minimized"===e?this.minimizeWidget(a):"maximized"===e?this.maximizeWidget(a):console.log("error state: "+e)},closeWidget:function(a){if("string"===typeof a&&(a=
this.getWidgetById(a),!a))return;if("closed"!==a.state){a.setState("closed");try{a.onClose()}catch(e){console.log(console.error("fail to close widget "+a.name+". "+e.stack))}}},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"===a.state){a.setState("opened");try{a.onOpen()}catch(e){console.log(console.error("fail to open widget "+a.name+". "+e.stack))}}},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&
this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(e){console.log(console.error("fail to maximize widget "+a.name+". "+e.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(e){console.log(console.error("fail to minimize widget "+a.name+". "+e.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;
"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(e){console.log(console.error("fail to normalize widget "+a.name+". "+e.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(e){console.log(console.error("fail to destroy widget "+a.name+". "+e.stack))}},tryLoadWidgetConfig:function(a){var e=new k;return a.config&&d.isObject(a.config)?(e.resolve(a.config),e):a.config?require.cache["url:"+
a.config]?(e.resolve(l.parse(require.cache["url:"+a.config])),e):b(a.config,{handleAs:"json"}):this._tryLoadResource(a,"config")},loadWidgetStyle:function(a){var e="widget/style/"+a.uri,b=new k,e=this._replaceId(e);return f.byId(e)?(b.resolve("load"),b):z.loadStyleLink(e,a.styleFile,null)},loadWidgetSettingStyle:function(a){var e="widget/style/"+a.uri+"/setting",b=new k,e=this._replaceId(e);return f.byId(e)?(b.resolve("load"),b):z.loadStyleLink(e,a.settingStyleFile)},loadWidgetConfig:function(a){a=
require(z.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var e=new k;e.resolve(l.parse(require.cache["url:"+a]));return e}return b(a,{handleAs:"json"})},loadWidgetI18n:function(a){var e=new k;require(z.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){e.resolve(a)});return e},loadWidgetSettingI18n:function(a){var e=new k;require(z.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){e.resolve(a)});return e},loadWidgetTemplate:function(a){var e=new k;require(z.getRequireConfig(),
["dojo/text!"+a.templateFile],function(a){e.resolve(a)});z.checkError(a.templateFile,e);return e},loadWidgetSettingTemplate:function(a){var e=new k;require(z.getRequireConfig(),["dojo/text!"+a.settingTemplateFile],function(a){e.resolve(a)});z.checkError(a.settingTemplateFile,e);return e},removeWidgetStyle:function(a){f.destroy(this._replaceId("widget/style/"+a.uri))},removeWidgetSettingStyle:function(a){f.destroy(this._replaceId("widget/style/"+a.uri+"/setting"))},getControllerWidgets:function(){return g.filter(this.loaded,
function(a){return a.isController})},getPreloadPanelessWidgets:function(){return g.filter(this.loaded,function(a){return a.isPreload&&!a.inPanel})},_mergeAgolConfig:function(a){function e(b,h){for(var n in b)n.startWith(h)&&z.setConfigByTemplate(a.config,n.substr(h.length,n.length),b[n])}var b,h;if(this.appConfig.widgetOnScreen){if(this.appConfig.widgetOnScreen.groups)for(b=0;b<this.appConfig.widgetOnScreen.groups.length;b++)for(h=0;h<this.appConfig.widgetOnScreen.groups[b].widgets.length;h++)if(this.appConfig.widgetOnScreen.groups[b].widgets[h].label===
a.label){e(this.appConfig.agolConfig.values,"app_preloadWidgets_groups["+b+"]_widgets["+h+"]_");return}if(this.appConfig.widgetOnScreen.widgets)for(b=0;b<this.appConfig.widgetOnScreen.widgets.length;b++)if(this.appConfig.widgetOnScreen.widgets[b].label===a.label){e(this.appConfig.agolConfig.values,"app_preloadWidgets_widgets["+b+"]_");return}}if(this.appConfig.widgetPool){if(this.appConfig.widgetPool.groups)for(b=0;b<this.appConfig.widgetPool.groups.length;b++)for(h=0;h<this.appConfig.widgetPool.groups[b].widgets.length;h++)if(this.appConfig.widgetPool.groups[b].widgets[h].label===
a.label){e(this.appConfig.agolConfig.values,"app_widgetPool_groups["+b+"]_widgets["+h+"]_");return}if(this.appConfig.widgetPool.widgets)for(b=0;b<this.appConfig.widgetPool.widgets.length;b++)if(this.appConfig.widgetPool.widgets[b].label===a.label){e(this.appConfig.agolConfig.values,"app_widgetPool_widgets["+b+"]_");break}}},_onUserSignIn:function(a){g.forEach(this.loaded,function(e){e.onSignIn(a)},this)},_onUserSignOut:function(){g.forEach(this.loaded,function(a){a.onSignOut()},this)},_onAppConfigLoaded:function(a){this.appConfig=
a=d.clone(a);A.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onAppConfigChanged:function(a,e,b,h){var n=d.clone(a);this.appConfig=n;g.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(n,e,b,h),"widgetChange"===e&&this._onConfigChanged(b.id,b.config,h),a.appConfig=n)},this)},_onConfigChanged:function(a,e){var b=this.getWidgetById(a);b&&(b.onConfigChanged(e),d.mixin(b.config,e))},_onActionTriggered:function(a,e,b){if(!("map"===a||"app"===
a)){var h=this.getWidgetById(a);if(h)h.onAction(e,b);else this.missedActions.push({id:a,action:{name:e,data:b}});g.forEach(this.getControllerWidgets(),function(h){if(h.widgetIsControlled(a))h.onAction(e,{widgetId:a,data:b})},this)}},_postWidgetStartup:function(a){a.started=!0;z.setVerticalCenter(a.domNode);c.after(a,"resize",d.hitch(this,z.setVerticalCenter,a.domNode));this.openWidget(a);var e=A.getPortalCredential(this.appConfig.portalUrl);if(e)a.onSignIn(e);else a.onSignOut();this._triggerMissedAction(a)},
_triggerMissedAction:function(a){this.missedActions.forEach(function(e){if(e.id===a.id)a.onAction(e.action.name,e.action.data)})},_remove:function(a){return g.some(this.loaded,function(e,b){if(e.id===a)return this.loaded.splice(b,1),!0},this)},_tryLoadResource:function(a,e){var b,h,n=new k,m=function(){var b;if("config"===e)b=this.loadWidgetConfig(a);else if("style"===e)b=this.loadWidgetStyle(a);else if("i18n"===e)b=this.loadWidgetI18n(a);else if("template"===e)b=this.loadWidgetTemplate(a);else if("settingTemplate"===
e)b=this.loadWidgetSettingTemplate(a);else if("settingStyle"===e)b=this.loadWidgetSettingStyle(a);else if("settingI18n"===e)b=this.loadWidgetSettingI18n(a);else return n;b.then(function(a){n.resolve(a)},function(e){new B({message:"load widget resouce error: "+a.uri});n.reject(e)})};if("config"===e)b=a.amdFolder+"config.json",a.configFile=b,h="hasConfig";else if("style"===e)b=a.amdFolder+"css/style.css",a.styleFile=b,h="hasStyle";else if("i18n"===e)b=a.amdFolder+"nls/strings.js",a.i18nFile=a.amdFolder+
"nls/strings",h="hasLocale";else if("template"===e)b=a.amdFolder+"Widget.html",a.templateFile=b,h="hasUIFile";else if("settingTemplate"===e)b=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=b,h="hasSettingUIFile";else if("settingI18n"===e)b=a.amdFolder+"setting/nls/strings.js",a.settingI18nFile=a.amdFolder+"setting/nls/strings",h="hasSettingLocale";else if("settingStyle"===e)b=a.amdFolder+"setting/css/style.css",a.settingStyleFile=b,h="hasSettingStyle";else return n;!1===a[h]?n.resolve(null):
!0===a[h]?m.apply(this):z.checkFileExist(b).then(d.hitch(this,function(a){a?m.apply(this):n.resolve(null)}));return n},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);this._removeWidget(a);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.removeWidgetStyle(a);
this._remove(a.id)}});w.getInstance=function(a){null===y&&(y=new w(a));return y};return w})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/query dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(q,d,g,f,k,p,c){return q(c,{baseClass:"jimu-popup jimu-message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=g.create("div",
{"class":"title"},this.domNode),this.titleLabeNode=g.create("span",{"class":"title-label",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=g.create("div",{"class":"close-btn"},this.titleNode),this.own(p(this.closeBtnNode,"click",d.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:"OK",key:k.ENTER,onClick:d.hitch(this,this.close)})},_increaseZIndex:function(){g.setStyle(this.domNode,"zIndex",9999);g.setStyle(this.overlayNode,
"zIndex",9998)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/keys dojo/query dojo/aspect dojo/NodeList-dom dojo/dnd/move dijit/_WidgetBase".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m){var t=0;return q(m,{"class":"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=
[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this.domNode.tabIndex=1;this._initDomNode();this._positioning();f.place(this.domNode,this.container);this._moveToMiddle();this.own(p(window,"resize",d.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),this._moveToMiddle()):this._positioning()})));this.overlayNode=f.create("div",{"class":"popup-overlay"},
this.container);this._increaseZIndex();k.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=f.create("div",{"class":"title"},this.domNode);this.titleLabeNode=f.create("span",{"class":"title-label",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=
f.create("div",{"class":"close-btn"},this.titleNode);this.own(p(this.closeBtnNode,"click",d.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=f.create("div",{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&f.place(this.content,this.contentContainerNode));
this.buttonContainer=f.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&f.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),this.buttons[a].disable&&this.disableButton(a)},_moveableNode:function(a,e){this.moveable&&(this.moveable.destroy(),this.moveable=null);var b=f.getMarginBox(this.container);b.l=b.l-a+e;b.w+=2*(a-e);this.moveable=new r.boxConstrainedMoveable(this.domNode,{box:b,handle:this.titleNode,
within:!0});this.own(p(this.moveable,"Moving",d.hitch(this,this.onMoving)));this.own(p(this.moveable,"MoveStop",d.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===s("#header").length?{t:0,l:0,w:0,h:0}:f.getMarginBox("header")},_getFooterBox:function(){return 0===s(".footer",this.container).length?{t:0,l:0,w:0,h:0}:f.getMarginBox(s(".footer",this.container)[0])},_calculatePosition:function(){var a=f.getContentBox(this.container),e=this._getHeaderBox(),b=this._getFooterBox(),b=a.h-
e.h-b.h-40,h=0;h=this._fixedHeight?this.height:this.autoHeight?b-200:this.height=b>this.maxHeight?this.maxHeight:b;b=(b-h)/2+e.h+20;b=b<e.h?e.h:b;this.width=this.width||this.maxWidth;f.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:b+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?(f.setStyle(this.domNode,"height","auto"),f.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&f.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(f.setStyle(this.domNode,
"height",this.height+"px"),f.addClass(this.contentContainerNode,"content-absolute"),f.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&f.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=f.getMarginBox(this.domNode),e=f.getContentBox(this.container),b=this._getHeaderBox(),h=this._getFooterBox(),h=e.h-b.h-h.h-40,m=0,m=a.h||h-200,a=(h-m)/2+b.h+20,a=a<b.h?b.h:a;f.setStyle(this.domNode,
{left:(e.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){f.setStyle(this.domNode,"zIndex",t+501);f.setStyle(this.overlayNode,"zIndex",t+500);t++},onMoving:function(a){f.setStyle(a.node,"opacity",0.9)},onMoveStop:function(a){f.setStyle(a.node,"opacity",1)},close:function(){if(!(this.onClose&&!1===this.onClose())){var a=this.domNode.parentNode,e=d.clone(this.domNode);f.setStyle(this.domNode,
"display","none");f.destroy(this.overlayNode);this.destroy();this.moveable.destroy();f.place(e,a);k.animateProperty({node:e,properties:{opacity:0},duration:200,onEnd:function(){f.destroy(e)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var e=f.create("div",{"class":"jimu-popup-btn",innerHTML:a.label},this.buttonContainer);this.enabledButtons.unshift(e);var b=f.create("div",{"class":"jimu-popup-btn jimu-state-disabled",innerHTML:a.label,style:{display:"none"}},
this.buttonContainer);this.disabledButtons.unshift(b);this.own(p(e,"click",d.hitch(this,function(e){if(a.onClick)a.onClick(e);else this.close()})))},enableButton:function(a){"number"===typeof a?(f.setStyle(this.enabledButtons[a],"display","inline-block"),f.setStyle(this.disabledButtons[a],"display","none")):(g.forEach(this.enabledButtons[a],d.hitch(this,function(a){f.setStyle(a,"display","inline-block")})),g.forEach(this.disabledButtons[a],d.hitch(this,function(a){f.setStyle(a,"display","none")})))},
disableButton:function(a){"number"===typeof a?(f.setStyle(this.disabledButtons[a],"display","inline-block"),f.setStyle(this.enabledButtons[a],"display","none")):(g.forEach(this.disabledButtons,d.hitch(this,function(a){f.setStyle(a,"display","inline-block")})),g.forEach(this.enabledButtons,d.hitch(this,function(a){f.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(q,d,g,f,k,p){f=
q("dojo.dnd.move.constrainedMoveable",p,{constraints:function(){},within:!1,constructor:function(c,d){d||(d={});this.constraints=d.constraints;this.within=d.within},onFirstMove:function(c){var s=this.constraintBox=this.constraints.call(this,c);s.r=s.l+s.w;s.b=s.t+s.h;this.within&&(c=d.getMarginSize(c.node),s.r-=c.w,s.b-=c.h)},onMove:function(c,d){var l=this.constraintBox,b=c.node.style;this.onMoving(c,d);d.l=d.l<l.l?l.l:l.r<d.l?l.r:d.l;d.t=d.t<l.t?l.t:l.b<d.t?l.b:d.t;b.left=d.l+"px";b.top=d.t+"px";
this.onMoved(c,d)}});k=q("dojo.dnd.move.boxConstrainedMoveable",f,{box:{},constructor:function(c,d){var l=d&&d.box;this.constraints=function(){return l}}});q=q("dojo.dnd.move.parentConstrainedMoveable",f,{area:"content",constructor:function(c,s){var l=s&&s.area;this.constraints=function(){var b=this.node.parentNode,c=g.getComputedStyle(b),m=d.getMarginBox(b,c);if("margin"==l)return m;var s=d.getMarginExtents(b,c);m.l+=s.l;m.t+=s.t;m.w-=s.w;m.h-=s.h;if("border"==l)return m;s=d.getBorderExtents(b,c);
m.l+=s.l;m.t+=s.t;m.w-=s.w;m.h-=s.h;if("padding"==l)return m;s=d.getPadExtents(b,c);m.l+=s.l;m.t+=s.t;m.w-=s.w;m.h-=s.h;return m}}});return{constrainedMoveable:f,boxConstrainedMoveable:k,parentConstrainedMoveable:q}})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/on dojo/aspect require ./utils ./WidgetManager".split(" "),function(q,d,g,f,k,p,c,s,l,b,r){var m,t=null;m=q(null,{constructor:function(){this.panels=
[];this.widgetManager=r.getInstance();c(window,"resize",d.hitch(this,this.onWindowResize))},showPanel:function(a){var e=a.id+"_panel",n=this.getPanelById(e),h=new p;n?("closed"===n.state&&this.openPanel(n,a.panel.position),h.resolve(n)):l([a.panel.uri],d.hitch(this,function(n){var m;m="map"===a.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;var c={widgetIcon:a.panel.widgetIcon,label:a.label,config:a,uri:a.panel.uri,position:a.panel.position,positionRelativeTo:a.panel.positionRelativeTo,
map:this.map,widgetManager:this.widgetManager,panelManager:this,containerId:m,id:e,gid:a.gid};d.mixin(c,a.panel.options);var l;try{l=new n(c),console.log("panel ["+e+"] created.")}catch(r){console.log("create panel error: "+r+", panelId: "+e),h.reject(r)}f.setStyle(l.domNode,"opacity",0);f.setStyle(l.domNode,b.getPositionStyle(a.panel.position));s.before(l,"destroy",d.hitch(this,this.onDestroyPanel,l));f.place(l.domNode,m);try{l.startup()}catch(k){console.log(console.error("fail to startup panel "+
l.id+". "+k.stack))}this.openPanel(l);b.setVerticalCenter(l.domNode);this.panels.push(l);h.resolve(l)}));return h},closeOtherPanelsInTheSameGroup:function(a){for(var e=0;e<this.panels.length;e++)this.panels[e].gid===a.gid&&this.panels[e].id!==a.id&&this.closePanel(this.panels[e],!1)},openPanel:function(a,e){var n=new p;if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if("opened"===a.state)n.resolve();else{try{this.closeOtherPanelsInTheSameGroup(a),f.setStyle(a.domNode,"display","block"),
f.setStyle(a.domNode,b.getPositionStyle(e)),k.animateProperty({node:a.domNode,properties:{opacity:1},duration:200,onEnd:d.hitch(this,function(){a.setState("opened");a.onOpen();n.resolve()})}).play()}catch(h){console.log(console.error("fail to open panel "+a.id+". "+h.stack))}return n}},closePanel:function(a,e){var b=new p;if("string"===typeof a&&(a=this.getPanelById(a),!a))return b.resolve(),b;void 0===e&&(e=!0);if("closed"===a.state)return b.resolve(),b;try{e?k.animateProperty({node:a.domNode,properties:{opacity:0},
duration:200,onEnd:function(){a.setState("closed");a.onClose();f.setStyle(a.domNode,"display","none");b.resolve()}}).play():(a.setState("closed"),a.onClose(),f.setStyle(a.domNode,"display","none"),b.resolve())}catch(h){console.log(console.error("fail to close panel "+a.id+". "+h.stack))}return b},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(e){console.log(console.error("fail to minimize panel "+
a.id+". "+e.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(e){console.log(console.error("fail to maximize panel "+a.id+". "+e.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(e){console.log(console.error("fail to noralize panel "+
a.id+". "+e.stack))}},changeWindowStateTo:function(a,e){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===e?this.normalizePanel(a):"minimized"===e?this.minimizePanel(a):"maximized"===e?this.maximizePanel(a):console.log("error state: "+e)},getPanelById:function(a){for(var e=0;e<this.panels.length;e++)if(this.panels[e].id===a)return this.panels[e]},onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&this.panels[a].resize()},destroyPanel:function(a){if("string"===
typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);try{a.destroy()}catch(e){console.log(console.error("fail to destroy panel "+a.id+". "+e.stack))}}},onDestroyPanel:function(a){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);console.log("destroy panel "+a.id)},destroyAllPanels:function(){var a=g.map(this.panels,function(a){return a.id});g.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},reloadWidgetInPanel:function(a){this.panels.forEach(function(e){e.reloadWidget(a)},
this)},_removePanel:function(a){a=this.panels.indexOf(a);-1<a&&this.panels.splice(a,1)}});m.getInstance=function(){null===t&&(t=new m);return t};return m})},"jimu/MapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/on dojo/aspect dojo/keys esri/arcgis/utils esri/dijit/InfoWindow esri/dijit/PopupMobile esri/InfoTemplate esri/request esri/SpatialReference esri/geometry/Extent require jimu/portalUrlUtils ./utils ./dijit/LoadingShelter".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A){var B=null,y=q(null,{appConfig:null,mapDivId:"",map:null,previousInfoWindow:null,mobileInfoWindow:null,isMobileInfoWindow:!1,constructor:function(a,e){this.appConfig=a;this.id=this.mapDivId=e;k.subscribe("appConfigChanged",d.hitch(this,this.onAppConfigChanged));k.subscribe("changeMapPosition",d.hitch(this,this.onChangeMapPosition));p(window,"resize",d.hitch(this,this.onWindowResize))},showMap:function(){this._showMap(this.appConfig)},_showMap:function(a){console.time("Load Map");
this.loading=new A;this.loading.placeAt(this.mapDivId);this.loading.startup();a.map["3D"]?a.map.itemId?this._show3DWebScene(a):this._show3DLayersMap(a):a.map.itemId?this._show2DWebMap(a):this._show2DLayersMap(a)},onWindowResize:function(){this.map&&this.map.resize&&(this.map.resize(),this.resetInfoWindow())},resetInfoWindow:function(){!this.previousInfoWindow&&(this.map&&this.map.infoWindow)&&(this.previousInfoWindow=this.map.infoWindow);!this.mobileInfoWindow&&(this.map&&this.map.root)&&(this.mobileInfoWindow=
new r(null,f.create("div",null,null,this.map.root)));if(jimuConfig&&jimuConfig.widthBreaks&&this.previousInfoWindow&&this.mobileInfoWindow){var a=jimuConfig.widthBreaks[0];document.body.clientWidth<a&&!this.isMobileInfoWindow?(this.map.infoWindow.hide(),this.map.setInfoWindow(this.mobileInfoWindow),this.isMobileInfoWindow=!0):this.map.width>=a&&this.isMobileInfoWindow&&(this.map.infoWindow.hide(),this.map.setInfoWindow(this.previousInfoWindow),this.isMobileInfoWindow=!1)}},onChangeMapPosition:function(a){var e=
d.clone(this.appConfig.map.position);a=d.mixin(e,a);f.setStyle(this.mapDivId,z.getPositionStyle(a));this.map&&this.map.resize&&this.map.resize()},_visitConfigMapLayers:function(a,e){g.forEach(a.map.basemaps,function(a,b){a.isOperationalLayer=!1;e(a,b)},this);g.forEach(a.map.operationallayers,function(a,b){a.isOperationalLayer=!0;e(a,b)},this)},_show3DLayersMap:function(a){n(["esri3d/Map"],d.hitch(this,function(e){var b;b=new e(this.mapDivId,{camera:a.map.mapOptions.camera});this._visitConfigMapLayers(a,
d.hitch(this,function(a){this.createLayer(b,"3D",a)}));b.usePlugin=e.usePlugin;this._publishMapEvent(b)}))},_show3DWebScene:function(a){this._getWebsceneData(a.map.itemId).then(d.hitch(this,function(e){n(["esri3d/Map"],d.hitch(this,function(b){var h=new b(this.mapDivId,a.map.mapOptions);g.forEach(e.itemData.operationalLayers,function(a){this.createLayer(h,"3D",a)},this);g.forEach(e.itemData.baseMap.baseMapLayers,function(a){a.type="tile";this.createLayer(h,"3D",a)},this);g.forEach(e.itemData.baseMap.elevationLayers,
function(a){a.type="elevation";this.createLayer(h,"3D",a)},this);h.toc=e.itemData.toc;h.bookmarks=e.itemData.bookmarks;h.tours=e.itemData.tours}))}))},_publishMapEvent:function(a){window._viewerMap=a;this.loading&&this.loading.destroy();console.timeEnd("Load Map");this.map?(this.map=a,console.log("map changed."),k.publish("mapChanged",this.map)):(this.map=a,k.publish("mapLoaded",this.map));this.resetInfoWindow()},_getWebsceneData:function(a){return t({url:"http://184.169.133.166/sharing/rest/content/items/"+
a+"/data",handleAs:"json"})},_show2DWebMap:function(b){var h=this._processMapOptions(b.map.mapOptions);if((!b.map.mapOptions||!b.map.mapOptions.extent)&&"6e03e8c26aad4b9c92a87c1063ddb0e3"===b.map.itemId)h||(h={}),h.extent=new e(-1.4480448059223117E7,2605852.2271675873,-6653296.362823148,6514536.1055573225,new a(102100));z.createWebMap(b.map.portalUrl,b.map.itemId,this.mapDivId,{mapOptions:h,bingMapsKey:b.bingMapsKey}).then(d.hitch(this,function(a){var e=a.map;e.itemId=b.map.itemId;e.itemInfo=a.itemInfo;
e.webMapResponse=a;e.enableSnapping({snapKey:s.copyKey});this._publishMapEvent(e)}),d.hitch(this,function(){this.loading&&this.loading.destroy();k.publish("mapCreatedFailed")}))},_show2DLayersMap:function(a){n(["esri/map"],d.hitch(this,function(e){var b=new e(this.mapDivId,this._processMapOptions(a.map.mapOptions));b.enableSnapping({snapKey:s.copyKey});this._visitConfigMapLayers(a,d.hitch(this,function(a){this.createLayer(b,"2D",a)}));this._publishMapEvent(b)}))},_processMapOptions:function(a){if(a)return a=
d.clone(a),a.extent&&(a.extent=new e(a.extent)),a.infoWindow&&(a.infoWindow=new b(a.infoWindow,f.create("div",{},this.mapDivId))),a},createLayer:function(a,e,b){n([{"2D_tiled":"esri/layers/ArcGISTiledMapServiceLayer","2D_dynamic":"esri/layers/ArcGISDynamicMapServiceLayer","2D_image":"esri/layers/ArcGISImageServiceLayer","2D_feature":"esri/layers/FeatureLayer","2D_rss":"esri/layers/GeoRSSLayer","2D_kml":"esri/layers/KMLLayer","2D_webTiled":"esri/layers/WebTiledLayer","2D_wms":"esri/layers/WMSLayer",
"2D_wmts":"esri/layers/WMTSLayer","3D_tiled":"esri3d/layers/ArcGISTiledMapServiceLayer","3D_dynamic":"esri3d/layers/ArcGISDynamicMapServiceLayer","3D_image":"esri3d/layers/ArcGISImageServiceLayer","3D_feature":"esri3d/layers/FeatureLayer","3D_elevation":"esri3d/layers/ArcGISElevationServiceLayer","3D_3dmodle":"esri3d/layers/SceneLayer"}[e+"_"+b.type]],d.hitch(this,function(e){var h,n={};h="label url type icon infoTemplate isOperationalLayer".split(" ");for(var l in b)0>h.indexOf(l)&&(n[l]=b[l]);b.infoTemplate?
(h=new m(b.infoTemplate.title,b.infoTemplate.content),n.infoTemplate=h,e=new e(b.url,n),b.infoTemplate.width&&b.infoTemplate.height&&c.after(e,"onClick",d.hitch(this,function(){a.infoWindow.resize(b.infoTemplate.width,b.infoTemplate.height)}),!0)):e=new e(b.url,n);e.isOperationalLayer=b.isOperationalLayer;e.label=b.label;e.icon=b.icon;a.addLayer(e)}))},onAppConfigChanged:function(a,e,b,h){"mapChange"===e&&!(h&&!1===h.reCreateMap)&&(this.map&&(k.publish("beforeMapDestory",this.map),this.map.destroy()),
this._showMap(a));this.appConfig=a}});y.getInstance=function(a,e){null===B&&(B=new y(a,e));return B};return y})},"esri/dijit/InfoWindow":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "),function(q,d,g,f,k,p,c,
s,l,b,r,m,t,a,e,n,h,z,A){var B=q([z,m,t,a,h],{declaredClass:"esri.dijit.InfoWindow",isContainer:!0,templateString:A,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:!0,isContentShowing:!0,isTitleBarShowing:!0,width:250,height:150,title:"Info Window",setMap:function(a){this.inherited(arguments);b.place(this.domNode,a.root)},startup:function(){if(!this._started){this.inherited(arguments);this._ANCHORS=[B.ANCHOR_UPPERRIGHT,B.ANCHOR_LOWERRIGHT,B.ANCHOR_LOWERLEFT,B.ANCHOR_UPPERLEFT];if(7>p("ie")){var a=
"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+r.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,"")+"')",e=b.create("div",null,f.body());r.set(e,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:a});var h=setTimeout(function(){b.destroy(e);clearTimeout(h);h=e=null},100);k.query(".sprite",this.domNode).forEach(function(e){e.style.backgroundImage="none";e.style.filter=a})}this.resize(this.width,
this.height);this.hide()}},destroy:function(){this._destroyed||(this.__unregisterMapListeners(),this.destroyDijits(this._title),this.destroyDijits(this._content),this._title.innerHTML=this._content.innerHTML="",this.inherited(arguments))},resize:function(a,e){if(a&&e){var b=r.set;b(this._topleft,{height:e+"px",marginLeft:a+"px"});b(this._topright,{width:a+"px",height:e+"px"});b(this._user,"width",a-8+"px");b(this._hide,"marginLeft",a-22+"px");b(this._title,"width",a-25+"px");b(this._content,"height",
e-37+"px");b(this._bottomleft,{marginLeft:a+"px",marginTop:e+"px"});b(this._bottomright,{width:a-5+"px",marginTop:e+"px"});this.width=a;this.height=e;this.coords&&this._adjustPosition(this.coords,this.anchor);this.onResize(a,e)}},_adjustPosition:function(a,e){var b=r.set;b(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+"px"});e===B.ANCHOR_UPPERLEFT?b(this._window,{left:null,right:this.width+18+"px",top:null,bottom:this.height+50+"px"}):e===B.ANCHOR_UPPERRIGHT?b(this._window,{left:"6px",
right:null,top:null,bottom:this.height+50+"px"}):e===B.ANCHOR_LOWERRIGHT?b(this._window,{left:"6px",right:null,top:"43px",bottom:null}):e===B.ANCHOR_LOWERLEFT&&b(this._window,{left:null,right:this.width+18+"px",top:"43px",bottom:null})},_getAnchor:function(a){var e=this.map;return e&&a?(a.y<e.height/2?"lower":"upper")+(a.x<e.width/2?"right":"left"):"upperright"},show:function(a,e,b){if(a){a.spatialReference?(this.mapCoords=a,a=this.coords=this.map.toScreen(a,!0)):(this.mapCoords=null,this.coords=
a);var h=this.map._getFrameWidth();if(-1!==h&&(a.x%=h,0>a.x&&(a.x+=h),this.map.width>h))for(var m=(this.map.width-h)/2;a.x<m;)a.x+=h;if(!e||-1===g.indexOf(this._ANCHORS,e))e=this._getAnchor(a);l.remove(this._pointer,this.anchor);e=this.anchor=this.fixedAnchor||e;this._adjustPosition(a,e);l.add(this._pointer,e);n.show(this.domNode);this.isShowing=!0;if(!b)this.onShow()}},hide:function(a,e){n.hide(this.domNode);this.isShowing=!1;if(!e)this.onHide()},showTitleBar:function(){n.show(this._titlebar);n.show(this._border);
this.isTitleBarShowing=!0},hideTitleBar:function(){n.hide(this._titlebar);n.hide(this._border);this.isTitleBarShowing=!1},showContent:function(){n.show(this._content);n.show(this._border);this.isContentShowing=!0},hideContent:function(){n.hide(this._content);n.hide(this._border);this.isContentShowing=!1},move:function(a,e){e?a=this.coords.offset(a.x,a.y):(this.coords=a,this.mapCoords&&(this.mapCoords=this.map.toMap(a)));r.set(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+"px"})},
setFixedAnchor:function(a){a&&-1===g.indexOf(this._ANCHORS,a)||(this.fixedAnchor=a,this.isShowing&&this.show(this.mapCoords||this.coords,a),this.onAnchorChange(a))},setTitle:function(a){this.destroyDijits(this._title);this.__setValue("_title",a);return this},setContent:function(a){this.destroyDijits(this._content);this.__setValue("_content",a);return this},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content)},onHide:function(){this.__unregisterMapListeners()},
onResize:function(){},onAnchorChange:function(){}});d.mixin(B,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});return B})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w){return d([n,h],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:q.toUrl("./images/whitex.png"),dArrowIcon:q.toUrl("./images/whitedown.png"),lArrowIcon:q.toUrl("./images/whitel.png"),rArrowIcon:q.toUrl("./images/whiter.png"),constructor:function(a,e){this.initialize();g.mixin(this,a);this.domNode=b.byId(e);this._nls=g.mixin({},
w.widgets.popup);var h=this.domNode;m.add(h,"esriPopupMobile");r.set(h,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
var n=c.query(".titlePane",h)[0];this._arrowButton=c.query(".arrow",n)[0];this._pointerTop=c.query(".top",h)[0];this._pointerBottom=c.query(".bottom",h)[0];this._title=c.query(".title",n)[0];this._footer=c.query(".footer",n)[0];this._prev=c.query(".prev",n)[0];this._next=c.query(".next",n)[0];this._spinner=c.query(".spinner",n)[0];this._eventConnections=[f.connect(c.query(".close",n)[0],"onclick",this,this.hide),f.connect(this._arrowButton,"onclick",this,this._toggleView),f.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),f.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();y.hide(h);this.isShowing=!1},setMap:function(a){this.inherited(arguments);t.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a,e){this.destroyDijits(this._title);this.place(a,this._title);
this.destroyDijits(this._footer);this.place(e,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(a){this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.startupDijits(this._contentPane)},show:function(a){if(a){var e=this.map;a.spatialReference?(this.location=a,a=e.toScreen(a)):this.location=e.toMap(a);this._maximized?this.restore():this._setPosition(a);this.isShowing||(y.show(this.domNode),this.isShowing=!0,this.onShow())}else y.show(this.domNode),
this.isShowing=!0},hide:function(){this.isShowing&&(y.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);k.forEach(this._eventConnections,f.disconnect);t.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+
1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");m.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var a=this.selectedIndex;this._updateUI();0<=a&&(this.setContent(this.features[a].getContent()),this.updateHighlight(this.map,this.features[a]),this.isShowing&&this.showHighlight())},
onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[f.connect(a,"onPanStart",this,this._onPanStart),f.connect(a,"onPan",this,this._onPan),f.connect(a,"onZoomStart",this,this._onZoomStart),f.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(k.forEach(a,f.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,
bottom:a.bottom}},_onPan:function(a,b){var h=this._panOrigin,n=b.x,m=b.y,c=h.left,l=h.top,r=h.right,h=h.bottom;c&&(c=parseFloat(c)+n+"px");l&&(l=parseFloat(l)+m+"px");r&&(r=parseFloat(r)-n+"px");h&&(h=parseFloat(h)-m+"px");e.set(this.domNode,{left:c,top:l,right:r,bottom:h})},_onZoomStart:function(){y.hide(this.domNode)},_onExtentChange:function(a,e,b){b&&(y.show(this.domNode),this.show(this._targetLocation||this.location),this._targetLocation=null)},_setPosition:function(b){var h=b.x;b=b.y;var n=
a.getContentBox(this.map.container),c=n.w,n=n.h,l=0,r=b+10,d=118,s=c-18;18<h&&h<s?(l=h-130,0>l?l=0:l>c-260&&(l=c-260)):18>=h?l=h-18:h>=s&&(l=c-260+(h-s));118<h&&h<c-130?d=118:118>=h?18<h?d=h-12:18>=h&&(d=6):h>=c-130&&(h<s?d=118+h-(c-130):h>=s&&(d=118+s-(c-130)));b<=n/2?(e.set(this.domNode,{left:l+"px",top:r+"px",bottom:null}),e.set(this._pointerTop,{left:d+"px"}),m.add(this._pointerBottom,"hidden"),m.remove(this._pointerTop,"hidden")):(e.set(this.domNode,{left:l+"px",top:r-64+"px",bottom:null}),e.set(this._pointerBottom,
{left:d+"px"}),m.add(this._pointerTop,"hidden"),m.remove(this._pointerBottom,"hidden"))},_showPointer:function(a){k.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(e){e===a?c.query(".pointer."+e,this.domNode).removeClass("hidden"):c.query(".pointer."+e,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||this._initPopupInfoView();this.hide();y.show(this.popupNavigationBar.container);y.show(this.popupInfoView.container);
0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())},_handleNavigationBar:function(a){this.popupInfoView.animateTo(0);switch(a.name){case "CloseButton":y.hide(this.popupNavigationBar.container);y.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":y.hide(this.popupNavigationBar.container);y.hide(this.popupInfoView.container);this.show(this.location);break;case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),
this._updateUI()}},_initPopupNavigationBar:function(){var a={};a.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,
position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new A(a,t.create("div",{},p.body()));f.connect(this.popupNavigationBar,"onCreate",this,function(a){this._prevFeatureButton=a[3]._node;this._nextFeatureButton=a[4]._node});f.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);f.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();y.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=
new z({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},t.create("div",{},p.body()));m.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();f.connect(this.popupInfoView,"onCreate",this,function(a){this._contentPane=a[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});f.connect(this.popupInfoView,"onSwipeLeft",this,function(){});f.connect(this.popupInfoView,
"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var a="\x26nbsp;",e="\x26nbsp;",b=this.selectedIndex,h=this.features,n=this.deferreds,c=this._prevFeatureButton.parentNode,l=this._nextFeatureButton.parentNode,r=this._spinner,d=this._nls;h&&1<=h.length?(a=h[b].getTitle(),e=b+1+" of "+h.length,m.remove(this._arrowButton,"hidden"),0===b?(m.add(c,"hidden"),m.add(this._prev,"hidden")):(m.remove(c,"hidden"),m.remove(this._prev,"hidden")),b===h.length-1?(m.add(l,"hidden"),
m.add(this._next,"hidden")):(m.remove(l,"hidden"),m.remove(this._next,"hidden"))):(m.add(this._arrowButton,"hidden"),m.add(c,"hidden"),m.add(l,"hidden"),m.add(this._prev,"hidden"),m.add(this._next,"hidden"));this.setTitle(a,e);this.popupNavigationBar.getItems()[1]._node.innerHTML=e;n&&n.length?(m.remove(r,"hidden"),this.setTitle(d.NLS_searching+"...","\x26nbsp;")):(m.add(r,"hidden"),(!h||!h.length)&&this.setTitle("No Information","\x26nbsp;"))}})})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t){return q(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,e){var n;this.container=s.byId(e);this._touchBase=t(this.container,null);this._slideDiv=b.create("div",null,this.container,"first");this.events=[];this._items=a.items;a.sections&&(this._sections=a.sections);l.add(this.container,"esriMobileInfoView");if(0===this._sections.length)b.create("div",{},this._slideDiv);else for(n=0;n<this._sections.length;n++){var h=
b.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);b.create("div",{innerHTML:this._sections[n].title},h)}for(n=0;n<this._items.length;n++){var m,h=0;this._items[n].section&&(h=this._items[n].section);switch(this._items[n].type){case "div":m=b.create("div",{"class":"esriMobileInfoViewItem",style:this._items[n].style},this._slideDiv.childNodes[h]),m=b.create("div",{innerHTML:this._items[n].text},m)}this._items[n].className&&l.add(m,this._items[n].className);m._index=n;m._item=this._items[n];
this._items[n]._node=m}this.startTouchY=0},startup:function(){this.onCreate(this._items);this._animateTo(0)},destroy:function(){g.forEach(this.events,f.disconnect);this._touchBase=null;k.query("img",this.container).forEach(function(a){a._index=null;a._item=null;b.destroy(a)});this._items=null;b.destroy(this._slideDiv);b.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);
this.events.push(f.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(f.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler));this.events.push(f.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){f.disconnect(this.events.pop());f.disconnect(this.events.pop());f.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);
this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration="0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},
_onTouchMoveHandler:function(a){this._moveDirection||(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":this._moveDirection="horizontal");"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;if("vertical"===this._moveDirection)this._shouldStartMomentum()?this._doMomentum():this._snapToBounds();else if("horizontal"===
this._moveDirection)if("left"===a.swipeDirection)this.onSwipeLeft();else if("right"===a.swipeDirection)this.onSwipeRight()},_shouldStartMomentum:function(){this._diff=this._endTime-this._startTime;this._velocity=this._deltaMovement/this._diff;return 0.2<Math.abs(this._velocity)&&200>this._diff?!0:!1},_pullToStop:function(a){80<Math.abs(a)&&(a=0<a?80:-contentBox.h+parentBox.h-10-80);console.log(a);this._slideDiv.style.webkitTransition="-webkit-transform 200ms cubic-bezier(0, 0, 1, 1)";var e=f.connect(this._slideDiv,
"webkitTransitionEnd",this,function(){0<a?this._animateTo(0):this._animateTo(-contentBox.h+parentBox.h-10);f.disconnect(e)});this._animateTo(a)},_doMomentum:function(){var a,e;a=r.getContentBox(this.container);var b=0>this._velocity?0.001:-0.001;e=-(this._velocity*this._velocity)/(2*b);var h=-this._velocity/b,b=3*0.6-0,m=1-b,c=0,l=0;if(a.h>this._slideDiv.scrollHeight)this.contentOffsetY=0,l=300;else if(0<this.contentOffsetY+e){a=0;for(e=Math.floor(h/20);a<e;a++)if(c=(m*20*a^3)+(b*20*a^2)+0*20*a+0,
c=0>this._velocity?-c:c,0<this.contentOffsetY+c){l=20*a;break}0===l&&(l=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+e)+a.h>this._slideDiv.scrollHeight){this.contentOffsetY=a.h-this._slideDiv.scrollHeight;a=0;for(e=Math.floor(h/20);a<e;a++)if(c=(m*20*a^3)+(b*20*a^2)+0*20*a+0,c=0>this._velocity?-c:c,Math.abs(this.contentOffsetY+c)>this._slideDiv.scrollHeight){l=20*a;break}}else l=h,this.contentOffsetY+=e;this._slideDiv.style.webkitTransition="-webkit-transform "+l+"ms cubic-bezier(0, 0.3, 0.6, 1)";
this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var a=r.getContentBox(this.container);a.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+a.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=a.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=a;this._slideDiv.style.webkitTransform="translate3d(0, "+
a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return this.isDecelerate?!0:!1},_toggleNode:function(a,e){"ON"===e.toggleState?(e.toggleState="OFF",e.src&&(a.src=e.src.toString()),this.onUnSelect(e)):(e.toggleState="ON",e.srcAlt&&(a.src=e.srcAlt),this.onSelect(e))}})})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),
function(q,d,g,f,k,p){return q(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(c,d){this.domNode=f.byId(c);this.events=[g.connect(this.domNode,"touchstart",this,this._touchStartHandler),g.connect(this.domNode,"touchmove",this,this._touchMoveHandler),g.connect(this.domNode,"touchend",this,this._touchEndHandler),g.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(c){this._preventDefault=c},disableOnClick:function(){g.disconnect(this.events.pop())},
_clickHandler:function(c){if(this._moved)c.preventDefault();else this.onclick(c)},_touchStartHandler:function(c){this._moved=!1;this.client_x=c.targetTouches[0].clientX;this.client_y=c.targetTouches[0].clientY;this.down_x=c.targetTouches[0].pageX;this.down_y=c.targetTouches[0].pageY;c.downX=this.down_x;c.downY=this.down_y;this.onTouchStart(c)},_touchMoveHandler:function(c){this._preventDefault&&c.preventDefault();this._moved=!0;this.up_x=c.targetTouches[0].pageX;this.cur_x=c.targetTouches[0].pageX-
this.down_x;this.cur_y=c.targetTouches[0].pageY-this.down_y;c.curX=this.cur_x;c.curY=this.cur_y;this.onTouchMove(c)},_touchEndHandler:function(c){this._moved?(c.curX=this.cur_x,c.curY=this.cur_y,this.down_x-this.up_x>this._swipeThreshold?c.swipeDirection="left":this.up_x-this.down_x>this._swipeThreshold&&(c.swipeDirection="right")):(c.clientX=this.client_x,c.clientY=this.client_y);this.onTouchEnd(c)},onTouchStart:function(c){},onTouchMove:function(c){},onTouchEnd:function(c){},onclick:function(c){}})})},
"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m){return q(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(m,a){var e;this.container=s.byId(a);this._touchBase=r(this.container,null);this._slideDiv=b.create("div",{},this.container,"first");this.events=[g.connect(this._touchBase,
"onclick",this,this._onClickHandler)];this._items=m.items;l.add(this.container,"esriMobileNavigationBar");var n=b.create("div",{},this._slideDiv);for(e=0;e<this._items.length;e++){var h,c;switch(this._items[e].type){case "img":c=b.create("div",{"class":"esriMobileNavigationItem"},n);h=b.create("img",{src:this._items[e].src.toString(),style:{width:"100%",height:"100%"}},c);break;case "span":c=b.create("div",{"class":"esriMobileNavigationItem"},n);h=b.create("span",{innerHTML:this._items[e].text},c);
break;case "div":c=b.create("div",{"class":"esriMobileNavigationInfoPanel"},n),h=b.create("div",{innerHTML:this._items[e].text},c)}l.add(c,this._items[e].position);this._items[e].className&&l.add(h,this._items[e].className);h._index=e;h._item=this._items[e];this._items[e]._node=h}},startup:function(){this.onCreate(this._items)},destroy:function(){f.forEach(this.events,g.disconnect);this._touchBase=null;k.query("img",this.container).forEach(function(m){m._index=null;m._item=null;b.destroy(m)});this._items=
null;b.destroy(this._slideDiv);b.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(b){this._markSelected(b._node,b)},onSelect:function(b){},onUnSelect:function(b){},onCreate:function(b){},_onClickHandler:function(b){if("img"===b.target.tagName.toLowerCase()){var a=b.target,e=a._item;k.query("img",this.container).forEach(function(b){b!==a&&b._item.toggleGroup===e.toggleGroup&&this._markUnSelected(b,b._item)},this);this._toggleNode(a,
e)}},_toggleNode:function(b,a){"ON"===a.toggleState?(a.toggleState="OFF",a.src&&(b.src=a.src.toString()),this.onUnSelect(a)):(a.toggleState="ON",a.srcAlt&&(b.src=a.srcAlt),this.onSelect(a))},_markSelected:function(b,a){a.toggleState="ON";a.srcAlt&&(b.src=a.srcAlt);this.onSelect(a)},_markUnSelected:function(b,a){"ON"===a.toggleState&&(a.toggleState="OFF",a.src&&(b.src=a.src.toString()),this.onUnSelect(a))}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase",
"dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(q,d,g,f,k){return q([d,g],{"class":"jimu-loading-shelter",templateString:f,loadingText:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&k.setStyle(this.domNode,"display","none");k.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";"string"===
typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(d){this.domNode&&this.hidden&&("string"===typeof d&&(this.textNode.innerHTML=d),k.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(k.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/PreloadWidgetIcon":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_WidgetBase ./utils".split(" "),
function(q,d,g,f,k,p,c,s,l){return q(s,{"class":"jimu-preload-widget-icon",postCreate:function(){this.inherited(arguments);this.iconNode=g.create("img",{src:this.widgetConfig.icon},this.domNode);g.setAttr(this.domNode,"title",this.widgetConfig.label);this.own(f(this.domNode,"click",d.hitch(this,function(){this.onClick()})));this.state="closed"},startup:function(){this.inherited(arguments)},onClick:function(){"closed"===this.state?this.switchToOpen():this.switchToClose()},moveTo:function(b){var c=
{left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},c=d.mixin(c,l.getPositionStyle(b));delete c.width;delete c.height;g.setStyle(this.domNode,c);"opened"===this.state&&this.panel&&g.setStyle(this.panel.domNode,this.getIconPanelPosition())},destroy:function(){this.panel&&this.panelManager.destroyPanel(this.panel);this.inherited(arguments)},switchToOpen:function(){this.state="opened";g.addClass(this.domNode,"jimu-state-selected");this.widgetConfig.panel.widgetIcon=this.domNode;
this.widgetConfig.panel.position=this.getIconPanelPosition();this.panelManager.showPanel(this.widgetConfig).then(d.hitch(this,function(b){this.panel=b;this.own(f(b,"close",d.hitch(this,function(){this.switchToClose()})))}))},switchToClose:function(){this.state="closed";g.removeClass(this.domNode,"jimu-state-selected");this.panelManager.closePanel(this.panel)},getIconPanelPosition:function(){var b={},c,m;c="map"===this.widgetConfig.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;m=g.getMarginBox(this.domNode);
b.width=this.widgetConfig.panel.position.width?this.widgetConfig.panel.position.width:400;b.height=this.widgetConfig.panel.position.height?this.widgetConfig.panel.position.height:400;c=g.getContentBox(c);var l,a;b.top=m.t+m.h+2;b.top+b.height>c.h&&(l=m.t,a=c.h-m.t-m.h,a=Math.max(l,a),a===l&&(b.top=m.t-b.height-2));b.left=m.l;b.left+b.width>c.w&&(b.left="",b.right=0);return b}})})},"jimu/WidgetPlaceholder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_WidgetBase ./utils".split(" "),
function(q,d,g,f,k,p,c,s,l){return q(s,{"class":"jimu-widget-placeholder",postCreate:function(){this.inherited(arguments);this.indexNode=g.create("div",{"class":"inner",innerHTML:this.index},this.domNode);g.setAttr(this.domNode,"title",window.jimuNls.widgetPlaceholderTooltip)},moveTo:function(b){var c={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},c=d.mixin(c,l.getPositionStyle(b));delete c.width;delete c.height;g.setStyle(this.domNode,c)},setIndex:function(b){this.index=
b;this.indexNode.innerHTML=b}})})},"jimu/BaseWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(q,d,g,f,k,p){return q([k,p],{listenWidgetNames:[],listenWidgetIds:[],type:"widget",id:void 0,label:void 0,icon:void 0,uri:void 0,position:{},config:void 0,openAtStart:!1,map:null,appConfig:null,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",
constructor:function(){this.listenWidgetClassNames=[];this.listenWidgetIds=[];this.own(f.subscribe("publishData",d.hitch(this,this._onReceiveData)));this.own(f.subscribe("dataFetched",d.hitch(this,this._onReceiveData)));this.own(f.subscribe("noData",d.hitch(this,this._onNoData)))},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(c){},onSignOut:function(){},onPositionChange:function(c){this.position=c},setMap:function(c){this.map=
c},setState:function(c){this.state=c},setWindowState:function(c){this.windowState=c},resize:function(){},onConfigChanged:function(c){},onAppConfigChanged:function(c,d,l){},onAction:function(c,d){},publishData:function(c,d){"undefined"===typeof d&&(d=!0);f.publish("publishData",this.name,this.id,c,d)},fetchData:function(c){c?f.publish("fetcheData",c):0!==this.listenWidgetIds.length?g.forEach(this.listenWidgetIds,function(c){f.publish("fetcheData",c)},this):f.publish("fetcheData")},_onReceiveData:function(c,
d,l){if(!(c===this.name||d===this.id)&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(d)))this.onReceiveData(c,d,l)},onReceiveData:function(c,d,l){},_onNoData:function(c,d){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(d)))this.onNoData(c,d)},onNoData:function(c,d){}})})},"jimu/BaseWidgetFrame":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(q,d,g,f){return q([f],{widget:null,baseClass:"jimu-widget-frame jimu-container",
postCreate:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.widget&&this.setWidget(this.widget)},startup:function(){this.inherited(arguments);this.widget&&this.widget.startup()},resize:function(){this.widget&&d.isFunction(this.widget.resize)&&this.widget.resize()},setLoading:function(d){this.loading=d;this.loading.placeAt(this.containerNode)},getWidget:function(){return this.widget},setWidget:function(d){this.widget=d;this.loading&&this.loading.destroy();
g.place(d.domNode,this.containerNode);this.resize()},destroy:function(){if(this.widget&&this.widget.domNode)try{this.widget.destroy()}catch(d){console.error("destroy widget error. widget: ["+this.widget.uri+"], "+d.stack)}this.loading&&this.loading.domNode&&this.loading.destroy()}})})},"jimu/BaseWidgetPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_Container ./dijit/LoadingIndicator ./dijit/IFramePane ./BaseWidgetFrame".split(" "),
function(q,d,g,f,k,p,c,s,l){return q([k,p],{baseClass:"jimu-widget-panel jimu-container",started:!1,state:"closed",windowState:"normal",defaultState:"normal",type:"panel",constructor:function(){},postCreate:function(){this.inherited(arguments);this.map.usePlugin&&this.position&&(this.iframePane=new s({r:8,position:this.position}),f.place(this.iframePane.domNode,this.containerId))},startup:function(){this.inherited(arguments);this.iframePane&&this.iframePane.startup();this.loadAllWidgetsInOrder();
this.started=!0},loadAllWidgetsInOrder:function(){var b=this.getAllWidgetConfigs(),b=Array.isArray(this.config.widgets)?this.config.widgets:[this.config];g.forEach(b,function(b){var m,l;l=new c;m=this.createFrame(b);this.addChild(m);m.setLoading(l);this.widgetManager.loadWidget(b).then(d.hitch(this,function(a){m.setWidget(a);a.startup()}))},this)},getAllWidgetConfigs:function(){var b=[];return b=Array.isArray(this.config.widgets)?this.config.widgets:[this.config]},getWidgetById:function(b){for(var c=
this.getChildren(),m=0;m<c.length;m++)if(c[m].getWidget()&&c[m].getWidget().id===b)return c[m].getWidget()},createFrame:function(b){return new l},setState:function(b){this.state=b},setWindowState:function(b){this.windowState=b},resize:function(){this.getChildren().forEach(function(b){b.resize()});this.iframePane&&this.iframePane.resize()},onOpen:function(){g.forEach(this.getChildren(),function(b){b.getWidget()&&this.widgetManager.openWidget(b.getWidget())},this);this.iframePane&&f.setStyle(this.iframePane.domNode,
"display","")},onClose:function(){g.forEach(this.getChildren(),function(b){b.getWidget()&&this.widgetManager.closeWidget(b.getWidget())},this);this.iframePane&&f.setStyle(this.iframePane.domNode,"display","none")},onMaximize:function(){g.forEach(this.getChildren(),function(b){b.getWidget()&&this.widgetManager.maximizeWidget(b.getWidget())},this)},onMinimize:function(){g.forEach(this.getChildren(),function(b){b.getWidget()&&this.widgetManager.minimizeWidget(b.getWidget())},this)},onNormalize:function(){g.forEach(this.getChildren(),
function(b){b.getWidget()&&this.widgetManager.normalizeWidget(b.getWidget())},this)},updateConfig:function(b){this._updateConfig(b)},reloadWidget:function(b){this.isWidgetInPanel(b)&&(this._updateConfig(b),this.getChildren().forEach(function(l){l.getWidget()&&l.getWidget().id===b.id&&(l.getWidget().destroy(),l.setLoading(new c),this.widgetManager.loadWidget(b).then(d.hitch(this,function(b){l.setWidget(b);b.startup();"closed"===this.state&&this.widgetManager.closeWidget(b)})))},this))},isWidgetInPanel:function(b){return g.some(this.getAllWidgetConfigs(),
function(c){if(b.id===c.id)return!0})?!0:!1},_updateConfig:function(b){if(Array.isArray(this.config.widgets)){for(var c=-1,m=0;m<this.config.widgets.length;m++)this.config.widgets[m].id===b.id&&(c=m);0<c&&(this.config.widgets[c]=b)}else this.config=b},destroy:function(){this.getChildren().forEach(function(b){try{b.domNode&&b.destroy()}catch(c){console.error("destroy widget frame error."+c.stack)}});this.inherited(arguments)}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(q,d,g,f){return q(d,{"class":"jimu-loading-indicator",hidden:!1,postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&g.set(this.domNode,{display:"none"});g.set(this.domNode,{width:"100%",height:"100%"});f.place('\x3cimg class\x3d"jimu-loading" src\x3d"'+require.toUrl("jimu")+'/images/loading.gif"\x3e',this.domNode)},show:function(){this.domNode&&g.set(this.domNode,"display","block")},hide:function(){this.domNode&&
g.set(this.domNode,"display","none")}})})},"jimu/dijit/IFramePane":function(){define("dojo/_base/declare dojo/_base/html dojo/query dojo/NodeList dojo/NodeList-dom dijit/_WidgetBase ../utils".split(" "),function(q,d,g,f,k,p,c){return q(p,{baseClass:"jimu-iframe-pane",r:8,color:"white",postCreate:function(){this.position&&this.setPosition(this.position)},startup:function(){this.inherited(arguments);this._createLayoutTable()},resize:function(){var c=d.getMarginBox(this.domNode),l=this.r;this.inherited(arguments);
g(".tr2",this.domNode).style("height",c.h-2*l+"px");g(".td2",this.domNode).style("width",c.w-2*l+"px");g(".td4",this.domNode).style("height",c.h-2*l+"px");g(".td5",this.domNode).style("width",c.w-2*l+"px").style("height",c.h-2*l+"px");g(".td6",this.domNode).style("height",c.h-2*l+"px");g(".td8",this.domNode).style("width",c.w-2*l+"px")},setPosition:function(s){this.position=s;s=c.getPositionStyle(s);s.position="absolute";s.zIndex=99;s.overflow="hidden";d.setStyle(this.domNode,s)},hide:function(){d.setStyle(this.domNode,
{display:"none"})},show:function(){d.setStyle(this.domNode,{display:"block"})},_createLayoutTable:function(){var c=d.getMarginBox(this.domNode),l,b=[],r=[],m=this.r;l=d.create("table",{"class":"jimu-table iframe-float-layout-table",style:{width:"100%",height:"100%",display:"block"}},this.domNode);b.push(d.create("tr",{"class":"tr1",style:{width:"100%",height:m+"px"}},l));b.push(d.create("tr",{"class":"tr2",style:{width:"100%",height:c.h-2*m+"px"}},l));b.push(d.create("tr",{"class":"tr3",style:{width:"100%",
height:m+"px"}},l));r.push(d.create("td",{"class":"td1",style:{width:m+"px",height:m+"px"}},b[0]));r.push(d.create("td",{"class":"td2",style:{width:c.w-2*m+"px",height:m+"px"}},b[0]));r.push(d.create("td",{"class":"td3",style:{width:m+"px",height:m+"px"}},b[0]));r.push(d.create("td",{"class":"td4",style:{width:m+"px",height:c.h-2*m+"px"}},b[1]));r.push(d.create("td",{"class":"td5",style:{width:c.w-2*m+"px",height:c.h-2*m+"px"}},b[1]));r.push(d.create("td",{"class":"td6",style:{width:m+"px",height:c.h-
2*m+"px"}},b[1]));r.push(d.create("td",{"class":"td7",style:{width:m+"px",height:m+"px"}},b[2]));r.push(d.create("td",{"class":"td8",style:{width:c.w-2*m+"px",height:m+"px"}},b[2]));r.push(d.create("td",{"class":"td9",style:{width:m+"px",height:m+"px"}},b[2]));for(c=0;c<r.length;c++)d.setStyle(r[c],"position","relative");this._createRoundCorner(r[0],"lt");this._createFullIframe(r[1]);this._createRoundCorner(r[2],"rt");this._createFullIframe(r[3]);this._createFullIframe(r[4]);this._createFullIframe(r[5]);
this._createRoundCorner(r[6],"lb");this._createFullIframe(r[7]);this._createRoundCorner(r[8],"rb")},_createRoundCorner:function(c,l){var b,d=this.r,m;for(b=1;b<=d;b++)m=Math.sqrt(d*d-(d-b)*(d-b)),"lt"===l?this._createLineIframe(d-m,b-1,m,1,c):"rt"===l?this._createLineIframe(0,b-1,m,1,c):"lb"===l?this._createLineIframe(d-m,d-b,m,1,c):"rb"===l&&this._createLineIframe(0,d-b,m,1,c)},_createLineIframe:function(c,l,b,r,m){return d.create("iframe",{style:{border:"none",position:"absolute",background:"white",
left:c+"px",top:l+"px",width:b+"px",height:r+"px",backgroundColor:this.color,display:"block"}},m)},_createFullIframe:function(c){return d.create("iframe",{style:{border:"none",background:"white",width:"100%",height:"100%",backgroundColor:this.color,display:"block"}},c)}})})},"dojo/NodeList":function(){define(["./query"],function(q){return q.NodeList})},"jimu/BaseWidgetSetting":function(){define("dojo/_base/declare dojo/_base/lang dojo/topic dojo/on dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(q,d,g,f,k,p){return q([k,p],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.own(f(window,"resize",d.hitch(this,this._onWindowResize)))},getConfig:function(){},setConfig:function(c){},resize:function(){},_onWindowResize:function(){this.resize()}})})},"jimu/symbolUtils":function(){define(["dojo/_base/lang","dojo/_base/html","dojox/gfx","esri/symbols/jsonUtils"],function(q,d,g,f){return{cloneSymbol:function(d){if(!d)return null;var g=null;try{var c=d.toJson(),g=f.fromJson(c)}catch(s){console.error(s)}return g},
getDefaultMarkerSymbol:function(){return f.fromJson({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})},getDefaultLineSymbol:function(){return f.fromJson({tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"})},getDefaultFillSymbol:function(){return f.fromJson({tags:["opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,255],name:"Blue 6",type:"esriSFS",outline:{style:"esriSLSSolid",
color:[54,93,141,255],width:1.5,type:"esriSLS"}})},getHightlightMarkerSymbol:function(){return f.fromJson({color:[255,255,255,128],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"}})},getHightlightLineSymbol:function(){return f.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"})},getHightlightFillSymbol:function(){return f.fromJson({color:[255,255,255,128],outline:{color:[0,
255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"})},createSymbolNode:function(k,p){var c=32,s=32,l=d.create("div");d.setStyle(l,"display","inline-block");if(p)c=p.width,s=p.height;else if(c=80,s=30,this.isSimpleMarkerSymbol(k))s=c=Math.min(k.size+12,125);else if(this.isPictureMarkerSymbol(k)){if(!k.url||"http://"===k.url||-1===k.url.indexOf("http://")&&-1===k.url.indexOf("https://")&&-1===k.url.indexOf("data:"))return;s=c=Math.min(Math.max(k.width,k.height),
125)}else if(this.isSimpleLineSymbol(k)||this.isCartographicLineSymbol(k))c=190,s=20;var b=g.createSurface(l,c,s);if("vml"===g.renderer){var r=b.getEventSource();d.setStyle(r,"position","relative");d.setStyle(r.parentNode,"position","relative")}var r=null,r=p?f.getShapeDescriptors(k):this.isSimpleLineSymbol(k)||this.isCartographicLineSymbol(k)?this._getLineShapeDesc(k):f.getShapeDescriptors(k),m;try{m=b.createShape(r.defaultShape),r.fill&&m.setFill(r.fill),r.stroke&&m.setStroke(r.stroke)}catch(t){b.clear();
b.destroy();return}var b=b.getDimensions(),b={dx:b.width/2,dy:b.height/2},a=m.getBoundingBox(),r=a.width,a=a.height;if(r>c||a>s)c=((c<s?c:s)-5)/(r>a?r:a),q.mixin(b,{xx:c,yy:c});m.applyTransform(b);return l},_getLineShapeDesc:function(d){var f=null;if(this.isSimpleLineSymbol(d)||this.isCartographicLineSymbol(d))f={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:d.getStroke()};return f},isSimpleMarkerSymbol:function(d){return d&&"esri.symbol.SimpleMarkerSymbol"===d.declaredClass},
isPictureMarkerSymbol:function(d){return d&&"esri.symbol.PictureMarkerSymbol"===d.declaredClass},isSimpleLineSymbol:function(d){return d&&"esri.symbol.SimpleLineSymbol"===d.declaredClass},isCartographicLineSymbol:function(d){return d&&"esri.symbol.CartographicLineSymbol"===d.declaredClass},isSimpleFillSymbol:function(d){return d&&"esri.symbol.SimpleFillSymbol"===d.declaredClass},isPictureFillSymbol:function(d){return d&&"esri.symbol.PictureFillSymbol"===d.declaredClass},isTextSymbol:function(d){return d&&
"esri.symbol.TextSymbol"===d.declaredClass}}})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale esri/lang dojo/data/ItemFileWriteStore".split(" "),function(q,d,g,f,k,p){return q([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=
function(c){return 0===this.indexOf(c)};String.prototype.endsWith=function(c){return this.substring(this.length-c.length)===c};String.prototype.count=function(c){return this.split(c).length-1};String.prototype.trim||(String.prototype.trim=d.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",
stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",stringOperatorContains:"stringOperatorContains",stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",
numberOperatorIsAtMost:"numberOperatorIsAtMost",numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",dateOperatorIsBetween:"dateOperatorIsBetween",
dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",dateOperatorMonths:"dateOperatorMonths",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast"},setFieldsStoreByFieldInfos:function(c){c=g.filter(c,d.hitch(this,function(c){return 0<=this._supportFieldTypes.indexOf(c.type)}));c=g.map(c,function(c,
l){var b;switch(c.type){case "esriFieldTypeString":b="string";break;case "esriFieldTypeDate":b="date";break;default:b="number"}return{id:l,label:c.name,shortType:b,alias:c.alias,editable:c.editable,name:c.name,nullable:c.nullable,type:c.type}},this);this.fieldsStore=new p({data:{identifier:"id",label:"label",items:c}});return c.length},_validatePartsObj:function(c){return c&&"object"===typeof c},_isObject:function(c){return c&&"object"===typeof c},_isString:function(c){return c&&"string"===typeof c},
getExprByFilterObj:function(c){var d="";if(1===c.parts.length)d=this.builtFilterString(c.parts[0]);else for(var l="",b=0;b<c.parts.length;b++){var r=this.builtFilterString(c.parts[b]);if(!k.isDefined(r))return null;d+=l+"("+r+")";l=l||" "+c.logicalOperator+" "}return c.expr=d},builtFilterString:function(c){var d="";if(c.parts)for(var l="",b=0;b<c.parts.length;b++){var r=c.parts[b],m=this.builtSingleFilterString(r);r.expr=m.whereClause;if(!k.isDefined(m.whereClause))return null;d+=l+m.whereClause;
l=" "+c.logicalOperator+" "}else d=this.builtSingleFilterString(c).whereClause;return c.expr=d},builtSingleFilterString:function(c,d){if(k.isDefined(c.valueObj.isValid)&&!c.valueObj.isValid)return{whereClause:null};var l=c.valueObj.value,b=c.valueObj.value1,r=c.valueObj.value2,m=!1;if(c.interactiveObj){if(!c.interactiveObj.prompt||!c.interactiveObj.hint)return{whereClause:null};k.isDefined(d)&&(m=!0,k.isDefined(c.valueObj.value)&&(l="{"+d+"}"),k.isDefined(c.valueObj.value1)&&(b="{"+d+"}"),k.isDefined(c.valueObj.value2)&&
(r="{"+(d+1)+"}"))}var f="";if("string"===c.fieldObj.shortType)switch(c.operator){case this.OPERATORS.stringOperatorIs:f="field"===c.valueObj.type?c.fieldObj.name+" \x3d "+l:c.fieldObj.name+" \x3d '"+l.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorIsNot:f="field"===c.valueObj.type?c.fieldObj.name+" \x3c\x3e "+l:c.fieldObj.name+" \x3c\x3e '"+l.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorStartsWith:f=c.fieldObj.name+" LIKE '"+l.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorEndsWith:f=
c.fieldObj.name+" LIKE '%"+l.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorContains:f=c.fieldObj.name+" LIKE '%"+l.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorDoesNotContain:f=c.fieldObj.name+" NOT LIKE '%"+l.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorIsBlank:f=c.fieldObj.name+" IS NULL";break;case this.OPERATORS.stringOperatorIsNotBlank:f=c.fieldObj.name+" IS NOT NULL"}else if("number"===c.fieldObj.shortType)switch(c.operator){case this.OPERATORS.numberOperatorIs:f=
c.fieldObj.name+" \x3d "+l;break;case this.OPERATORS.numberOperatorIsNot:f=c.fieldObj.name+" \x3c\x3e "+l;break;case this.OPERATORS.numberOperatorIsAtLeast:f=c.fieldObj.name+" \x3e\x3d "+l;break;case this.OPERATORS.numberOperatorIsLessThan:f=c.fieldObj.name+" \x3c "+l;break;case this.OPERATORS.numberOperatorIsAtMost:f=c.fieldObj.name+" \x3c\x3d "+l;break;case this.OPERATORS.numberOperatorIsGreaterThan:f=c.fieldObj.name+" \x3e "+l;break;case this.OPERATORS.numberOperatorIsBetween:f=c.fieldObj.name+
" BETWEEN "+b+" AND "+r;break;case this.OPERATORS.numberOperatorIsNotBetween:f=c.fieldObj.name+" NOT BETWEEN "+b+" AND "+r;break;case this.OPERATORS.numberOperatorIsBlank:f=c.fieldObj.name+" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:f=c.fieldObj.name+" IS NOT NULL"}else switch(k.isDefined(l)&&("field"!==c.valueObj.type&&"string"===typeof l)&&(l=new Date(l)),"field"!==c.valueObj.type&&(l&&(l=new Date(l)),b&&(b=new Date(b)),r&&(r=new Date(r))),c.operator){case this.OPERATORS.dateOperatorIsOn:f=
"field"===c.valueObj.type?c.fieldObj.name+" \x3d "+l:m?c.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+d+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(d+1)+"}'":c.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(l)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(l))+"'";break;case this.OPERATORS.dateOperatorIsNotOn:f="field"===c.valueObj.type?c.fieldObj.name+" \x3c\x3e "+l:m?c.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":
"timestamp ")+"'{"+d+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(d+1)+"}'":c.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(l)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(l))+"'";break;case this.OPERATORS.dateOperatorIsBefore:f="field"===c.valueObj.type?c.fieldObj.name+" \x3c "+l:c.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(l)+"'";break;case this.OPERATORS.dateOperatorIsAfter:f="field"===c.valueObj.type?
c.fieldObj.name+" \x3e "+l:c.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(l))+"'";break;case this.OPERATORS.dateOperatorIsBetween:f=m?c.fieldObj.name+" BETWEEN '"+b+"' AND '"+r+"'":c.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:f=m?c.fieldObj.name+" NOT BETWEEN '"+b+"' AND '"+r+"'":c.fieldObj.name+
" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsBlank:f=c.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:f=c.fieldObj.name+" IS NOT NULL"}return{whereClause:f}},formatDate:function(c){var d=f.format(c,{datePattern:"yyyy-MM-dd",selector:"date"});c=f.format(c,{selector:"time",timePattern:"HH:mm:ss"});return d+" "+c},addDay:function(c){return new Date(c.getTime()+
this.dayInMS)},getFilterObjByExpr:function(c){if(c&&this.fieldsStore){var d=this.replaceStrings(c);c=d.defExpr;var l=this.findParts(c,"AND");1===l.parts.length&&(l=this.findParts(c,"OR"),1===l.parts.length&&(l.logicalOperator="AND"));g.forEach(l.parts,function(b){b.expr=b.expr.trim();if(b.expr.startsWith("(")&&-1<b.expr.search(/\)$/)){var c=b.expr.substring(1,b.expr.length-1),m=c.indexOf("("),l=c.indexOf(")");if(-1===m&&-1===l||m<l)b.expr=c}c=this.findParts(b.expr,"AND");1===c.parts.length&&(c=this.findParts(b.expr,
"OR"));1<c.parts.length&&(b.parts=c.parts,b.logicalOperator=c.logicalOperator)},this);this.parseExpr(l);this.reReplaceStrings(d,l);return l}},replaceStrings:function(c){for(var d=c,l=function(a,b,h){var c=-1,c=a.indexOf("'",h+1);return c===h+1?(c=a.indexOf("'",c+1),l(a,b,c)):h},b=[],r=c.indexOf("'");-1<r;){var m=r,r=c.indexOf("'",r+1),f=0,r=l(c,m,r);"%"===c[m+1]&&m++;"%"===c[r-1]&&(r-=1,f++);var a=c.substring(m+1,r);"N"===c[m-1]&&(c=c.substring(0,m-1)+c.substring(m),m-=1,r-=1);!this.isDateString(a)&&
-1===a.indexOf("{")?(b.push(a),c=c.substring(0,m+1)+"#"+(b.length-1)+"#"+c.substring(r),r=c.indexOf("'",c.lastIndexOf("#")+2+f)):r=c.indexOf("'",r+1+f)}return{origDefExpr:d,defExpr:c,savedStrings:b}},reReplaceStrings:function(c,f){var l=c.savedStrings;if(l.length&&l.length){var b=function(b,c){if("string"!==b.fieldObj.shortType)return!1;var a=b.valueObj.value.indexOf("#"),e=b.valueObj.value.lastIndexOf("#");return k.isDefined(b.valueObj.value)&&-1<a?(b.valueObj.value=c[parseInt(b.valueObj.value.substring(a+
1,e),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(b),!0):!1},b=d.hitch(this,b),r=!1;g.forEach(f.parts,function(c){if(c.parts){var d=!1;g.forEach(c.parts,function(a){d=b(a,l)||d});d&&(r=d,c.expr=this.builtFilterString(c))}else(r=b(c,l)||r)&&this.builtFilterString(c)},this);r&&(f.expr=null,this.getExprByFilterObj(f))}},isDateString:function(c){return 19===c.length&&"-"===c.charAt(4)&&"-"===c.charAt(7)&&" "===c.charAt(10)&&":"===c.charAt(13)&&":"===c.charAt(16)?!0:!1},findParts:function(c,
d){for(var l=c.toLowerCase(),b=" "+d.toLowerCase()+" ",r=[],m=0,f=l.indexOf(b);0<f;){var a=c.substring(m,f),e=a.toLowerCase(),n=a.count("("),h=a.count(")"),k=a.count("'");n!==h||1===k%2?f=l.indexOf(b,f+1):-1<e.indexOf(" between ")&&-1===e.indexOf(" and ")?f=l.indexOf(b,f+1):(r.push({expr:a}),m=f+b.length,f=l.indexOf(b,m))}r.push({expr:c.substring(m)});for(l=r.length-1;0<=l;l--)!this.hasOperator(r[l].expr)&&0<l&&(r[l-1].expr+=" "+d+" "+r[l].expr,r.splice(l,1));return{expr:c,parts:r,logicalOperator:d}},
hasOperator:function(c){c=c.toLowerCase();return-1<c.indexOf("{")&&-1<c.indexOf("}")||-1<c.indexOf(" \x3d ")||-1<c.indexOf(" \x3c ")||-1<c.indexOf(" \x3e ")||-1<c.indexOf(" \x3c\x3e ")||-1<c.indexOf(" \x3c\x3d ")||-1<c.indexOf(" \x3e\x3d ")||-1<c.indexOf(" like ")||-1<c.indexOf(" between ")||-1<c.indexOf(" date")||-1<c.indexOf(" is null")||-1<c.indexOf(" is not null")?!0:!1},parseExpr:function(c){g.forEach(c.parts,function(c){c.parts?this.parseExpr(c):this.parseSingleExpr(c)},this)},_preParseSingleExpr:function(c){var f=
d.clone(c);f.expr=f.expr.trim();c=f.expr;if(/^UPPER(.*)(\s+)LIKE(\s+)UPPER((.*))$/i.test(c)){var l=c.indexOf("("),b=c.indexOf(")"),r=c.substring(l+1,b),l=c.lastIndexOf("("),b=c.lastIndexOf(")");c=c.substring(l+2,b+1);f.fieldObj={name:r};f.valueObj={};this.getFieldItemByName({name:r},d.hitch(this,function(b){f.fieldObj.shortType=b.shortType[0];f.fieldObj.label=b.label[0]}),d.hitch(this,function(){f.error={msg:"unknown field name ("+r+")",code:1}}));this.storeValue(c,f);f.operator="stringOperatorContainsCaseInSensitive";
return f}return null},parseSingleExpr:function(c){var d=c.expr.trim(),l=d.indexOf(" "),b=d.substring(0,l);c.fieldObj={name:b};c.valueObj={};this.getFieldItemByName({name:b},function(b){c.fieldObj.shortType=b.shortType[0];c.fieldObj.label=b.label[0]},function(){c.error={msg:"unknown field name ("+b+")",code:1}});d=d.substring(l+1).trim();l=d.toLowerCase();l.startsWith("\x3d ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(12).trim():d.substring(2).trim(),this.storeValue(d,c),c.operator=
"date"===c.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===c.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):l.startsWith("\x3c ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(12).trim():d.substring(2).trim(),this.storeValue(d,c),"date"===c.fieldObj.shortType?c.operator=this.OPERATORS.dateOperatorIsBefore:"number"===c.fieldObj.shortType?c.operator=this.OPERATORS.numberOperatorIsLessThan:c.error={msg:"operator ("+l+") not supported for string",
code:3}):l.startsWith("\x3e ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(12).trim():d.substring(2).trim(),this.storeValue(d,c),"date"===c.fieldObj.shortType?c.operator=this.OPERATORS.dateOperatorIsAfter:"number"===c.fieldObj.shortType?c.operator=this.OPERATORS.numberOperatorIsGreaterThan:c.error={msg:"operator ("+l+") not supported for string",code:3}):l.startsWith("\x3c\x3e ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(13).trim():d.substring(3).trim(),this.storeValue(d,
c),c.operator="date"===c.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===c.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):l.startsWith("\x3c\x3d ")?(this.storeValue(d.substring(3).trim(),c),c.operator=this.OPERATORS.numberOperatorIsAtMost):l.startsWith("\x3e\x3d ")?(this.storeValue(d.substring(3).trim(),c),c.operator=this.OPERATORS.numberOperatorIsAtLeast):l.startsWith("like ")?(d=d.substring(5).trim(),d.startsWith("N'")&&(d=d.substring(1,
d.length)),d.startsWith("'%")&&d.endsWith("%'")?(this.storeValue(d.substring(2,d.length-2),c),c.operator=this.OPERATORS.stringOperatorContains):d.startsWith("'%")&&d.endsWith("'")?(this.storeValue(d.substring(2,d.length-1),c),c.operator=this.OPERATORS.stringOperatorEndsWith):d.startsWith("'")&&d.endsWith("%'")?(this.storeValue(d.substring(1,d.length-2),c),c.operator=this.OPERATORS.stringOperatorStartsWith):c.error={msg:"value ("+l+") not supported for LIKE",code:3}):l.startsWith("not like ")?(d=d.substring(9).trim(),
d.startsWith("N'")&&(d=d.substring(1,d.length)),d.startsWith("'%")&&d.endsWith("%'")?(this.storeValue(d.substring(2,d.length-2),c),c.operator=this.OPERATORS.stringOperatorDoesNotContain):c.error={msg:"value ("+l+") not supported for NOT LIKE",code:3}):l.startsWith("between ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(18).trim():d.substring(8).trim(),l=d.toLowerCase().indexOf(" and "),-1<l?(this.storeValue1(d.substring(0,l).trim(),c),"date"===c.fieldObj.shortType&&!this.isHosted?
this.storeValue2(d.substring(l+15).trim(),c):this.storeValue2(d.substring(l+5).trim(),c)):c.error={msg:"missing AND operator for BETWEEN",code:3},"date"===c.fieldObj.shortType?"string"===typeof c.valueObj.value1?c.operator=this.OPERATORS.dateOperatorIsBetween:1E3>Math.abs(this.subtractDay(c.valueObj.value2).getTime()-c.valueObj.value1.getTime())?(c.valueObj.value=c.valueObj.value1,delete c.valueObj.value1,delete c.valueObj.value2,c.operator=this.OPERATORS.dateOperatorIsOn):c.operator=this.OPERATORS.dateOperatorIsBetween:
"number"===c.fieldObj.shortType||"oid"===c.fieldObj.shortType?c.operator=this.OPERATORS.numberOperatorIsBetween:c.error={msg:"string field not supported for BETWEEN",code:3}):l.startsWith("not between ")?(d="date"===c.fieldObj.shortType&&!this.isHosted?d.substring(22).trim():d.substring(12).trim(),l=d.toLowerCase().indexOf(" and "),-1<l?(this.storeValue1(d.substring(0,l).trim(),c),"date"===c.fieldObj.shortType&&!this.isHosted?this.storeValue2(d.substring(l+15).trim(),c):this.storeValue2(d.substring(l+
5).trim(),c)):c.error={msg:"missing AND operator for NOT BETWEEN",code:3},"date"===c.fieldObj.shortType?"string"===typeof c.valueObj.value1?c.operator=this.OPERATORS.dateOperatorIsNotBetween:1E3>Math.abs(this.subtractDay(c.valueObj.value2).getTime()-c.valueObj.value1.getTime())?(c.valueObj.value=c.valueObj.value1,delete c.valueObj.value1,delete c.valueObj.value2,c.operator=this.OPERATORS.dateOperatorIsNotOn):c.operator=this.OPERATORS.dateOperatorIsNotBetween:"number"===c.fieldObj.shortType||"oid"===
c.fieldObj.shortType?c.operator=this.OPERATORS.numberOperatorIsNotBetween:c.error={msg:"string field not supported for NOT BETWEEN",code:3}):"is null"===l?(c.valueObj.value=null,c.operator="date"===c.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===c.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):"is not null"===l?(c.valueObj.value=null,c.operator="date"===c.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===c.fieldObj.shortType?
this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):c.error={msg:"unknown operator ("+l+")",code:2};if(k.isDefined(c.valueObj.value)&&"string"===typeof c.valueObj.value&&c.valueObj.value.startsWith("{")&&c.valueObj.value.endsWith("}")||k.isDefined(c.valueObj.value1)&&"string"===typeof c.valueObj.value1&&c.valueObj.value1.startsWith("{")&&c.valueObj.value1.endsWith("}"))c.isInteractive=!0},getFieldItemByName:function(c,f,l){this.fieldsStore.fetch({query:c,onComplete:d.hitch(this,
function(b){b&&b.length?f(b[0]):l()})})},subtractDay:function(c){return new Date(c.getTime()-this.dayInMS)},storeValue:function(c,d){if(c.startsWith("{")&&c.endsWith("}"))d.valueObj.value=c;else if(c.startsWith("'{")&&c.endsWith("}'"))d.valueObj.value=c.substring(1,c.length-1);else if("date"===d.fieldObj.shortType)if(c.startsWith("'")&&c.endsWith("'")){var l=c.substring(1,c.length-1);d.valueObj.value=this.parseDate(l)}else d.valueObj.value=c,d.valueObj.type="field";else"string"===d.fieldObj.shortType?
(c.startsWith("#")||c.startsWith("%#"))&&(c.endsWith("#")||c.endsWith("#%"))?d.valueObj.value=c:c.startsWith("'")&&c.endsWith("'")?d.valueObj.value=c.substring(1,c.length-1).replace(/\'\'/g,"'"):(d.valueObj.value=c,d.valueObj.type="field",this.getFieldItemByName({name:c},function(b){d.valueObj.label=b.label[0]},function(){d.error={msg:"unknown field name ("+c+")",code:1}})):(d.valueObj.value=c,isNaN(c)&&(d.valueObj.type="field",this.getFieldItemByName({name:c},function(b){d.valueObj.label=b.label[0]},
function(){d.error={msg:"unknown field name ("+c+")",code:1}})))},storeValue1:function(c,d){if(c.startsWith("{")&&c.endsWith("}"))d.valueObj.value1=c;else if(c.startsWith("'{")&&c.endsWith("}'"))d.valueObj.value1=c.substring(1,c.length-1);else if("date"===d.fieldObj.shortType)if(c.startsWith("'")&&c.endsWith("'")){var l=c.substring(1,c.length-1);d.valueObj.value1=this.parseDate(l)}else d.valueObj.value1=c,d.valueObj.type="field";else d.valueObj.value1=c,isNaN(c)&&(d.valueObj.type="field")},storeValue2:function(c,
d){if(c.startsWith("{")&&c.endsWith("}"))d.valueObj.value2=c;else if(c.startsWith("'{")&&c.endsWith("}'"))d.valueObj.value2=c.substring(1,c.length-1);else if("date"===d.fieldObj.shortType)if(c.startsWith("'")&&c.endsWith("'")){var l=c.substring(1,c.length-1);d.valueObj.value2=this.parseDate(l)}else d.valueObj.value2=c,d.valueObj.type="field";else d.valueObj.value2=c,isNaN(c)&&(d.valueObj.type="field")},parseDate:function(c){var d=f.parse(c,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});d||(d=
f.parse(c.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(d=f.parse(c.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return d}})})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),function(q,d,g,f,k,p,c){return d("dojo.data.ItemFileWriteStore",p,{constructor:function(d){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=
!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(d){return c.toISOString(d,{zulu:!0})});d&&!1===d.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(c){if(!c)throw Error("assertion failed in ItemFileWriteStore");},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(c,d){this._assert(!this._saveInProgress);
this._loadFinished||this._forceLoad();if("object"!=typeof c&&"undefined"!=typeof c)throw Error("newItem() was passed something other than an object");var b=null,r=this._getIdentifierAttribute();if(r===Number)b=this._arrayOfAllItems.length;else{b=c[r];if("undefined"===typeof b)throw Error("newItem() was not passed an identity for the new item");if(q.isArray(b))throw Error("newItem() was not passed an single-valued identity");}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[b]);
this._assert("undefined"===typeof this._pending._newItems[b]);this._assert("undefined"===typeof this._pending._deletedItems[b]);var m={};m[this._storeRefPropName]=this;m[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[b]=m,m[r]=[b]);this._arrayOfAllItems.push(m);r=null;if(d&&d.parent&&d.attribute){var r={item:d.parent,attribute:d.attribute,oldValue:void 0},f=this.getValues(d.parent,d.attribute);if(f&&0<f.length){var a=f.slice(0,f.length);r.oldValue=
1===f.length?f[0]:f.slice(0,f.length);a.push(m);this._setValueOrValues(d.parent,d.attribute,a,!1);r.newValue=this.getValues(d.parent,d.attribute)}else this._setValueOrValues(d.parent,d.attribute,m,!1),r.newValue=m}else m[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(m);this._pending._newItems[b]=m;for(var e in c){if(e===this._storeRefPropName||e===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");b=c[e];q.isArray(b)||(b=[b]);m[e]=b;if(this.referenceIntegrity)for(f=
0;f<b.length;f++)a=b[f],this.isItem(a)&&this._addReferenceToMap(a,m,e)}this.onNew(m,r);return m},_removeArrayElement:function(c,d){var b=g.indexOf(c,d);return-1!=b?(c.splice(b,1),!0):!1},deleteItem:function(c){this._assert(!this._saveInProgress);this._assertIsItem(c);var d=c[this._itemNumPropName],b=this.getIdentity(c);if(this.referenceIntegrity){var r=this.getAttributes(c);c[this._reverseRefMap]&&(c["backup_"+this._reverseRefMap]=q.clone(c[this._reverseRefMap]));g.forEach(r,function(a){g.forEach(this.getValues(c,
a),function(e){this.isItem(e)&&(c["backupRefs_"+this._reverseRefMap]||(c["backupRefs_"+this._reverseRefMap]=[]),c["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(e),attr:a}),this._removeReferenceFromMap(e,c,a))},this)},this);if(r=c[this._reverseRefMap])for(var m in r){var f=null;if(f=this._itemsByIdentity?this._itemsByIdentity[m]:this._arrayOfAllItems[m])for(var a in r[m]){var e=this.getValues(f,a)||[],n=g.filter(e,function(a){return!(this.isItem(a)&&this.getIdentity(a)==b)},this);this._removeReferenceFromMap(c,
f,a);n.length<e.length&&this._setValueOrValues(f,a,n,!0)}}}this._arrayOfAllItems[d]=null;c[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[b];this._pending._deletedItems[b]=c;c[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,c);this.onDelete(c);return!0},setValue:function(c,d,b){return this._setValueOrValues(c,d,b,!0)},setValues:function(c,d,b){return this._setValueOrValues(c,d,b,!0)},unsetAttribute:function(c,d){return this._setValueOrValues(c,
d,[],!0)},_setValueOrValues:function(c,d,b,r){this._assert(!this._saveInProgress);this._assertIsItem(c);this._assert(q.isString(d));this._assert("undefined"!==typeof b);var m=this._getIdentifierAttribute();if(d==m)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var m=this._getValueOrValues(c,d),f=this.getIdentity(c);if(!this._pending._modifiedItems[f]){var a={},e;for(e in c)a[e]=e===this._storeRefPropName||e===this._itemNumPropName||e===this._rootItemPropName?
c[e]:e===this._reverseRefMap?q.clone(c[e]):c[e].slice(0,c[e].length);this._pending._modifiedItems[f]=a}f=!1;if(q.isArray(b)&&0===b.length){if(f=delete c[d],b=void 0,this.referenceIntegrity&&m){e=m;q.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++)a=e[n],this.isItem(a)&&this._removeReferenceFromMap(a,c,d)}}else{f=q.isArray(b)?b.slice(0,b.length):[b];if(this.referenceIntegrity)if(m){e=m;q.isArray(e)||(e=[e]);var h={};g.forEach(e,function(a){this.isItem(a)&&(a=this.getIdentity(a),h[a.toString()]=!0)},
this);g.forEach(f,function(a){if(this.isItem(a)){var e=this.getIdentity(a);h[e.toString()]?delete h[e.toString()]:this._addReferenceToMap(a,c,d)}},this);for(n in h)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[n]:this._arrayOfAllItems[n],c,d)}else for(n=0;n<f.length;n++)a=f[n],this.isItem(a)&&this._addReferenceToMap(a,c,d);c[d]=f;f=!0}if(r)this.onSet(c,d,m,b);return f},_addReferenceToMap:function(c,d,b){d=this.getIdentity(d);var r=c[this._reverseRefMap];r||(r=c[this._reverseRefMap]=
{});(c=r[d])||(c=r[d]={});c[b]=!0},_removeReferenceFromMap:function(c,d,b){d=this.getIdentity(d);var r=c[this._reverseRefMap],m;if(r){for(m in r)m==d&&(delete r[m][b],this._isEmpty(r[m])&&delete r[m]);this._isEmpty(r)&&delete c[this._reverseRefMap]}},_dumpReferenceMap:function(){var c;for(c=0;c<this._arrayOfAllItems.length;c++){var d=this._arrayOfAllItems[c];d&&d[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(d)+"] is referenced by: "+f.toJson(d[this._reverseRefMap]))}},_getValueOrValues:function(c,
d){var b=void 0;this.hasAttribute(c,d)&&(b=this.getValues(c,d),b=1==b.length?b[0]:b);return b},_flatten:function(c){if(this.isItem(c))return{_reference:this.getIdentity(c)};if("object"===typeof c)for(var d in this._datatypeMap){var b=this._datatypeMap[d];if(q.isObject(b)&&!q.isFunction(b)){if(c instanceof b.type){if(!b.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+d+"]");return{_type:d,_value:b.serialize(c)}}}else if(c instanceof b)return{_type:d,_value:c.toString()}}return c},
_getNewFileContentString:function(){var c={},d=this._getIdentifierAttribute();d!==Number&&(c.identifier=d);this._labelAttr&&(c.label=this._labelAttr);c.items=[];for(d=0;d<this._arrayOfAllItems.length;++d){var b=this._arrayOfAllItems[d];if(null!==b){var r={},m;for(m in b)if(m!==this._storeRefPropName&&m!==this._itemNumPropName&&m!==this._reverseRefMap&&m!==this._rootItemPropName){var k=this.getValues(b,m);if(1==k.length)r[m]=this._flatten(k[0]);else for(var a=[],e=0;e<k.length;++e)a.push(this._flatten(k[e])),
r[m]=a}c.items.push(r)}}return f.toJson(c,!0)},_isEmpty:function(c){var d=!0;if(q.isObject(c))for(var b in c){d=!1;break}else q.isArray(c)&&0<c.length&&(d=!1);return d},save:function(c){this._assert(!this._saveInProgress);this._saveInProgress=!0;var d=this,b=function(){d._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};d._saveInProgress=!1;c&&c.onComplete&&c.onComplete.call(c.scope||k.global)},r=function(b){d._saveInProgress=!1;c&&c.onError&&c.onError.call(c.scope||k.global,b)};if(this._saveEverything){var m=
this._getNewFileContentString();this._saveEverything(b,r,m)}this._saveCustom&&this._saveCustom(b,r);!this._saveEverything&&!this._saveCustom&&b()},revert:function(){this._assert(!this._saveInProgress);for(var c in this._pending._modifiedItems){var d=this._pending._modifiedItems[c],b=null,b=this._itemsByIdentity?this._itemsByIdentity[c]:this._arrayOfAllItems[c];d[this._storeRefPropName]=this;for(var r in b)delete b[r];q.mixin(b,d)}var m;for(c in this._pending._deletedItems)m=this._pending._deletedItems[c],
m[this._storeRefPropName]=this,d=m[this._itemNumPropName],m["backup_"+this._reverseRefMap]&&(m[this._reverseRefMap]=m["backup_"+this._reverseRefMap],delete m["backup_"+this._reverseRefMap]),this._arrayOfAllItems[d]=m,this._itemsByIdentity&&(this._itemsByIdentity[c]=m),m[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(m);for(c in this._pending._deletedItems)m=this._pending._deletedItems[c],m["backupRefs_"+this._reverseRefMap]&&(g.forEach(m["backupRefs_"+this._reverseRefMap],function(b){this._addReferenceToMap(this._itemsByIdentity?
this._itemsByIdentity[b.id]:this._arrayOfAllItems[b.id],m,b.attr)},this),delete m["backupRefs_"+this._reverseRefMap]);for(c in this._pending._newItems)d=this._pending._newItems[c],d[this._storeRefPropName]=null,this._arrayOfAllItems[d[this._itemNumPropName]]=null,d[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,d),this._itemsByIdentity&&delete this._itemsByIdentity[c];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(c){return c?
(c=this.getIdentity(c),(new Boolean(this._pending._newItems[c]||this._pending._modifiedItems[c]||this._pending._deletedItems[c])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(c,d,b,r){},onNew:function(c,d){},onDelete:function(c){},close:function(c){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(q,d,g,f,k,p,c,s,l){g=g("dojo.data.ItemFileReadStore",[p],{constructor:function(b){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=b.url;this._jsonData=b.data;this.data=null;this._datatypeMap=b.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(b){return l.fromISOString(b)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==b.urlPreventCache&&(this.urlPreventCache=b.urlPreventCache?!0:!1);void 0!==b.hierarchical&&(this.hierarchical=b.hierarchical?
!0:!1);b.clearOnClose&&(this.clearOnClose=!0);"failOk"in b&&(this.failOk=b.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(b){if(!this.isItem(b))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(b){if("string"!==typeof b)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(b,c,d){b=this.getValues(b,c);return 0<b.length?b[0]:d},getValues:function(b,
c){this._assertIsItem(b);this._assertIsAttribute(c);return(b[c]||[]).slice(0)},getAttributes:function(b){this._assertIsItem(b);var c=[],d;for(d in b)d!==this._storeRefPropName&&(d!==this._itemNumPropName&&d!==this._rootItemPropName&&d!==this._reverseRefMap)&&c.push(d);return c},hasAttribute:function(b,c){this._assertIsItem(b);this._assertIsAttribute(c);return c in b},containsValue:function(b,d,m){var l=void 0;"string"===typeof m&&(l=c.patternToRegExp(m,!1));return this._containsValue(b,d,m,l)},_containsValue:function(b,
c,m,l){return f.some(this.getValues(b,c),function(a){if(null!==a&&!d.isObject(a)&&l){if(a.toString().match(l))return!0}else if(m===a)return!0})},isItem:function(b){return b&&b[this._storeRefPropName]===this&&this._arrayOfAllItems[b[this._itemNumPropName]]===b?!0:!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){this._assertIsItem(b.item)},getFeatures:function(){return this._features},getLabel:function(b){if(this._labelAttr&&this.isItem(b))return this.getValue(b,this._labelAttr)},
getLabelAttributes:function(b){return this._labelAttr?[this._labelAttr]:null},filter:function(b,d,m){var l=[],a,e;if(b.query){var n;a=b.queryOptions?b.queryOptions.ignoreCase:!1;var h={};for(e in b.query)n=b.query[e],"string"===typeof n?h[e]=c.patternToRegExp(n,a):n instanceof RegExp&&(h[e]=n);for(a=0;a<d.length;++a){var f=!0,k=d[a];if(null===k)f=!1;else for(e in b.query)n=b.query[e],this._containsValue(k,e,n,h[e])||(f=!1);f&&l.push(k)}}else for(a=0;a<d.length;++a)e=d[a],null!==e&&l.push(e);m(l,b)},
_fetchItems:function(b,c,m){var l=this;if(this._loadFinished)this.filter(b,this._getItemsArray(b.queryOptions),c);else if(this._jsonFileUrl!==this._ccUrl?(q.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:b,
filter:d.hitch(l,"filter"),findCallback:d.hitch(l,c)});else{this._loadInProgress=!0;var a=k.get({url:l._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});a.addCallback(function(a){try{l._getItemsFromLoadedData(a),l._loadFinished=!0,l._loadInProgress=!1,l.filter(b,l._getItemsArray(b.queryOptions),c),l._handleQueuedFetches()}catch(e){l._loadFinished=!0,l._loadInProgress=!1,m(e,b)}});a.addErrback(function(a){l._loadInProgress=!1;m(a,b)});var e=null;b.abort&&
(e=b.abort);b.abort=function(){a&&-1===a.fired&&a.cancel();e&&e.call(b)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,l.filter(b,this._getItemsArray(b.queryOptions),c)}catch(n){m(n,b)}else m(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),b)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var b=0;b<this._queuedFetches.length;b++){var c=this._queuedFetches[b],
d=c.args,l=c.filter,c=c.findCallback;l?l(d,this._getItemsArray(d.queryOptions),c):this.fetchItemByIdentity(d)}this._queuedFetches=[]}},_getItemsArray:function(b){return b&&b.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(b){this.clearOnClose&&(this._loadFinished&&!this._loadInProgress)&&((""==this._jsonFileUrl||null==this._jsonFileUrl)&&(""==this.url||null==this.url)&&null==this.data&&console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(b){function c(e){return null!==e&&"object"===typeof e&&(!d.isArray(e)||l)&&!d.isFunction(e)&&(e.constructor==Object||d.isArray(e))&&"undefined"===typeof e._reference&&"undefined"===typeof e._type&&"undefined"===typeof e._value&&a.hierarchical}function m(e){a._arrayOfAllItems.push(e);for(var b in e){var h=e[b];if(h)if(d.isArray(h))for(var n=
0;n<h.length;++n){var l=h[n];c(l)&&m(l)}else c(h)&&m(h)}}var l=!1,a=this;this._labelAttr=b.label;var e,n;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=b.items;for(e=0;e<this._arrayOfTopLevelItems.length;++e)n=this._arrayOfTopLevelItems[e],d.isArray(n)&&(l=!0),m(n),n[this._rootItemPropName]=!0;var h={},f;for(e=0;e<this._arrayOfAllItems.length;++e)for(f in n=this._arrayOfAllItems[e],n){if(f!==this._rootItemPropName){var k=n[f];null!==k?d.isArray(k)||(n[f]=[k]):n[f]=[null]}h[f]=f}for(;h[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;h[this._itemNumPropName];)this._itemNumPropName+="_";for(;h[this._reverseRefMap];)this._reverseRefMap+="_";if(h=b.identifier){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=h;for(e=0;e<this._arrayOfAllItems.length;++e)if(n=this._arrayOfAllItems[e],b=n[h],b=b[0],Object.hasOwnProperty.call(this._itemsByIdentity,b)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
h+"].  Value collided: ["+b+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+h+"].  Value collided: ["+b+"]");}else this._itemsByIdentity[b]=n}else this._features["dojo.data.api.Identity"]=Number;for(e=0;e<this._arrayOfAllItems.length;++e)n=this._arrayOfAllItems[e],n[this._storeRefPropName]=this,n[this._itemNumPropName]=e;for(e=0;e<this._arrayOfAllItems.length;++e)for(f in n=this._arrayOfAllItems[e],
n){b=n[f];for(h=0;h<b.length;++h)if(k=b[h],null!==k&&"object"==typeof k){if("_type"in k&&"_value"in k){var g=k._type,p=this._datatypeMap[g];if(p)if(d.isFunction(p))b[h]=new p(k._value);else if(d.isFunction(p.deserialize))b[h]=p.deserialize(k._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
g+"'");}if(k._reference){k=k._reference;if(d.isObject(k))for(g=0;g<this._arrayOfAllItems.length;++g){var p=this._arrayOfAllItems[g],s=!0,q;for(q in k)p[q]!=k[q]&&(s=!1);s&&(b[h]=p)}else b[h]=this._getItemByIdentity(k);this.referenceIntegrity&&(k=b[h],this.isItem(k)&&this._addReferenceToMap(k,n,f))}else this.isItem(k)&&this.referenceIntegrity&&this._addReferenceToMap(k,n,f)}}},_addReferenceToMap:function(b,c,d){},getIdentity:function(b){var c=this._features["dojo.data.api.Identity"];return c===Number?
b[this._itemNumPropName]:(b=b[c])?b[0]:null},fetchItemByIdentity:function(b){var c,d;if(this._loadFinished)c=this._getItemByIdentity(b.identity),b.onItem&&(d=b.scope?b.scope:q.global,b.onItem.call(d,c));else{var l=this;this._jsonFileUrl!==this._ccUrl?(q.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:b}):(this._loadInProgress=!0,d=k.get({url:l._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),d.addCallback(function(a){var e=b.scope?b.scope:q.global;try{l._getItemsFromLoadedData(a),l._loadFinished=!0,l._loadInProgress=!1,c=l._getItemByIdentity(b.identity),b.onItem&&b.onItem.call(e,c),l._handleQueuedFetches()}catch(d){l._loadInProgress=
!1,b.onError&&b.onError.call(e,d)}}),d.addErrback(function(a){l._loadInProgress=!1;b.onError&&b.onError.call(b.scope?b.scope:q.global,a)})):this._jsonData&&(l._getItemsFromLoadedData(l._jsonData),l._jsonData=null,l._loadFinished=!0,c=l._getItemByIdentity(b.identity),b.onItem&&(d=b.scope?b.scope:q.global,b.onItem.call(d,c)))}},_getItemByIdentity:function(b){var c=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,b)&&(c=this._itemsByIdentity[b]):Object.hasOwnProperty.call(this._arrayOfAllItems,
b)&&(c=this._arrayOfAllItems[b]);void 0===c&&(c=null);return c},getIdentityAttributes:function(b){b=this._features["dojo.data.api.Identity"];return b===Number?null:[b]},_forceLoad:function(){var b=this;this._jsonFileUrl!==this._ccUrl?(q.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var c=k.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});c.addCallback(function(c){try{if(!0!==b._loadInProgress&&!b._loadFinished)b._getItemsFromLoadedData(c),b._loadFinished=!0;else if(b._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(d){throw console.log(d),d;}});c.addErrback(function(b){throw b;
})}else this._jsonData&&(b._getItemsFromLoadedData(b._jsonData),b._jsonData=null,b._loadFinished=!0)}});d.extend(g,s);return g})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(q){var d={};q.setObject("dojo.data.util.filter",d);d.patternToRegExp=function(d,f){for(var k="^",p=null,c=0;c<d.length;c++)switch(p=d.charAt(c),p){case "\\":k+=p;c++;k+=d.charAt(c);break;case "*":k+=".*";break;case "?":k+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":k+=
"\\";default:k+=p}k+="$";return f?RegExp(k,"mi"):RegExp(k,"m")};return d})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(q,d,g){var f={};q.setObject("dojo.data.util.simpleFetch",f);f.errorHandler=function(f,g){g.onError&&g.onError.call(g.scope||d.global,f,g)};f.fetchHandler=function(f,p){var c=p.abort||null,s=!1,l=p.start?p.start:0,b=p.count&&Infinity!==p.count?l+p.count:f.length;p.abort=function(){s=!0;c&&c.call(p)};var r=p.scope||d.global;
p.store||(p.store=this);p.onBegin&&p.onBegin.call(r,f.length,p);p.sort&&f.sort(g.createSortFunction(p.sort,this));if(p.onItem)for(var m=l;m<f.length&&m<b;++m){var t=f[m];s||p.onItem.call(r,t,p)}p.onComplete&&!s&&(m=null,p.onItem||(m=f.slice(l,b)),p.onComplete.call(r,m,p))};f.fetch=function(d){d=d||{};d.store||(d.store=this);this._fetchItems(d,q.hitch(this,"fetchHandler"),q.hitch(this,"errorHandler"));return d};return f})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(q){var d=
{};q.setObject("dojo.data.util.sorter",d);d.basicComparator=function(d,f){var k=-1;null===d&&(d=void 0);null===f&&(f=void 0);if(d==f)k=0;else if(d>f||null==d)k=1;return k};d.createSortFunction=function(g,f){function k(b,a,e,c){return function(h,d){var m=c.getValue(h,b),l=c.getValue(d,b);return a*e(m,l)}}for(var p=[],c,s=f.comparatorMap,l=d.basicComparator,b=0;b<g.length;b++){c=g[b];var r=c.attribute;if(r){c=c.descending?-1:1;var m=l;s&&("string"!==typeof r&&"toString"in r&&(r=r.toString()),m=s[r]||
l);p.push(k(r,c,m,f))}}return function(b,a){for(var e=0;e<p.length;){var c=p[e++](b,a);if(0!==c)return c}return 0}};return d})},"jimu/DataManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","./WidgetManager"],function(q,d,g,f){var k=null,p;p=q(null,{constructor:function(){g.subscribe("publishData",d.hitch(this,this.onDataPublished));g.subscribe("fetcheData",d.hitch(this,this.onFetchData));g.subscribe("clearAllData",d.hitch(this,this.onClearAllData));g.subscribe("removeData",
d.hitch(this,this.onRemoveData));this.widgetManager=f.getInstance()},_dataStore:{},onDataPublished:function(c,f,l,b){"undefined"===typeof b&&(b=!0);d.isArray(l)||(l=[l]);this._dataStore[f]=this._dataStore[f]&&b||!this._dataStore[f]?l:this._dataStore[f].concat(l)},onFetchData:function(c){var d;if(c)(d=this.widgetManager.getWidgetById(c))?this._dataStore[c]?g.publish("dataFetched",d.name,c,this._dataStore[c]):g.publish("noData",d.name,c):g.publish("noData",void 0,c);else for(var l in this._dataStore)d=
this.widgetManager.getWidgetById(l),g.publish("dataFetched",d.name,l,this._dataStore[l])},onClearAllData:function(){this._dataStore={};g.publish("allDataCleared")},onRemoveData:function(c){delete this._dataStore[c];g.publish("dataRemoved",c)}});p.getInstance=function(){null===k&&(k=new p);return k};return p})},"jimu/PoolControllerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/aspect dojo/Deferred jimu/WidgetManager jimu/PanelManager".split(" "),
function(q,d,g,f,k,p,c,s,l){return q(null,{constructor:function(){this.widgetManager=s.getInstance();this.panelManager=l.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(b){},getConfigById:function(b){for(var c=this.getAllConfigs(),d=0;d<c.length;d++)if(c[d].id===b)return c[d]},getAllConfigs:function(){var b=[],b=b.concat(this.getWidgetConfigs(),this.getGroupConfigs()),
b=g.filter(b,function(b){return b.visible});return b.sort(function(b,c){return b.index-c.index})},isControlled:function(b){return g.some(this.getAllConfigs(),function(c){return c.id===b})},widgetIsControlled:function(b){return g.some(this.getAllConfigs(),function(c){return c.id===b?!0:g.some(c.widgets,function(c){return c.id===b})})},getGroupConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.groups&&g.forEach(this.appConfig.widgetPool.groups,function(c){this.controlledGroups&&
(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(c.label)&&b.push(c):"all"===this.controlledGroups&&b.push(c))},this);return b},getWidgetConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.widgets&&g.forEach(this.appConfig.widgetPool.widgets,function(c){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(c.label)&&b.push(c):"all"===this.controlledWidgets&&b.push(c))},this);return b}})})},"jimu/SpatialReference/utils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request ./unitUtils".split(" "),
function(q,d,g,f,k,p,c){var s=null,l=null,b=!1;q=q(null,function(){});var r=require.toUrl("jimu"),m=p(r+"/SpatialReference/wkidDetails.json",{handleAs:"json"}),t=p(r+"/SpatialReference/transform.json",{handleAs:"json"});q.loadResource=function(){var a=new f;if(s&&l)return a.resolve(),a;k([m,t]).then(function(e){s=e[0];l=e[1];b=!0;a.resolve()},function(e){console.error(e);b=!1;a.reject(e)});return a};q.getAllCSUnits=function(){if(b){var a=[];g.forEach(s.wkids,d.hitch(this,function(e){e=this.getCSUnit(e);
-1===g.indexOf(a,e)&&a.push(e)}));return a}};q.convertUnit=function(a,e,d){if(b)return c.convertUnit(a,e,d)};q.getUnitRate=function(a,e){if(b)return c.getUnitRate(a,e)};q.isProjectUnit=function(a){if(b)return c.isProjectUnit(a)};q.isGeographicUnit=function(a){if(b)return c.isGeographicUnit(a)};q.getGeographicUnits=function(){if(b)return c.getGeographicUnits()};q.getProjectUnits=function(){if(b)return c.getProjectUnits()};q.getCSUnit=function(a){if(b){a=this.getCSStr(a);var e=0,c=0,e=a.lastIndexOf("UNIT"),
c=a.indexOf(",",e);return a.slice(e+6,c-1)}};q.isSameSR=function(a,e){if(b){var c=this.indexOfWkid(a),h=this.indexOfWkid(e);return s.labels[c]===s.labels[h]}};q.isValidWkid=function(a){if(b)return-1<this.indexOfWkid(a)};q.getSRLabel=function(a){if(b&&this.isValidWkid(a))return a=this.indexOfWkid(a),s.labels[a]};q.indexOfWkid=function(a){if(b)return g.indexOf(s.wkids,a)};q.isValidTfWkid=function(a){if(b)return-1<this.indexOfTfWkid(a)};q.getTransformationLabel=function(a){if(b)return this.isValidTfWkid(a)?
(a=this.indexOfTfWkid(a),l.labels[a]):""};q.indexOfTfWkid=function(a){if(b)return g.indexOf(l.tfWkids,a)};q.isGeographicCS=function(a){if(b)return this.isValidWkid(a)?s.details[this.indexOfWkid(a)].startWith("GEOGCS"):!1};q.isProjectedCS=function(a){if(b)return this.isValidWkid(a)?s.details[this.indexOfWkid(a)].startWith("PROJCS"):!1};q.getGeoCSByProj=function(a){if(b&&this.isProjectedCS(a))return a=this.getSpheroidStr(a),a=g.indexOf(s.details,a),s.wkids[a]};q.getSpheroidStr=function(a){if(b){if(this.isGeographicCS(a))return s.details[this.indexOfWkid(a)];
if(this.isProjectedCS(a)){a=s.details[this.indexOfWkid(a)];var e=a.indexOf("GEOGCS"),c=a.indexOf("PROJECTION")-1;return a.slice(e,c)}return null}};q.getCSStr=function(a){if(b)return s.details[this.indexOfWkid(a)]};q.isSameSpheroid=function(a,e){if(b){var c=this.getSpheroidStr(a),h=this.getSpheroidStr(e);return c&&h&&c===h?!0:!1}};return q})},"jimu/SpatialReference/unitUtils":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(q,d,g){var f="INCHES FOOT FOOT_US YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS METER KILOMETERS DECIMETERS LINK_CLARKE FOOT_GOLD_COAST FOOT_CLARKE CHAIN_SEARS_1992_TRUNCATED YARD_INDIAN CHAIN_BENOIT_1895_B YARD_SEARS CHAIN_SEARS FOOT_SEARS YARD_INDIAN_1937 50_KILOMETERS 150_KILOMETERS".split(" "),
k="DECIMAL_DEGREES DEGREE_MINUTE_SECONDS DEGREE GRAD MGRS USNG".split(" "),p={INCHES:0.0254,FOOT:0.3048,FOOT_US:0.3048006096012192,YARDS:0.9144,MILES:1609.344,NAUTICAL_MILES:1852,MILLIMETERS:0.001,CENTIMETERS:0.01,METER:1,KILOMETERS:1E3,DECIMETERS:0.1,LINK_CLARKE:0.2011661949,FOOT_GOLD_COAST:0.3047997101815088,FOOT_CLARKE:0.304797265,CHAIN_SEARS_1922_TRUNCATED:20.116756,YARD_INDIAN:0.9143985307444408,CHAIN_BENOIT_1895_B:20.11678249437587,YARD_SEARS:0.9143984146160287,CHAIN_SEARS:20.11676512155263,
FOOT_SEARS:0.3047994715386762,YARD_INDIAN_1937:0.91439523,"50_KILOMETERS":5E4,"150_KILOMETERS":15E4,DEGREE:0.0174532925199433,DECIMAL_DEGREES:0.0174532925199433,MGRS:0.0174532925199433,USNG:0.0174532925199433,DEGREE_MINUTE_SECONDS:0.0174532925199433,GRAD:0.01570796326794897};q=q(null,function(){});q.convertUnit=function(c,d,l){return p[c.toUpperCase()]/p[d.toUpperCase()]*l};q.getUnitRate=function(c,d){return p[c.toUpperCase()]/p[d.toUpperCase()]};q.isProjectUnit=function(c){return-1<g.indexOf(f,c.toUpperCase())};
q.isGeographicUnit=function(c){return-1<g.indexOf(k,c.toUpperCase())};q.getGeographicUnits=function(){return k};q.getProjectUnits=function(){return f};return q})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/aspect dojo/Deferred dojo/on dojo/topic dojo/_base/unload dojo/Evented esri/layers/WMSLayer esri/layers/GeoRSSLayer esri/layers/KMLLayer esri/layers/FeatureLayer ./LayerInfoForCollection ./LayerInfoForMapService ./LayerInfoForKML ./LayerInfoForGeoRSS ./LayerInfoForDefault ./LayerInfoForWMS ./LayerInfoFactory".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B){var y=[],w=q([l],{operLayers:null,map:null,finalLayerInfos:null,basemapLayers:null,constructor:function(a,e,b){this.basemapLayers=a;this.operLayers=e;this.map=b;this.finalLayerInfos=[];this._initLayerInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this.layerInfos);this._initFinalLayerInfos(this.layerInfos);this._markFirstOrLastNode()},getLayerInfoArray:function(){return this.finalLayerInfos},
traversal:function(a){d.forEach(this.getLayerInfoArray(),function(e){e.traversal(a)})},moveUpLayer:function(a){var e=null,b;a=this._getTopLayerInfoIndexById(a);0<a&&(e=this.finalLayerInfos[a-1].obtainLayerIndexesInMap().length,this.finalLayerInfos[a].moveRightOfIndex(this.finalLayerInfos[a-1].obtainLayerIndexesInMap()[e-1].index),e=this.finalLayerInfos[a-1].id,b=this.finalLayerInfos[a],this.finalLayerInfos.splice(a,1),this.finalLayerInfos.splice(a-1,0,b),this._markFirstOrLastNode());return e},moveDownLayer:function(a){var e=
null,b=this._getTopLayerInfoIndexById(a);b<this.finalLayerInfos.length-1&&(this.finalLayerInfos[b].moveLeftOfIndex(this.finalLayerInfos[b+1].obtainLayerIndexesInMap()[0].index),e=this.finalLayerInfos[b+1].id,a=this.finalLayerInfos[b+1],this.finalLayerInfos.splice(b+1,1),this.finalLayerInfos.splice(b,0,a),this._markFirstOrLastNode());return e},_initLayerInfos:function(){var a,e=[];d.forEach(this.operLayers,function(b){try{a=B.getInstance().create(b),a.init()}catch(c){console.warn(c.message),a=null}a&&
e.push(a)},this);this.layerInfos=e},_extraSetLayerInfos:function(){d.forEach(this.layerInfos,function(a,e){var b;if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{b=B.getInstance().create(a.originOperLayer),b.init()}catch(c){console.warn(c.message),b=null}b&&(this.layerInfos[e]=b)}},this)},_initFinalLayerInfos:function(a){var e,b;this.finalLayerInfos.length=0;for(e=this.map.graphicsLayerIds.length-1;0<=e;e--)b=this.map.graphicsLayerIds[e],
this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!0);for(e=this.map.layerIds.length-1;0<=e;e--)b=this.map.layerIds[e],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!1)},_isBasemap:function(a){var e=!1,b=[];d.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);("basemap"===a._basemapGalleryLayerType||"reference"===a._basemapGalleryLayerType)&&b.push(a)},this);0===b.length&&(b=this.basemapLayers);
for(var c=0;c<b.length;c++)b[c].id===a&&(e=!0);return e},_addToFinalLayerInfos:function(a,e,b){var c;if(a)!a._addedFlag&&a.isGraphicLayer()===b&&(this.finalLayerInfos.push(a),a._addedFlag=!0);else if(a=this.map.getLayer(e),"esri.layers.GraphicsLayer"!==a.declaredClass){try{c=B.getInstance().create({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "},this.map),c.init()}catch(h){console.warn(h.message),c=null}c&&this.finalLayerInfos.push(c)}},_findLayerInfoByIdAndReturnTopLayer:function(a,
e){var b,c=null;e||(e=this.finalLayerInfos);for(b=0;b<e.length;b++)if(c=e[b].findLayerInfoById(a)){c=e[b];break}return c},_findTopLayerInfoById:function(a){var e,b=null,c=this.finalLayerInfos;for(e=0;e<c.length;e++)if(c[e].id===a){b=c[e];break}return b},_getTopLayerInfoIndexById:function(a){var e,b=-1;for(e=0;e<this.finalLayerInfos.length;e++)if(this.finalLayerInfos[e].id===a){b=e;break}return b},_clearAddedFlag:function(a){d.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;
if(this.finalLayerInfos.length){for(a=0;a<this.finalLayerInfos.length;a++)this.finalLayerInfos[a].isFirst=!1,this.finalLayerInfos[a].isLast=!1;this.finalLayerInfos[0].isFirst=!0;this.finalLayerInfos[this.finalLayerInfos.length-1].isLast=!0;for(a=0;a<this.finalLayerInfos.length;a++)if(!this.finalLayerInfos[a].isGraphicLayer()){a&&(this.finalLayerInfos[a-1].isLast=!0);this.finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,e,b){"BasemapGallery"===a&&(this.basemapLayers.length=
0,d.forEach(b,g.hitch(this,function(a){this.basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var e;for(e=this.basemapLayers.length=0;e<a.layers.length;e++)this.basemapLayers.push({layerObject:a.layer[e],id:a.layers[e].id})},_bindEvents:function(){var a,e,b,h;a=p(this.map,"layer-add-result",g.hitch(this,this._onLayersChange,"added"));e=p(this.map,"layer-remove",g.hitch(this,this._onLayersChange,"removed"));h=c.subscribe("layerInfos/layerInfo/isShowInMapChanged",
g.hitch(this,this._onShowInMapChanged));b=p(this.map,"before-unload",g.hitch(this,function(){a.remove();e.remove();h.remove()}));s.addOnUnload(function(){a.remove();e.remove();b.remove();h.remove()})},_onLayersChange:function(a,e){var b=null;!e.error&&("esri.layers.GraphicsLayer"!==e.layer.declaredClass&&!e.layer._basemapGalleryLayerType)&&("added"===a?(this.update(),b=this._findTopLayerInfoById(e.layer.id)):(b=this._findTopLayerInfoById(e.layer.id),this.update()),this.emit("layerInfosChanged",b,
a))},_onShowInMapChanged:function(a){this.emit("layerInfosIsShowInMapChanged",a)}});w.create=function(a,e){var b=new k;B.getInstance(a).init().then(g.hitch(this,function(){var c=new w(e.itemData.baseMap.baseMapLayers,e.itemData.operationalLayers,a);b.resolve(c)}));return b};w.getInstance=function(a,e){var b=new k,c,h=null;for(c=0;c<y.length;c++)if(y[c].map===a){h=y[c].layerInfos;break}h?b.resolve(h):B.getInstance(a).init().then(g.hitch(this,function(){var c=new w(e.itemData.baseMap.baseMapLayers,
e.itemData.operationalLayers,a);y.push({map:a,layerInfos:c});b.resolve(c)}));return b};return w})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t){return g([m],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,
4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],
[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,e){var b=l.urlToObject(a);if(b.query&&(b.query.version||b.query.Version||b.query.VERSION))this.version=b.query.version||b.query.Version||b.query.VERSION;this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));
this._url=l.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=f.hitch(this,this._initLayer);this._parseCapabilities=f.hitch(this,this._parseCapabilities);this._getCapabilitiesError=f.hitch(this,this._getCapabilitiesError);e?(this.imageFormat=this._getImageFormat(e.format),this.imageTransparency=!1!==e.transparent,this.visibleLayers=e.visibleLayers?e.visibleLayers:[],this.version=e.version||this.version,e.resourceInfo?this._readResourceInfo(e.resourceInfo):this._getCapabilities()):(this.imageFormat=
"image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=q.toUrl("../images/pixel.png")},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},getImageUrl:function(a,e,b,c){if(!this.visibleLayers||0===this.visibleLayers.length)c(this._blankImageURL);
else{var d=a.spatialReference.wkid;-1===k.indexOf(this.spatialReferences,d)&&a.spatialReference.latestWkid&&(d=a.spatialReference.latestWkid);if(k.some(this._WEB_MERCATOR,function(a){return a==d})){var m=k.filter(this.spatialReferences,function(a){return k.some(this._WEB_MERCATOR,function(e){return e==a})},this);0===m.length&&(m=k.filter(this.spatialReferences,function(a){return k.some(this._WORLD_MERCATOR,function(e){return e==a})},this));d=0<m.length?m[0]:this._WEB_MERCATOR[0]}this.spatialReferences=
k.filter(this.spatialReferences,function(a){return a!==d});this.spatialReferences.unshift(d);var m=a.xmin,f=a.xmax,r=a.ymin,g=a.ymax;a={SERVICE:"WMS",REQUEST:"GetMap"};a.FORMAT=this.imageFormat;a.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";a.STYLES="";a.VERSION=this.version;a.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;a.WIDTH=e;a.HEIGHT=b;this.maxWidth<e&&(a.WIDTH=this.maxWidth);this.maxHeight<b&&(a.HEIGHT=this.maxHeight);e=d?d:NaN;isNaN(e)||("1.3.0"==this.version?a.CRS="EPSG:"+
e:a.SRS="EPSG:"+e);"1.3.0"==this.version&&this._useLatLong(e)?a.BBOX=r+","+m+","+g+","+f:a.BBOX=m+","+r+","+f+","+g;e=this.getMapURL;var p;e+=-1==e.indexOf("?")?"?":"";for(p in a)a.hasOwnProperty(p)&&(e+="?"==e.substring(e.length-1,e.length)?"":"\x26",e+=p+"\x3d"+a[p]);c(l.addProxy(e))}},_initLayer:function(a,e){this.spatialReference=new b(this.extent.spatialReference);this.initialExtent=new r(this.extent);this.fullExtent=new r(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);
this.loaded=!0;this.onLoad(this);var c=this._loadCallback;c&&(delete this._loadCallback,c(this))},_readResourceInfo:function(a){a.extent?a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=
a.maxHeight?a.maxHeight:5E3,this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this._initLayer()):console.error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo"):console.error("esri.layers.WMSLayer: unable to find the 'extent' property in resourceInfo")},_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";
this.version&&(a.VERSION=this.version);var e=this._url.path+"?",b;for(b in a)a.hasOwnProperty(b)&&(e+="?"==e.substring(e.length-1,e.length)?"":"\x26",e+=b+"\x3d"+a[b]);s({url:e,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(a){this.version=this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));
var e=this._getTag("Service",a);this.title=this._getTagValue("Title",e,"");this.title||(this.title=this._getTagValue("Name",e,""));this.copyright=this._getTagValue("AccessConstraints",e,"");this.description=this._getTagValue("Abstract",e,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",e,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",e,5E3),10);if(e=this._getTag("Layer",a)){var b=this._getLayerInfo(e),c=0,m=null,e=this._getTag("Capability",a);k.forEach(e.childNodes,function(a){"Layer"==
a.nodeName&&(0===c?m=a:(1===c&&b.name&&(b.name="",b.subLayers=[],b.subLayers.push(this._getLayerInfo(m))),b.subLayers.push(this._getLayerInfo(a))),c++)},this);if(b){this.layerInfos=b.subLayers;if(!this.layerInfos||0===this.layerInfos.length)this.layerInfos=[b];this.extent=b.extent;this.extent||(b.extent=new r(this.layerInfos[0].extent.toJson()),this.extent=b.extent);this.allExtents=b.allExtents;if(!this.allExtents||!this.allExtents.length)b.allExtents=[],k.forEach(this.layerInfos[0].allExtents,function(a,
e){a&&(b.allExtents[e]=new r(a.toJson()))}),this.allExtents=b.allExtents;this.spatialReferences=b.spatialReferences;0===this.spatialReferences.length&&0<this.layerInfos.length&&(this.spatialReferences=this.layerInfos[0].spatialReferences)}this.getMapURL=this._getCapabilitiesURL;if((e=d.query("DCPType",this._getTag("GetMap",a)))&&0<e.length)if((e=d.query("HTTP",e[0]))&&0<e.length)if((e=d.query("Get",e[0]))&&0<e.length)if(e=this._getAttributeValue("OnlineResource","xlink:href",e[0],null))e.indexOf("\x26")==
e.length-1&&(e=e.substring(0,e.length-1)),this.getMapURL=e;this.getMapFormats=[];0===d.query("Operation",a).length?k.forEach(d.query("Format",this._getTag("GetMap",a)),function(a){this.getMapFormats.push(a.text?a.text:a.textContent)},this):k.forEach(d.query("Operation",a),function(a){"GetMap"==a.getAttribute("name")&&k.forEach(d.query("Format",a),function(a){this.getMapFormats.push(a.text?a.text:a.textContent)},this)},this);k.some(this.getMapFormats,function(a){return-1<a.indexOf(this.imageFormat)},
this)||(this.imageFormat=this.getMapFormats[0]);this._initLayer()}else this._getCapabilitiesError({error:{message:"Response does not contain any layers."}})}else this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)")},_getCapabilitiesError:function(a){this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed.",a)},_getLayerInfo:function(a){if(!a)return null;var e=new t;e.name="";e.title="";e.description="";e.allExtents=[];e.spatialReferences=
[];e.subLayers=[];var c=this._getTag("LatLonBoundingBox",a);c&&(e.allExtents[0]=this._getExtent(c,4326));var h=this._getTag("EX_GeographicBoundingBox",a),d;h&&(d=new r(0,0,0,0,new b({wkid:4326})),d.xmin=parseFloat(this._getTagValue("westBoundLongitude",h,0)),d.ymin=parseFloat(this._getTagValue("southBoundLatitude",h,0)),d.xmax=parseFloat(this._getTagValue("eastBoundLongitude",h,0)),d.ymax=parseFloat(this._getTagValue("northBoundLatitude",h,0)),e.allExtents[0]=d);!c&&!h&&(d=new r(-180,-90,180,90,new b({wkid:4326})),
e.allExtents[0]=d);e.extent=e.allExtents[0];var m=-1<k.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";k.forEach(a.childNodes,function(a){if("Name"==a.nodeName)e.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)e.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)e.description=(a.text?a.text:a.textContent)||"";else if("BoundingBox"==a.nodeName){var b=a.getAttribute(m);b&&0===b.indexOf("EPSG:")?(b=parseInt(b.substring(5),10),0!==b&&!isNaN(b)&&(a="1.3.0"==
this.version?this._getExtent(a,b,this._useLatLong(b)):this._getExtent(a,b),e.allExtents[b]=a,e.extent||(e.extent=a))):b&&0===b.indexOf("CRS:")?(b=parseInt(b.substring(4),10),0!==b&&!isNaN(b)&&(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),e.allExtents[b]=this._getExtent(a,b))):(b=parseInt(b,10),0!==b&&!isNaN(b)&&(e.allExtents[b]=this._getExtent(a,b)))}else if(a.nodeName==m)a=(a.text?a.text:a.textContent).split(" "),k.forEach(a,function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,
10);0!==a&&!isNaN(a)&&(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==k.indexOf(e.spatialReferences,a)&&e.spatialReferences.push(a))},this);else if("Style"==a.nodeName){if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))e.legendURL=a.getAttribute("xlink:href")}else"Layer"===a.nodeName&&e.subLayers.push(this._getLayerInfo(a))},this);e.title=e.title||e.name;return e},_getImageFormat:function(a){switch(a?a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";
case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,e,c){var h;if(a){h=new r;var d=parseFloat(a.getAttribute("minx")),m=parseFloat(a.getAttribute("miny")),l=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));
c?(h.xmin=isNaN(m)?-1*Number.MAX_VALUE:m,h.ymin=isNaN(d)?-1*Number.MAX_VALUE:d,h.xmax=isNaN(a)?Number.MAX_VALUE:a,h.ymax=isNaN(l)?Number.MAX_VALUE:l):(h.xmin=isNaN(d)?-1*Number.MAX_VALUE:d,h.ymin=isNaN(m)?-1*Number.MAX_VALUE:m,h.xmax=isNaN(l)?Number.MAX_VALUE:l,h.ymax=isNaN(a)?Number.MAX_VALUE:a);h.spatialReference=new b({wkid:e})}return h},_useLatLong:function(a){var e,b;for(b=0;b<this._REVERSED_LAT_LONG_RANGES.length;b++){var c=this._REVERSED_LAT_LONG_RANGES[b];if(a>=c[0]&&a<=c[1]){e=!0;break}}return e},
_getTag:function(a,e){var b=d.query(a,e);return b&&0<b.length?b[0]:null},_getTagValue:function(a,e,b){return(a=d.query(a,e))&&0<a.length?a[0].text?a[0].text:a[0].textContent:b},_getAttributeValue:function(a,e,b,c){return(a=d.query(a,b))&&0<a.length?a[0].getAttribute(e):c},_checkVisibleLayersList:function(a){if(a&&(0<a.length&&this.layerInfos&&0<this.layerInfos.length)&&"number"==typeof a[0]){var e=[];k.forEach(a,function(a){a<this.layerInfos.length&&e.push(this.layerInfos[a].name)},this);a=e}return a},
_stripParameters:function(a,e){var b=l.urlToObject(a),c,d=[];for(c in b.query)b.query.hasOwnProperty(c)&&-1===k.indexOf(e,c.toLowerCase())&&d.push(c+"\x3d"+b.query[c]);return b.path+(d.length?"?"+d.join("\x26"):"")}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(q,d,g,f,k){return q(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],
allExtents:[],spatialReferences:[],constructor:function(d){d&&(this.name=d.name,this.title=d.title,this.description=d.description,this.extent=d.extent,this.legendURL=d.legendURL,this.subLayers=d.subLayers?d.subLayers:[],this.allExtents=d.allExtents?d.allExtents:[],this.spatialReferences=d.spatialReferences?d.spatialReferences:[])},clone:function(){var d={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},c;this.extent&&(d.extent=this.extent.getExtent());d.subLayers=
[];g.forEach(this.subLayers,function(c){d.subLayers.push(c.clone())});d.allExtents=[];for(c in this.allExtents)c=parseInt(c,10),isNaN(c)||(d.allExtents[c]=this.allExtents[c].getExtent());d.spatialReferences=[];g.forEach(this.spatialReferences,function(c){d.spatialReferences.push(c)});return d}})})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ./ServiceGeneratedFeatureCollection".split(" "),function(q,d,g,f,
k,p,c,s){return q([s],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:location.protocol+"//utility.arcgis.com/sharing/rss",constructor:function(c,b){p.defaults.geoRSSService&&(this.serviceUrl=p.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=c({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?g.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(c){this.inherited(arguments);this.loaded||
(this.loaded=!0,this.onLoad(this))}})})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e){return q([t],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",
constructor:function(a,e){this.pointSymbol=e&&e.pointSymbol;this.polylineSymbol=e&&e.polylineSymbol;this.polygonSymbol=e&&e.polygonSymbol;this._outSR=e&&(e.outSpatialReference||e.outSR)||new l({wkid:4326});this._options=g.mixin({},e)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var a=[];this._fLayers&&(a=a.concat(this._fLayers));return a},onRefresh:function(){},onOpacityChange:function(){},refresh:function(){this.loaded&&(this._map&&!this._io&&
this.visible)&&this._createLayer()},_createLayer:function(a){var e=this;this._fireUpdateStart();a=this.parse(a);a.addCallback(function(a){e._io=null;e._initLayer(a)});a.addErrback(function(a){e._io=null;a=g.mixin(Error(),a);a.message="Unable to load resource: "+e.url+" "+(a.message||"");e._fireUpdateEnd(a);e.onError(a)})},_initLayer:function(c){this.loaded&&this._removeInternalLayers();this.name=c.name;this.description=c.description;this.snippet=c.snippet;this.defaultVisibility=void 0!==c.visibility?
this.visible=!!c.visibility:this.visible=!0;this.featureInfos=c.featureInfos;this.fullExtent=this.initialExtent=new b(c.lookAtExtent);this.copyright=c.author||c.copyright;var h;if((c=g.getObject("featureCollection.layers",!1,c))&&0<c.length)this._fLayers=[],f.forEach(c,function(b,c){var d=g.getObject("featureSet.features",!1,b);d&&0<d.length&&(h=g.mixin({outFields:["*"],infoTemplate:b.popupInfo?new e(b.popupInfo):null,editable:!1},this._options),h.id&&(h.id=h.id+"_"+c),b.layerDefinition.capabilities=
"Query,Data",d=new a(b,h),d.geometryType&&(this["_"+d.geometryType]=d),this._fLayers.push(d))},this),0===this._fLayers.length&&delete this._fLayers;this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(c=new m(this.pointSymbol),this._esriGeometryPoint.setRenderer(c)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(c=new m(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(c)));
this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(c=new m(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(c)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();var e=a.spatialReference,b=this._outSR,c;if(e.wkid)c=e._isWebMercator()&&b._isWebMercator()||e.wkid===b.wkid;else if(e.wkt)c=e.wkt===b.wkt;else{console.log("_setMap - map has invalid spatial reference");
return}if(!c)if(e._isWebMercator()&&4326===b.wkid)this._converter=r.geographicToWebMercator;else if(b._isWebMercator()&&4326===e.wkid)this._converter=r.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(e=this._fLayers)&&0<e.length&&f.forEach(e,function(e){if(this._converter){var b=e.graphics,c,d,h=b?b.length:0;for(c=0;c<h;c++)(d=b[c].geometry)&&b[c].setGeometry(this._converter(d))}a.addLayer(e)},
this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var a=this._map;a&&f.forEach(this.getFeatureLayers(),a.removeLayer,a)},setScaleRange:function(a,e){this.inherited(arguments);f.forEach(this.getFeatureLayers(),function(b){b.setScaleRange(a,e)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(f.forEach(this.getFeatureLayers(),function(e){e.setOpacity(a)}),this.opacity=this._options.opacity=
a,this.onOpacityChange(a))},onVisibilityChange:function(a){this._fireUpdateStart();f.forEach(this.getFeatureLayers(),function(e){e.setVisibility(a)});this._fireUpdateEnd()},_setMap:function(a,e){this.inherited(arguments);this._map=a;var b=this._div=k.create("div",null,e);p.set(b,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return b},_unsetMap:function(a,e){this._io&&this._io.cancel();d.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var b=this._div;b&&(e.removeChild(b),k.destroy(b));this._div=null;this.inherited(arguments)}})})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w){var C=d([z],{declaredClass:"esri.layers.KMLLayer",serviceUrl:location.protocol+"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new e({wkid:4326});this._options=f.mixin({},b);m.defaults.kmlService&&(this.serviceUrl=m.defaults.kmlService);var c=this.linkInfo=b&&b.linkInfo;c&&(this.visible=!!c.visibility,this._waitingForMap=!!c.viewFormat);
(!c||c&&c.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=f.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(a){if(a){var e=a.type,b=a.id,c;switch(e){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+e])&&(c=f.getObject("_mode._featureMap."+b,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var d=a.getImages(),e=d.length;for(a=0;a<e;a++)if(d[a].id===b){c=d[a];break}}break;case "ScreenOverlay":break;
case "NetworkLink":k.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===b?(c=a,!0):!1});break;case "Folder":e=(d=this.folders)?d.length:0;for(a=0;a<e;a++)if(d[a].id===b){c=d[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return c}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&k.forEach(this._links,function(e){e.declaredClass&&a.push(e)});return a},setFolderVisibility:function(a,
e){a&&(this._fireUpdateStart(),(a.visible=e)&&(e=this._areLocalAncestorsVisible(a)),this._setState(a,e),this._fireUpdateEnd())},onRefresh:function(){},onOpacityChange:function(){},_parseKml:function(e){var b=this;this._fireUpdateStart();this._io=a({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(e),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:p.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){b._io=null;b._initLayer(a)},error:function(a){b._io=
null;a=f.mixin(Error(),a);a.message="Unable to load KML: "+b.url+" "+(a.message||"");b._fireUpdateEnd(a);b.onError(a)}})},_initLayer:function(a){this.loaded&&this._removeInternalLayers();this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var e,b,c=this.folders=a.folders,d=[],m;if(c){b=c.length;for(e=0;e<b;e++)m=c[e]=new A(c[e]),-1===m.parentFolderId&&d.push(m)}var c=this._links=a.networkLinks,n;b=c?c.length:0;for(e=
0;e<b;e++)c[e].viewRefreshMode&&-1!==c[e].viewRefreshMode.toLowerCase().indexOf("onregion")||(n=f.mixin({},this._options),n.linkInfo=c[e],n.id&&(n.id=n.id+"_"+e),c[e]=new C(c[e].href,n),c[e]._parentLayer=this,c[e]._parentFolderId=this._getLinkParentId(c[e].linkInfo.id));if((c=a.groundOverlays)&&0<c.length){n=f.mixin({},this._options);n.id&&(n.id+="_mapImage");m=this._groundLyr=new y(n);b=c.length;for(e=0;e<b;e++)m.addImage(new B(c[e]))}if((a=f.getObject("featureCollection.layers",!1,a))&&0<a.length)this._fLayers=
[],k.forEach(a,function(a,e){var b=f.getObject("featureSet.features",!1,a);b&&0<b.length&&(n=f.mixin({outFields:["*"],infoTemplate:a.popupInfo?new h(a.popupInfo):null,editable:!1},this._options),n.id&&(n.id=n.id+"_"+e),a.layerDefinition.capabilities="Query,Data",b=new w(a,n),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},this),0===this._fLayers.length&&delete this._fLayers;b=d.length;for(e=0;e<b;e++)m=d[e],this._setState(m,m.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),
this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&k.forEach(this._links,function(e){e.declaredClass&&(a.addLayer(e),e._waitingForMap&&(e._waitingForMap=null,e.visible?e._parseKml(a):e._wMap=a))});var e=a.spatialReference,b=this._outSR,c;if(!e.equals(b))if(e.isWebMercator()&&4326===b.wkid)c=n.geographicToWebMercator;else if(b.isWebMercator()&&4326===e.wkid)c=n.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");
return}this._groundLyr&&(c&&k.forEach(this._groundLyr.getImages(),function(a){a.extent=c(a.extent)}),a.addLayer(this._groundLyr));(e=this._fLayers)&&0<e.length&&k.forEach(e,function(e){if(c){var b=e.graphics,d,h,m=b?b.length:0;for(d=0;d<m;d++)(h=b[d].geometry)&&b[d].setGeometry(c(h))}a.addLayer(e)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&k.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel()});a&&k.forEach(this.getLayers(),
a.removeLayer,a)},_setState:function(a,e){var b=a.featureInfos,c,d,h,m=b?b.length:0,n=e?"show":"hide";for(h=0;h<m;h++)if(c=b[h],d=this.getFeature(c))if("Folder"===c.type)this._setState(d,e&&d.visible);else if("NetworkLink"===c.type)this._setInternalVisibility(d,e);else d[n]()},_areLocalAncestorsVisible:function(a){var e=a.parentFolderId;for(a=a.visible;a&&-1!==e;)e=this.getFeature({type:"Folder",id:e}),a=a&&e.visible,e=e.parentFolderId;return a},_setInternalVisibility:function(a,e){var b=a._parentLayer,
c=a._parentFolderId;for(e=e&&a.visible;e&&b;)e=e&&b.visible,-1<c&&(e=e&&b._areLocalAncestorsVisible(b.getFeature({type:"Folder",id:c}))),c=b._parentFolderId,b=b._parentLayer;this._setIntState(a,e)},_setIntState:function(a,e){a&&k.forEach(a.getLayers(),function(b){b.linkInfo?a._setIntState(b,e&&b.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:b._parentFolderId}))):b.setVisibility(e)})},_getLinkParentId:function(a){var e=-1;this.folders&&k.some(this.folders,function(b){return b.networkLinkIds&&
-1!==k.indexOf(b.networkLinkIds,a)?(e=b.id,!0):!1});return e},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&this._map){var e=a.refreshMode,b=a.refreshInterval,c=a.viewRefreshMode,a=a.viewRefreshTime;e&&(-1!==e.toLowerCase().indexOf("oninterval")&&0<b)&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*b));c&&(-1!==c.toLowerCase().indexOf("onstop")&&0<a)&&!this._extChgHandle&&(this._extChgHandle=g.connect(this._map,"onExtentChange",this,
this._extentChanged))}}else this._stopAutoRefresh(),g.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=a||this._map;var e={},b=this.linkInfo,c=a&&a.extent,d;this._url.query&&(f.mixin(e,this._url.query),d=!!this._url.query.token);if(r.id&&!d&&(d=r.id.findCredential(this._url.path)))e.token=d.token;if(b){d=b.viewFormat;var h=b.httpQuery,b=b.viewBoundScale;if(c&&d){var m=
c,l=c,k=c.spatialReference;k&&(k.isWebMercator()?m=n.webMercatorToGeographic(c):4326===k.wkid&&(l=n.geographicToWebMercator(c)));c=m.getCenter();l=Math.max(l.getWidth(),l.getHeight());b&&(m=m.expand(b));d=d.replace(/\[bboxWest\]/ig,m.xmin).replace(/\[bboxEast\]/ig,m.xmax).replace(/\[bboxSouth\]/ig,m.ymin).replace(/\[bboxNorth\]/ig,m.ymax).replace(/\[lookatLon\]/ig,c.x).replace(/\[lookatLat\]/ig,c.y).replace(/\[lookatRange\]/ig,l).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,
c.x).replace(/\[lookatTerrainLat\]/ig,c.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,c.x).replace(/\[cameraLat\]/ig,c.y).replace(/\[cameraAlt\]/ig,l).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);f.mixin(e,s.queryToObject(d))}h&&(h=h.replace(/\[clientVersion\]/ig,r.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,
q.locale),f.mixin(e,s.queryToObject(h)))}a=[];for(var g in e)t.isDefined(e[g])&&a.push(g+"\x3d"+e[g]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,e){this.inherited(arguments);k.forEach(this.getLayers(),function(b){b.setScaleRange(a,e)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(k.forEach(this.getLayers(),function(e){e.setOpacity(a)}),this.opacity=this._options.opacity=a,this.onOpacityChange(a))},_setMap:function(a,
e){this.inherited(arguments);this._map=a;var c=this._div=l.create("div",null,e);b.set(c,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return c},_unsetMap:function(a,e){this._io&&this._io.cancel();this._stopAutoRefresh();g.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var b=this._div;b&&(e.removeChild(b),l.destroy(b));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),
this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&(this._map&&!this._io&&this.visible)&&this._parseKml()},getFeatureCollection:function(a){var e,b=[];if(a=this.getFeature({type:"Folder",id:a}))(e=k.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<e.length&&k.forEach(this._fLayers,
function(a){var c,d;c=a.toJson();c.featureSet.features&&0<c.featureSet.features.length&&(d=k.filter(c.featureSet.features,function(b){if(-1!==k.indexOf(e,b.attributes[a.objectIdField]))return b},this));d&&0<d.length&&(c.featureSet.features=d,b.push(c))},this);return b},getFeatureCount:function(a){a=this.getFeature({type:"Folder",id:a});var e={points:0,polylines:0,polygons:0};a&&k.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(e.points+=1);"esriGeometryPolyline"===a.type&&(e.polylines+=
1);"esriGeometryPolygon"===a.type&&(e.polygons+=1)});return e},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});return C})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(q,d,g,f,k){return q(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(f){d.mixin(this,f);k.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},
"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(q,d,g,f,k,p){return q([p],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(c){k.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},"esri/layers/MapImageLayer":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style ../kernel ../config ../sniff ../domUtils ../geometry/Point ../geometry/webMercatorUtils ./layer".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t){var a=q([t],{declaredClass:"esri.layers.MapImageLayer","-chains-":{constructor:"manual"},constructor:function(a){this.inherited(arguments,[null,a]);this._mapImages=[];var b=g.hitch;this._panStart=b(this,this._panStart);this._pan=b(this,this._pan);this._extentChange=b(this,this._extentChange);this._zoom=b(this,this._zoom);this._zoomStart=b(this,this._zoomStart);this._scale=b(this,this._scale);this._resize=b(this,this._resize);d.connect(this,"onSuspend",this,this._onSuspend);
d.connect(this,"onResume",this,this._onResume);this.loaded=!0;this.onLoad(this)},opacity:1,addImage:function(a){var b=this._mapImages.push(a),b=b-1;a._idx=b;a._layer=this;this._div&&this._createImage(a,b)},removeImage:function(a){if(a){var b=a._idx,c=this._mapImages;if(c[b]===a){delete c[b];if(b=a._node)this._clearEvents(b),b.e_idx=b.e_bl=b.e_tr=b.e_l=b.e_t=b.e_w=b.e_h=null,b.parentNode&&(b.parentNode.removeChild(b),k.destroy(b));a._node=a._idx=a._layer=null}}},removeAllImages:function(){var a=this._mapImages,
b,c=a.length;for(b=0;b<c;b++){var d=a[b];d&&this.removeImage(d)}this._mapImages=[]},getImages:function(){var a=this._mapImages,b=[],c,d=a.length;for(c=0;c<d;c++)a[c]&&b.push(a[c]);return b},setOpacity:function(a){this.opacity!=a&&(this._opacityChanged(this.opacity=a),this.onOpacityChange())},onOpacityChange:function(){},_opacityChanged:function(a){var b=this._div,c,d;if(b)if(!l("ie")||8<l("ie"))p.set(b,"opacity",a);else{d=b.childNodes;c=d.length;for(b=0;b<c;b++)p.set(d[b],"opacity",a)}},_createImage:function(e,
b){var h=k.create("img");p.set(h,{position:"absolute"});8>=l("ie")&&p.set(h,"opacity",this.opacity);e.rotation&&!(9>l("ie"))&&p.set(h,c._css.names.transform,c._css.rotate(360-e.rotation));e._node=h;h.e_idx=b;h.e_layer=this;h.e_load=d.connect(h,"onload",a.prototype._imageLoaded);h.e_error=d.connect(h,"onerror",a.prototype._imageError);h.e_abort=d.connect(h,"onabort",a.prototype._imageError);h.src=e.href},_imageLoaded:function(a,b){var c=b||a.target||a.currentTarget,d=c.e_layer,m=d._mapImages[c.e_idx],
l=d._map;l&&(l.__zooming||l.__panning||!d._sr)?d._standby.push(c):(d._clearEvents(c),m&&m._node===c&&l&&d._attach(m))},_imageError:function(a){a=a.target||a.currentTarget;var b=a.e_layer,c=b._mapImages[a.e_idx];b._clearEvents(a);c&&(c._node=null)},_clearEvents:function(a){var b=d.disconnect;b(a.e_load);b(a.e_error);b(a.e_abort);a.e_load=a.e_error=a.e_abort=a.e_layer=null},_attach:function(a){var b=a.extent,c=b.spatialReference,d=this._sr,l=this._div,f=a._node,k=new r({x:b.xmin,y:b.ymin,spatialReference:c}),
b=new r({x:b.xmax,y:b.ymax,spatialReference:c});d.equals(c)||(d.isWebMercator()&&4326===c.wkid?(k=m.geographicToWebMercator(k),b=m.geographicToWebMercator(b)):c.isWebMercator()&&4326===d.wkid&&(k=m.webMercatorToGeographic(k),b=m.webMercatorToGeographic(b)));f.e_bl=k;f.e_tr=b;a.visible&&(this._setPos(f,l._left,l._top),(this._active||l).appendChild(f))},_setPos:function(a,b,d){var m=a.e_bl,l=a.e_tr,f=this._map,m=f.toScreen(m),l=f.toScreen(l);b=m.x-b;d=l.y-d;var r=Math.abs(l.x-m.x),m=Math.abs(m.y-l.y),
l={width:r+"px",height:m+"px"},k=this._mapImages[a.e_idx];"css-transforms"===f.navigationMode?l[c._css.names.transform]=c._css.translate(b,d)+(k.rotation?" "+c._css.rotate(360-k.rotation):""):(l.left=b+"px",l.top=d+"px");p.set(a,l);a.e_l=b;a.e_t=d;a.e_w=r;a.e_h=m},managedSuspension:!0,_setMap:function(a,d){this.inherited(arguments);var h=this._div=k.create("div",null,d),m=c._css.names,f={position:"absolute"},r=a.__visibleDelta;if(!l("ie")||8<l("ie"))f.opacity=this.opacity;"css-transforms"===a.navigationMode?
(f[m.transform]=c._css.translate(r.x,r.y),p.set(h,f),h._left=r.x,h._top=r.y,f={position:"absolute",width:a.width+"px",height:a.height+"px",overflow:"visible"},this._active=k.create("div",null,h),p.set(this._active,f),this._passive=k.create("div",null,h),p.set(this._passive,f)):(h._left=0,h._top=0,p.set(h,f));this._standby=[];m=this._mapImages;r=m.length;for(f=0;f<r;f++){var g=m[f];g._node||this._createImage(g,g._idx)}b.hide(h);return h},_unsetMap:function(a,b){this._disconnect();var c=this._div;if(c){var d=
this._mapImages,m,l=d.length;for(m=0;m<l;m++){var f=d[m];if(f){var r=f._node;r&&(this._clearEvents(r),r.e_idx=r.e_bl=r.e_tr=r.e_l=r.e_t=r.e_w=r.e_h=null);f._node=null}}b.removeChild(c);k.destroy(c)}this._map=this._div=this._sr=this._active=this._passive=this._standby=null;this.inherited(arguments)},_onSuspend:function(){this._disconnect();b.hide(this._div)},_onResume:function(a){a.firstOccurrence&&(this._sr=this._map.spatialReference,this._processStandbyList());a=this._map;var d=this._div,h=a.__visibleDelta;
"css-transforms"===a.navigationMode&&(d._left=h.x,d._top=h.y,p.set(d,c._css.names.transform,c._css.translate(d._left,d._top)));this._redraw("css-transforms"===a.navigationMode);this._connect(a);b.show(d)},_connect:function(a){if(!this._connections){var b=d.connect,c="css-transforms"===a.navigationMode;this._connections=[b(a,"onPanStart",this._panStart),b(a,"onPan",this._pan),b(a,"onExtentChange",this._extentChange),c&&b(a,"onZoomStart",this._zoomStart),c?b(a,"onScale",this._scale):b(a,"onZoom",this._zoom),
c&&b(a,"onResize",this._resize)]}},_disconnect:function(){this._connections&&(f.forEach(this._connections,d.disconnect),this._connections=null)},_panStart:function(){this._panL=this._div._left;this._panT=this._div._top},_pan:function(a,b){var d=this._div;d._left=this._panL+b.x;d._top=this._panT+b.y;"css-transforms"===this._map.navigationMode?p.set(d,c._css.names.transform,c._css.translate(d._left,d._top)):p.set(d,{left:d._left+"px",top:d._top+"px"})},_extentChange:function(a,b,c){c?this._redraw("css-transforms"===
this._map.navigationMode):b&&this._pan(a,b);this._processStandbyList()},_processStandbyList:function(){var a,b=this._standby;if(b&&b.length)for(a=b.length-1;0<=a;a--)this._imageLoaded(null,b[a]),b.splice(a,1)},_redraw:function(a){if(a){a=this._passive;var b=c._css.names;p.set(a,b.transition,"none");this._moveImages(a,this._active);p.set(a,b.transform,"none")}a=this._active||this._div;var b=this._div._left,d=this._div._top,m,l=a.childNodes.length,f;for(m=0;m<l;m++)f=a.childNodes[m],this._setPos(f,
b,d)},_zoom:function(a,b,c){a=this._div;var d=a._left,m=a._top,l,f=a.childNodes.length,r;for(l=0;l<f;l++){r=a.childNodes[l];var k=r.e_w*b,g=r.e_h*b,t=(c.x-d-r.e_l)*(k-r.e_w)/r.e_w,s=(c.y-m-r.e_t)*(g-r.e_h)/r.e_h,t=isNaN(t)?0:t,s=isNaN(s)?0:s;p.set(r,{left:r.e_l-t+"px",top:r.e_t-s+"px",width:k+"px",height:g+"px"})}},_zoomStart:function(){this._moveImages(this._active,this._passive)},_moveImages:function(a,b){var c=a.childNodes,d;d=c.length;if(0<d)for(d-=1;0<=d;d--)b.appendChild(c[d])},_scale:function(a,
b){var d=c._css.names,m=this._passive;p.set(m,d.transition,b?"none":d.transformName+" "+s.defaults.map.zoomDuration+"ms ease");c._css.matrix(a);p.set(m,d.transform,c._css.matrix(a))},_resize:function(a,b,c){p.set(this._active,{width:b+"px",height:c+"px"});p.set(this._passive,{width:b+"px",height:c+"px"})}});return a})},"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/Deferred ./LayerInfo ./LayerInfoForDefault ./LayerInfoFactory".split(" "),
function(q,d,g,f,k,p,c,s,l){return q(c,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection"}},getExtent:function(){var b=[],c;d.forEach(this.originOperLayer.featureCollection.layers,function(c){b=b.concat(c.layerObject.graphics)});0===b.length?c=null:(c=1===b.length?b[0].getLayer().fullExtent:f.graphicsExtent(b),c=this._convertGeometryToMapSpatialRef(c));return c},initVisible:function(){var b=!1,c;if(this.newSubLayers.length)for(c=0;c<this.newSubLayers.length;c++)b=
b||this.newSubLayers[c].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(b){this._visible=b?!0:!1;d.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[];d.forEach(this.originOperLayer.featureCollection.layers,function(c){this._getLayerIndexesInMapByLayerId(c.layerObject.id)&&(c=l.getInstance().create({layerObject:c.layerObject,title:c.layerObject.label||c.layerObject.title||c.layerObject.name||c.layerObject.id||
" ",id:c.id||" ",collection:{layerInfo:this},selfType:"collection",parentLayerInfo:this}),b.push(c),c.init())},this);b.reverse();return b},_obtainLayerIndexesInMap:function(){var b=[],c,d;for(d=0;d<this.newSubLayers.length;d++)(c=this._getLayerIndexesInMapByLayerId(this.newSubLayers[d].layerObject.id))&&b.push(c);return b},moveLeftOfIndex:function(b){var c;for(c=this.newSubLayers.length-1;0<=c;c--)this.map.reorderLayer(this.newSubLayers[c].layerObject,b)},moveRightOfIndex:function(b){var c;for(c=
0;c<this.newSubLayers.length;c++)this.map.reorderLayer(this.newSubLayers[c].layerObject,b)}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/graphicsUtils dojo/aspect dojo/dom-style dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/topic esri/layers/FeatureLayer esri/config esri/tasks/ProjectParameters esri/SpatialReference esri/geometry/webMercatorUtils".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n){return q(null,
{originOperLayer:null,layerObject:null,map:null,title:null,id:null,newSubLayers:null,parentLayerInfo:null,constructor:function(a,e){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=e;this.title=this.originOperLayer.title;this.id=this.originOperLayer.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.nls=window.jimuNls.layerInfosMenu;this.popupMenuInfo={menuItems:[{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",label:this.nls.itemTransparency},{key:null,
label:""},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:null,label:""},{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}],deniedItems:[]}},init:function(){this.newSubLayers=this.obtainNewSubLayers();this.initVisible();this.originOperLayer.popupInfo&&(this.popupVisible=!0)},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();
return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},getExtent:function(){},getOpacity:function(){var a,e=0;for(a=0;a<this.newSubLayers.length;a++)if(this.newSubLayers[a].layerObject.opacity)e=this.newSubLayers[a].layerObject.opacity>e?this.newSubLayers[a].layerObject.opacity:e;else return 1;return e},setOpacity:function(a){d.forEach(this.newSubLayers,function(e){e.layerObject.setOpacity&&e.layerObject.setOpacity(a)})},moveLeftOfIndex:function(a){this.map.reorderLayer(this.layerObject,
a)},moveRightOfIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){a(this);d.forEach(this.getSubLayers(),g.hitch(this,function(e){e.traversal(a)}))},findLayerInfoById:function(a){var e=null,b=0;if(this.id&&this.id===a)return this;for(b=0;b<this.newSubLayers.length&&!(e=this.newSubLayers[b].findLayerInfoById(a));b++);return e},setTopLayerVisible:function(a){var e=this.isShowInMap();this._setTopLayerVisible(a);this._isShowInMapChanged(e)},_setTopLayerVisible:function(a){},
setSubLayerVisible:function(a,e){},setLayerVisiblefromTopLayer:function(){},initVisible:function(){},isVisible:function(){return this._visible},_obtainLayerIndexesInMap:function(){var a=[],e;(e=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(e);return a},_getLayerIndexesInMapByLayerId:function(a){var e;for(e=0;e<this.map.graphicsLayerIds.length;e++)if(this.map.graphicsLayerIds[e]===a)return{isGraphicLayer:!0,index:e};for(e=0;e<this.map.layerIds.length;e++)if(this.map.layerIds[e]===a)return{isGraphicLayer:!1,
index:e};return null},_convertGeometryToMapSpatialRef:function(b){var c=new f;if(this.map.spatialReference.equals(b.spatialReference))return c.resolve([b]),c;if(this.map.spatialReference.isWebMercator()&&b.spatialReference.equals(new e(4326)))return c.resolve([n.geographicToWebMercator(b)]),c;if(this.map.spatialReference.equals(new e(4326))&&b.spatialReference.isWebMercator())return c.resolve([n.webMercatorToGeographic(b)]),c;c=new a;c.geometries=[b];c.outSR=this.map.spatialReference;return t.defaults.geometryService.project(c)},
_isShowInMapChanged:function(a){if(a!==this.isShowInMap()){var e=[];this.traversal(function(a){e.push(a)});r.publish("layerInfos/layerInfo/isShowInMapChanged",e)}},obtainNewSubLayers:function(){return[]},obtainLegendsNode:function(){return b.create("div",{"class":"legends-div"})},initLegendsNode:function(a){},loadLegends:function(){},getDeniedItems:function(){var a=new f,e=[];this.isFirst?e.push("moveup"):this.isLast&&e.push("movedown");if(!this.layerObject||!this.layerObject.url)e.push("description"),
e.push("download");this.getLayerType().then(g.hitch(this,function(b){"FeatureLayer"!==b&&e.push("table");a.resolve(this.popupMenuInfo.deniedItems.concat(e))}),function(){a.resolve(this.popupMenuInfo.deniedItems.concat(e))});return a},onPopupMenuClick:function(a){var e={closeMenu:!0};switch(a.itemKey){case "zoomto":this._onItemZoomToClick(a);break;case "moveup":this._onMoveUpItemClick(a);break;case "movedown":this._onMoveDownItemClick(a);break;case "table":this._onTableItemClick(a);break;case "transparencyChanged":this._onTransparencyChanged(a),
e.closeMenu=!1}return e},_onItemZoomToClick:function(a){this.getExtent().then(g.hitch(this,function(a){this.map.setExtent(a[0])}))},_onTransparencyItemClick:function(a){},_onMoveUpItemClick:function(a){this.isFirst||a.layerListView.moveUpLayer(this.id)},_onMoveDownItemClick:function(a){this.isLast||a.layerListView.moveDownLayer(this.id)},_onTableItemClick:function(a){this.getLayerType().then(g.hitch(this,function(e){"FeatureLayer"===e&&a.layerListWidget.publishData({target:"AttributeTable",layer:this})}))},
_onUrlItemClick:function(a){this.layerObject&&this.layerObject.url&&(a=b.create("a",{href:this.layerObject.url,target:"_blank"}),a.click())},_onTransparencyChanged:function(a){this.setOpacity(1-a.data.newTransValue)},getLayerObject:function(){var a=new f;this.layerObject?a.resolve(this.layerObject):a.reject("layerObject is null");return a},getSubLayers:function(){return this.newSubLayers},isShowInMap:function(){for(var a=!0,e=this;e;)a=a&&e.isVisible(),e=e.parentLayerInfo;return a},getLayerType:function(){var a=
[null],e=new f;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));e.resolve(a[a.length-1]);return e},getPopupInfo:function(){return this.originOperLayer.popupInfo},getUrl:function(){return this.originOperLayer.url}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/Deferred esri/geometry/webMercatorUtils esri/symbols/jsonUtils".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m){var t=q(p,{_legendsNode:null,constructor:function(a,e){this.layerLoadedDef=new b;if(a.selfType)this.popupMenuInfo.menuItems=[{key:"table",label:this.nls.itemToAttributeTable},{key:null,label:""},{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}];else if("esri.layers.FeatureLayer"===this.layerObject.declaredClass){for(var c=
-1,d=0,d=0;d<this.popupMenuInfo.menuItems.length;d++)if("movedown"===this.popupMenuInfo.menuItems[d].key){c=d;break}this.popupMenuInfo.menuItems.splice(c+1,0,"",{key:"table",label:this.nls.itemToAttributeTable})}},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent)||this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.initialExtent)},initVisible:function(){var a=!1;this._visible=a=this.originOperLayer.layerObject.visible},
_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},
obtainLegendsNode:function(){var a=s.create("div",{"class":"legends-div"});s.create("img",{"class":"legends-loading-img",src:require.toUrl("jimu")+"/images/loading.gif"},a);this._legendsNode=a;this.initLegendsNode();return a},initLegendsNode:function(){var a=[],e=this.layerObject;if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length))s.empty(this._legendsNode),e.renderer&&(e.renderer.infos?a=g.clone(e.renderer.infos):a.push({label:e.renderer.label,
symbol:e.renderer.symbol}),d.forEach(a,function(a){a.legendDiv=s.create("div",{"class":"legend-div"},this._legendsNode);a.symbolDiv=s.create("div",{"class":"legend-symbol"},a.legendDiv);a.labelDiv=s.create("div",{"class":"legend-label",innerHTML:a.label||" "},a.legendDiv);if("textsymbol"===a.symbol.type)l.set(a.symbolDiv,"innerHTML",a.symbol.text);else{var e=c.createSurface(a.symbolDiv,50,50);a=m.getShapeDescriptors(a.symbol);e.createShape(a.defaultShape).setFill(a.fill).setStroke(a.stroke).setTransform(c.matrix.translate(25,
25))}},this))},obtainNewSubLayers:function(){var a=[];this.originOperLayer.subLayers&&0!==this.originOperLayer.subLayers.length&&d.forEach(this.originOperLayer.subLayers,function(e){e=new t(e,this.map);a.push(e);e.init()},this);return a},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)}});return t})},"jimu/LayerInfos/LayerInfoFactory":function(){define(["dojo/_base/declare","dojo/_base/array",
"dojo/_base/lang","dojo/aspect","dojo/Deferred"],function(q,d,g,f,k){var p=null,c=q(null,{constructor:function(){},init:function(){var c=new k;require("jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForGroup jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS".split(" "),
g.hitch(this,function(d,b,f,m,k,a,e,n,h,g){this.LayerInfoForCollection=d;this.LayerInfoForMapService=b;this.LayerInfoForKML=f;this.LayerInfoForGeoRSS=m;this.LayerInfoForDefault=k;this.LayerInfoForWMS=a;this.LayerInfoForGroup=e;this.LayerInfoForDefaultDynamic=n;this.LayerInfoForDefaultTile=h;this.LayerInfoForDefaultWMS=g;c.resolve()}));return c},create:function(c){if(c.featureCollection)return new this.LayerInfoForCollection(c,this.map);if("esri.layers.KMLLayer"===c.layerObject.declaredClass)return new this.LayerInfoForKML(c,
this.map);if("esri.layers.GeoRSSLayer"===c.layerObject.declaredClass)return new this.LayerInfoForGeoRSS(c,this.map);if("esri.layers.WMSLayer"===c.layerObject.declaredClass&&!c.selfType)return new this.LayerInfoForWMS(c,this.map);if("esri.layers.ArcGISDynamicMapServiceLayer"===c.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===c.layerObject.declaredClass)return new this.LayerInfoForMapService(c,this.map);switch(c.selfType){case "mapservice_dynamic_group":return new this.LayerInfoForGroup(c,
this.map);case "mapservice_tiled_group":return new this.LayerInfoForGroup(c,this.map,!0);case "mapservice_dynamic":return new this.LayerInfoForDefaultDynamic(c,this.map);case "mapservice_tiled":return new this.LayerInfoForDefaultTile(c,this.map);case "wms":return new this.LayerInfoForDefaultWMS(c,this.map);default:return new this.LayerInfoForDefault(c,this.map)}}});c.getInstance=function(d){null===p&&(p=new c);d&&(p.map=d);return p};return c})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json ./LayerInfo ./LayerInfoForDefault ./LayerInfoForDefaultDynamic ./LayerInfoForDefaultTile ./LayerInfoForGroup esri/layers/ArcGISDynamicMapServiceLayer esri/layers/FeatureLayer esri/request ./LayerInfoFactory".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a){return q(p,{_legendInfo:null,_sublayerIdent:null,constructor:function(a,b){this.initSubLayerVisible();this._sublayerIdent={idents:[],empty:!0,defLoad:new f};this._sublayerIdent.idents[this.layerObject.layerInfos.length-1]=null},initSubLayerVisible:function(){this.subLayerVisible=[];for(var a=this.subLayerVisible[this.layerObject.layerInfos.length-1]=0;a<this.subLayerVisible.length;a++)this.subLayerVisible[a]=0;this.originOperLayer.visibleLayers?d.forEach(this.originOperLayer.visibleLayers,
function(a){this.subLayerVisible[a]++},this):d.forEach(this.layerObject.layerInfos,function(a,e){a.defaultVisibility&&this.subLayerVisible[e]++},this)},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent)},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.setVisibility(a);this._visible=a},setSubLayerVisible:function(a,
b){var c=[],m;null!==a&&(b?(c=g.clone(this.originOperLayer.layerObject.visibleLayers),m=d.indexOf(c,a),0>m&&(c.push(a),this.originOperLayer.layerObject.setVisibleLayers(c))):(c=g.clone(this.originOperLayer.layerObject.visibleLayers),m=d.indexOf(c,a),0<=m&&c.splice(m,1),0===c.length&&c.push(-1),this.originOperLayer.layerObject.setVisibleLayers(c)))},obtainNewSubLayers:function(){var e=[],b=this.originOperLayer.layerObject,c=null,c="esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass?"dynamic":
"tiled";d.forEach(b.layerInfos,function(a){var d=null,d=b.url+"/"+a.id,m=b.id+"_"+a.id;a.subLayerIds&&0<a.subLayerIds.length?(d={url:d,empty:!0},this._addNewSubLayer(e,d,m,a,c+"_group")):(d={url:d,empty:!0},this._addNewSubLayer(e,d,m,a,c))},this);var m=[];d.forEach(b.layerInfos,function(a,b){var c=a.parentLayerId;-1!==c&&e[c].subLayers.push(e[b])});d.forEach(b.layerInfos,function(b,c){var d;-1===b.parentLayerId&&(d=a.getInstance().create(e[c]),m.push(d),d.init())},this);return m},_addNewSubLayer:function(a,
b,c,d,m){a.push({layerObject:b,title:d.name||d.id||" ",id:c||" ",subLayers:[],mapService:{layerInfo:this,subId:d.id},selfType:"mapservice_"+m,url:b.url,parentLayerInfo:this})},_handleErrorSubLayer:function(a,b,c,d,m,l){a[b]={layerObject:null,title:l.name||l.id||" ",id:c||" ",subLayers:[],mapService:{layerInfo:this,subId:d}}},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},getLegendInfo:function(a){var b=
new f;this._legendInfo?b.resolve(this._legendInfo):this._legendRequest(a).then(g.hitch(this,function(a){this._legendInfo=a.layers;b.resolve(this._legendInfo)}),function(){b.reject()});return b},_legendRequest:function(a){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.dynamicLayers&&(b.dynamicLayers=k.stringify(this._createDynamicLayers(this.layerObject)),
"[{}]"===b.dynamicLayers&&(b.dynamicLayers="[]"));return t({url:a,content:b,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(a){return t({url:a+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(a){var b=[],c;d.forEach(a.dynamicLayerInfos||a.layerInfos,function(d){c={id:d.id};c.source=d.source&&d.source.toJson();var m;a.layerDefinitions&&a.layerDefinitions[d.id]&&(m=a.layerDefinitions[d.id]);
m&&(c.definitionExpression=m);var l;a.layerDrawingOptions&&a.layerDrawingOptions[d.id]&&(l=a.layerDrawingOptions[d.id]);l&&(c.drawingInfo=l.toJson());c.minScale=d.minScale||0;c.maxScale=d.maxScale||0;b.push(c)});return b},_getSublayerIdent:function(a){var b;this._sublayerIdent[a]?(b=new f,b.resolve(this._sublayerIdent[a])):b=this._layerAndTableRequest(a);return b},_layerAndTableRequest:function(a){return 10.11<=this.layerObject.version?this._allLayerAndTableServer(a):this._allLayerAndTable(a)},_allLayerAndTableServer:function(a){var b=
new f,c=this.originOperLayer.url+"/layers";this._sublayerIdent.empty?(this._sublayerIdent.empty=!1,this._request(c).then(g.hitch(this,function(c){this._sublayerIdent.idents=c.layers;this._sublayerIdent.defLoad.resolve();b.resolve(this._sublayerIdent.idents[a])}),g.hitch(this,function(a){console.err(a.message||a);this._sublayerIdent.defLoad.reject();this._sublayerIdent.defLoad=new f;this._sublayerIdent.empty=!0;b.resolve(null)}))):this._sublayerIdent.defLoad.then(g.hitch(this,function(){b.resolve(this._sublayerIdent.idents[a])}),
function(a){console.err(a.message||a);b.resolve(null)});return b},_allLayerAndTable:function(a){var b=new f;this._request(this.originOperLayer.url+"/"+a).then(g.hitch(this,function(c){this._sublayerIdent.idents[a]=c;b.resolve(c)}),function(a){console.err(a.message||a);b.resolve(null)});return b},_request:function(a){return t({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})}})})},"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefaultService".split(" "),
function(q,d,g,f,k,p){return q(p,{constructor:function(c,d){},initVisible:function(){var c=!1,d=this.originOperLayer.mapService;this.originOperLayer.mapService&&0<d.layerInfo.subLayerVisible[d.subId]&&(c=!0);this._visible=c},_setTopLayerVisible:function(c){var d;this.originOperLayer.mapService&&(d=this.originOperLayer.mapService,c?d.layerInfo.subLayerVisible[d.subId]++:d.layerInfo.subLayerVisible[d.subId]--,this._visible=c,this.visbleOrInvisilbe())},visbleOrInvisilbe:function(){var c=this.originOperLayer.mapService;
c.layerInfo.setSubLayerVisible(c.subId,this.isVisbleOrInvisilbe())},isVisbleOrInvisilbe:function(){for(var c=this.originOperLayer.mapService,d=-1,l=c.subId,b=0,f=c.layerInfo.layerObject.layerInfos;;){d++;b+=c.layerInfo.subLayerVisible[l];if(-1===f[l].parentLayerId)return b>d?!0:!1;l=f[l].parentLayerId}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-attr dojo/query ./LayerInfoForDefault esri/layers/FeatureLayer".split(" "),
function(q,d,g,f,k,p,c,s,l){return q(s,{_legendsNode:null,loadLegends:function(b){this.originOperLayer.mapService.layerInfo.getLegendInfo(b).then(g.hitch(this,function(b){this.initLegendsNode(b)}))},initLegendsNode:function(b){var l=this.originOperLayer.mapService,m=c(".legends-loading-img",this._legendsNode)[0];if(b&&m){k.empty(this._legendsNode);for(var m=null,f=0;f<b.length;f++)if(b[f].layerId===l.subId){m=b[f];break}m&&d.forEach(m.legend,function(a){if("\x3call other values\x3e"!==a.label){var b=
k.create("div",{"class":"legend-div"},this._legendsNode),c=k.create("div",{"class":"legend-symbol",style:"width:50px;height:50px;position:relative"},b),d=null,d=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;k.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:d},c);k.create("div",{"class":"legend-label",innerHTML:a.label||" "},b)}},this)}},getLayerObject:function(){var b=new f;this.layerObject.empty?(this.layerObject=
new l(this.layerObject.url),this.layerObject.on("load",g.hitch(this,function(){b.resolve(this.layerObject)})),this.layerObject.on("error",g.hitch(this,function(){b.resolve(null)}))):b.resolve(this.layerObject);return b},getPopupInfo:function(){var b=null,c=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(c)for(var d=0;d<c.length;d++)if(c[d].id===this.originOperLayer.mapService.subId){b=c[d].popupInfo;break}return b},getLayerType:function(){var b=new f,c=this.originOperLayer.mapService;
c.layerInfo._getSublayerIdent(c.subId).then(g.hitch(this,function(c){c?b.resolve(c.type.replace(/\ /g,"")):b.resolve(null)}));return b}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefaultService".split(" "),function(q,d,g,f,k,p){return q(p,{constructor:function(c,d){this.noLegend=!0},getExtent:function(){},initVisible:function(){},_setTopLayerVisible:function(c){},setLayerVisiblefromTopLayer:function(){},
getOpacity:function(){},setOpacity:function(c){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},"jimu/LayerInfos/LayerInfoForGroup":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/aspect dojo/Deferred esri/request ./LayerInfoForDefault ./LayerInfoForDefaultDynamic ./LayerInfoForDefaultTile ./LayerInfo ./LayerInfoFactory".split(" "),function(q,d,g,f,k,p,c,s,l,b,r){return q(b,{constructor:function(b,c,a){this.noLegend=a;
this.popupMenuInfo.menuItems=[{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}]},getExtent:function(){},initVisible:function(){var b=!1,c=this.originOperLayer.mapService;this.originOperLayer.mapService&&0<c.layerInfo.subLayerVisible[c.subId]&&(b=!0);this._visible=b},_setTopLayerVisible:function(b){var c;this.originOperLayer.mapService&&(c=this.originOperLayer.mapService,
0<this.originOperLayer.subLayers.length&&(b?c.layerInfo.subLayerVisible[c.subId]++:c.layerInfo.subLayerVisible[c.subId]--,this._visible=b,this.traversal(function(a){0===a.getSubLayers().length&&a.visbleOrInvisilbe()})))},setLayerVisiblefromTopLayer:function(){},obtainNewSubLayers:function(){var b=[];d.forEach(this.originOperLayer.subLayers,function(c){c.parentLayerInfo=this;c=r.getInstance().create(c);b.push(c);c.init()},this);return b},getOpacity:function(){},setOpacity:function(b){},getLayerObject:function(){var b=
new k;this.layerObject.empty?p({url:this.layerObject.url,handleAs:"json",callbackParamName:"callback",timeout:1E5,content:{f:"json"}}).then(g.hitch(this,function(c){var a=this.layerObject.url;this.layerObject=c;this.layerObject[a]=a;b.resolve(this.layerObject)}),function(c){b.reject(c)}):b.resolve(this.layerObject);return b},getLayerType:function(){var b=new k;b.resolve("GroupLayer");return b}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefault dojo/Deferred".split(" "),
function(q,d,g,f,k,p,c,s){return q(p,{constructor:function(c,b){for(var d=-1,m=0,m=0;m<this.popupMenuInfo.menuItems.length;m++)if("description"===this.popupMenuInfo.menuItems[m].key){d=m;break}this.popupMenuInfo.menuItems.splice(d,1,{key:"download",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDownload+"\x3c/a\x3e"})},getExtent:function(){var c=this.originOperLayer.layerObject.getLayers(),
b=null,f;d.forEach(c,function(c){f=this._convertGeometryToMapSpatialRef(c.initialExtent);b=b?b.union(f):f},this);return b},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(c){c?this.originOperLayer.layerObject.show():this.originOperLayer.layerObject.hide();this._visible=c},obtainNewSubLayers:function(){var l=[],b=this.originOperLayer.layerObject.getLayers();d.forEach(b,function(b){this._getLayerIndexesInMapByLayerId(b.id)&&(b=new c({layerObject:b,
title:b.label||b.title||b.name||b.id||" ",id:b.id||" ",selfType:"kml",url:b.url,parentLayerInfo:this},this.map),l.push(b),b.init())},this);return l}})})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/Deferred ./LayerInfo ./LayerInfoForDefault ./LayerInfoFactory".split(" "),function(q,d,g,f,k,p,c,s,l){return q(c,{constructor:function(){},getExtent:function(){var b=this.layerObject.items;if(0===b.length)return null;
b=f.graphicsExtent(b);return this._convertGeometryToMapSpatialRef(b)},initVisible:function(){var b=!1,c;if(this.newSubLayers.length)for(c=0;c<this.newSubLayers.length;c++)b=b||this.newSubLayers[c].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(b){this._visible=b?!0:!1;d.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[],c=this.layerObject.getFeatureLayers();d.forEach(c,function(c){c=l.getInstance().create({layerObject:c,
title:c.label||c.title||c.name||c.id||" ",id:c.id||" ",collection:{layerInfo:this},selfType:"geo_rss",url:c.url,parentLayerInfo:this});b.push(c);c.init()},this);return b},_obtainLayerIndexesInMap:function(){var b=[],c,d;for(d=0;d<this.newSubLayers.length;d++)(c=this._getLayerIndexesInMapByLayerId(this.newSubLayers[d].layerObject.id))&&b.push(c);return b},moveLeftOfIndex:function(b){var c;for(c=this.newSubLayers.length-1;0<=c;c--)this.map.reorderLayer(this.newSubLayers[c].layerObject,b)},moveRightOfIndex:function(b){var c;
for(c=0;c<this.newSubLayers.length;c++)this.map.reorderLayer(this.newSubLayers[c].layerObject,b)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS ./LayerInfoFactory esri/layers/FeatureLayer".split(" "),function(q,d,g,f,k,p,c,s,l,b){return q(c,{constructor:function(b,c){this.layerObject=b.layerObject},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.extent)},
initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(b){b?this.layerObject.setVisibility(!0):this.layerObject.setVisibility(!1);this._visible=b;d.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[];d.forEach(this.layerObject.layerInfos,function(c){c=l.getInstance().create({layerObject:this.layerObject,title:c.label||c.title||c.name||" ",id:c.name||" ",wms:{layerInfo:this,subId:c.name},selfType:"wms",
url:this.layerObject.url,parentLayerInfo:this});b.push(c);c.init()},this);return b}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefault".split(" "),function(q,d,g,f,k,p){return q(p,{constructor:function(c,d){this.layerObject=c.layerObject},getExtent:function(){},initVisible:function(){var c=[],c=!1,c=g.clone(this.originOperLayer.layerObject.visibleLayers);this._visible=c=0<=d.indexOf(c,
this.originOperLayer.id)?!0:!1},_setTopLayerVisible:function(c){this.originOperLayer.layerObject.visible?c?(this._show(),this._visible=!0):(this._hide(),this._visible=!1):c?(this._hide(),this._visible=!0):(this._hide(),this._visible=!1)},_show:function(){var c=[],c=g.clone(this.originOperLayer.layerObject.visibleLayers);0>d.indexOf(c,this.id)&&(c.push(this.id),this.originOperLayer.layerObject.setVisibleLayers(c))},_hide:function(){var c=[],f,c=g.clone(this.originOperLayer.layerObject.visibleLayers);
f=d.indexOf(c,this.id);0<=f&&c.splice(f,1);this.originOperLayer.layerObject.setVisibleLayers(c)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.layerObject.visible?this._visible&&this._show():this._hide()},_obtainLegendInfos:function(c){return[]},obtainNewSubLayers:function(){return[]},getOpacity:function(){},setOpacity:function(c){}})})},"jimu/dijit-all":function(){define([],1)},"jimu/dijit/RadioBtn":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "),
function(q,d,g,f,k,p,c,s){return q(d,{"class":"jimu-radio",checked:!1,group:null,constructor:function(){},postCreate:function(){c.create("div",{"class":"jimu-radio-inner"},this.domNode);this.checked&&p.add(this.domNode,"jimu-radio-checked");this.own(k(this.domNode,"click",g.hitch(this,function(){this.checked||this.check()})))},check:function(c){void 0===c&&(c=!0);this.checked=!0;p.add(this.domNode,"jimu-radio-checked");c&&this._changeOthersState(!1);this.onStateChange()},uncheck:function(c){void 0===
c&&(c=!0);this.checked=!1;p.remove(this.domNode,"jimu-radio-checked");c&&this._changeOthersState(!1);this.onStateChange()},_changeOthersState:function(c){null!==this.group&&f.forEach(s.toArray(),function(b){b.id!==this.id&&(b["class"]===this["class"]&&b.group===this.group)&&(c?b.check(!1):b.uncheck(!1))},this)},onStateChange:function(){}})})},"jimu/dijit/CheckBox":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","dojo/_base/html","dojo/on"],function(q,d,g,f,k){return q(d,
{"class":"jimu-checkbox",checked:!1,status:!0,postCreate:function(){this.checkNode=f.create("div",{"class":"checkbox"},this.domNode);this.label&&(this.labelNode=f.create("div",{"class":"label",innerHTML:this.label},this.domNode));this.checked&&f.addClass(this.checkNode,"checked");this.own(k(this.checkNode,"click",g.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this.label&&this.own(k(this.labelNode,"click",g.hitch(this,function(){this.checked&&this.status?
this.uncheck():this.status&&this.check()})))},setValue:function(d){!0===d?this.check():this.uncheck()},getValue:function(){return this.checked},setStatus:function(d){(this.status=d)?f.setStyle(this.labelNode,"color","#000000"):f.setStyle(this.labelNode,"color","#818181")},check:function(){this.checked=!0;f.addClass(this.checkNode,"checked");this.onStateChange()},uncheck:function(d){this.checked=!1;f.removeClass(this.checkNode,"checked");if(!d)this.onStateChange()},onStateChange:function(){if(this.onChange&&
g.isFunction(this.onChange))this.onChange(this.checked)}})})},"jimu/dijit/SymbolChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SymbolChooser.html dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojox/gfx dojo/_base/Color dojo/request/xhr dijit/form/Select dijit/form/NumberSpinner jimu/dijit/ColorPicker jimu/dijit/_Transparency jimu/utils jimu/symbolUtils esri/request esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/symbols/PictureMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/CartographicLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w,C,D,E,x,v,I,F){return q([d,g,f,p],{templateString:k,baseClass:"jimu-symbol-chooser",declaredClass:"jimu.dijit.SymbolChooser",nls:null,_pointEventsBinded:!1,_lineEventBinded:!1,_fillEventBinded:!1,_textEventBinded:!1,_invokeSymbolChangeEvent:!0,symbol:null,type:null,postMixInProperties:function(){this.nls=window.jimuNls.symbolChooser},postCreate:function(){this.inherited(arguments);this.symbol?this.showBySymbol(this.symbol):this.type&&this.showByType(this.type)},
reset:function(){this.symbol=this.type=null;this._hideAllSections()},showBySymbol:function(a){this.reset();var b=a&&a.declaredClass;b&&("string"===typeof b&&0<=b.indexOf("esri.symbol"))&&(this.symbol=this._cloneSymbol(a),this.isSimpleMarkerSymbol(this.symbol)||this.isPictureMarkerSymbol(this.symbol)?(this.type="marker",this._initPointSection()):this.isSimpleLineSymbol(this.symbol)?(this.type="line",this._initLineSection()):this._isSimpleFillSymbol(this.symbol)?(this.type="fill",this._initFillSection()):
this._isTextSymbol(this.symbol)&&(this.type="text",this._initTextSection()))},showByType:function(a){this.reset();if("marker"===a||"line"===a||"fill"===a||"text"===a)this.type=a,"marker"===this.type?this._initPointSection():"line"===this.type?this._initLineSection():"fill"===this.type?this._initFillSection():"text"===this.type&&this._initTextSection()},getSymbol:function(){var a=null;"marker"===this.type?a=this._getPointSymbolBySetting():"line"===this.type?a=this._getLineSymbolBySetting():"fill"===
this.type?a=this._getFillSymbolBySetting():"text"===this.type&&(a=this._getTextSymbolBySetting());var b=null;a&&(b=this._cloneSymbol(a));return b},_onChange:function(a){a=this._cloneSymbol(a);this.emit("change",a)},_hideAllSections:function(){r(".symbol-section",this.domNode).style("display","none")},_showSection:function(a){this._hideAllSections();r("."+a+"-symbol-section",this.domNode).style("display","block")},_getAncestor:function(a,b,e){return A.getAncestorDom(a,b,e)},_getAbsoluteUrl:function(a){return window.location.protocol+
"//"+window.location.host+require.toUrl(a)},_cloneSymbol:function(a){if(!a)return null;var b=a;try{var e=a.toJson(),b=w.fromJson(e)}catch(c){console.error(c)}return b},_createSymbolIconTable:function(a,b){for(var e=this.type+"-icon-table",e=s.toDom('\x3ctable class\x3d"'+("icon-table "+e+" "+(e+"-"+a))+'"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e'),d=r("tbody",e)[0],h=Math.ceil(b.length/8),m=0;m<h;m++)s.create("tr",{},d);var f=r("tr",e);l.forEach(b,c.hitch(this,function(a,b){var e=c.clone(a),d=
w.fromJson(a),h=s.create("td",{},f[Math.floor(b/8)]);s.addClass(h,"symbol-td-item");d=this._createSymbolNode(d);s.addClass(d,"symbol-div-item");d.symbol=e;s.place(d,h)}));return e},_updatePreview:function(a){var b=this._cloneSymbol(this.symbol);s.empty(a);(b=B.createSymbolNode(b))||(b=s.create("div"));s.place(b,a)},_createSymbolNode:function(a){(a=B.createSymbolNode(a,{width:32,height:32}))||(a=s.create("div"));s.setStyle(a,{width:"36px",height:"36px"});return a},_getLineShapeDesc:function(a){var b=
null;if(this.isSimpleLineSymbol(a)||this.isCartographicLineSymbol(a))b={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:a.getStroke()};return b},_initPointSection:function(){this._showSection("point");this._pointEventsBinded||(this._pointEventsBinded=!0,this._bindPointEvents(),this._onPointSymClassSelectChange());this.isPictureMarkerSymbol(this.symbol)?this._showPictureMarkerSymSettings():(this.isSimpleMarkerSymbol(this.symbol)||(this.symbol=new C({style:"esriSMSCircle",color:[0,
0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})),this._showSimpleMarkerSymSettings());this._initPointSettings(this.symbol);this._getPointSymbolBySetting()},_bindPointEvents:function(){this.own(b(this.pointIconTables,".symbol-div-item:click",c.hitch(this,this._onPointSymIconItemClick)));this.own(b(this.pointSymClassSelect,"Change",c.hitch(this,this._onPointSymClassSelectChange)));this.own(b(this.pointSize,"change",c.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointColor,
"change",c.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointAlpha,"change",c.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointOutlineColor,"change",c.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointOutlineWidth,"change",c.hitch(this,this._onPointSymbolChange)))},_onPointSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getPointSymbolBySetting(),this._onChange(this.symbol))},_initPointSettings:function(a){if(a){this._invokeSymbolChangeEvent=!1;if(this.isSimpleMarkerSymbol(a)){if(this.pointSize.set("value",
a.size),this.pointColor.setColor(a.color),this.pointAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a=a.outline)this.pointOutlineColor.setColor(a.color),this.pointOutlineWidth.set("value",parseFloat(a.width.toFixed(0)))}else this.isPictureMarkerSymbol(a)&&this.pointSize.set("value",a.width);this._invokeSymbolChangeEvent=!0}},isSimpleMarkerSymbol:function(a){return a&&"esri.symbol.SimpleMarkerSymbol"===a.declaredClass},isPictureMarkerSymbol:function(a){return a&&"esri.symbol.PictureMarkerSymbol"===
a.declaredClass},_onPointSymClassSelectChange:function(){this._showSelectedPointSymIconTable();var a=this.pointSymClassSelect.get("value");this.pointSymClassSelect["def"+a]||this._requestPointSymJson(a)},_showSelectedPointSymIconTable:function(){var a=this.pointSymClassSelect.get("value");r(".marker-icon-table",this.pointIconTables).style("display","none");a=r(".marker-icon-table-"+a,this.pointIconTables);0<a.length&&a.style("display","table")},_requestPointSymJson:function(b){var e="def"+b,d=this.pointSymClassSelect[e];
d||(d=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+b+".json"),d=a(d,{handleAs:"json"}),this.pointSymClassSelect[e]=d,d.then(c.hitch(this,function(a){a=this._createSymbolIconTable(b,a);s.place(a,this.pointIconTables);this._showSelectedPointSymIconTable()}),c.hitch(this,function(a){console.error("get point symbol failed",a)})))},_onPointSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return s.hasClass(a,"symbol-div-item")},5))if(r(".selected-symbol-div-item",
a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),s.addClass(a,"selected-symbol-div-item"),a=a.symbol)this.symbol=w.fromJson(a),this.isSimpleMarkerSymbol(this.symbol)?this._showSimpleMarkerSymSettings():this._showPictureMarkerSymSettings(),this._onPointSymbolChange()},_showSimpleMarkerSymSettings:function(){s.setStyle(this.pointColorTr,"display","");s.setStyle(this.pointOpacityTr,"display","");s.setStyle(this.pointOutlineColorTr,"display","");s.setStyle(this.pointOulineWidthTr,
"display","")},_showPictureMarkerSymSettings:function(){s.setStyle(this.pointColorTr,"display","none");s.setStyle(this.pointOpacityTr,"display","none");s.setStyle(this.pointOutlineColorTr,"display","none");s.setStyle(this.pointOulineWidthTr,"display","none")},_getPointSymbolBySetting:function(){if(!this.symbol)return null;var a=parseFloat(this.pointSize.get("value"));if(this.isSimpleMarkerSymbol(this.symbol)){this.symbol.setSize(a);var a=this.pointColor.getColor(),b=this.pointAlpha.getAlpha();a.a=
b;this.symbol.setColor(a);var a=this.pointOutlineColor.getColor(),b=parseFloat(this.pointOutlineWidth.get("value")),e=new E;e.setStyle(E.STYLE_SOLID);e.setColor(a);e.setWidth(b);this.symbol.setOutline(e)}else this.isPictureMarkerSymbol(this.symbol)&&(this.symbol.setWidth(a),this.symbol.setHeight(a));this._updatePreview(this.pointSymPreview);return this.symbol},_initLineSection:function(){this._showSection("line");this._lineEventBinded||(this._lineEventBinded=!0,this._bindLineEvents(),this._requestLineSymJson("line"));
this._initLineSettings(this.symbol);this._getLineSymbolBySetting()},_bindLineEvents:function(){this.own(b(this.lineIconTables,".symbol-div-item:click",c.hitch(this,this._onLineSymIconItemClick)));this.own(b(this.lineColor,"change",c.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineStylesSelect,"change",c.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineAlpha,"change",c.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineWidth,"change",c.hitch(this,this._onLineSymbolChange)))},
_onLineSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getLineSymbolBySetting(),this._onChange(this.symbol))},_initLineSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.lineColor.setColor(a.color),this.lineAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),this.lineWidth.set("value",parseFloat(a.width.toFixed(0))),this.lineStylesSelect.set("value",a.style),this._invokeSymbolChangeEvent=!0)},isSimpleLineSymbol:function(a){return a&&"esri.symbol.SimpleLineSymbol"===a.declaredClass},
isCartographicLineSymbol:function(a){return a&&"esri.symbol.CartographicLineSymbol"===a.declaredClass},_requestLineSymJson:function(b){var e=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+b+".json");a(e,{handleAs:"json"}).then(c.hitch(this,function(a){a=this._createSymbolIconTable(b,a);s.place(a,this.lineIconTables)}),c.hitch(this,function(a){console.error("get line symbol failed",a)}))},_onLineSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return s.hasClass(a,
"symbol-div-item")},5))if(r(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),s.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=w.fromJson(a),this._initLineSettings(a),this._onLineSymbolChange()},_getLineSymbolBySetting:function(){this.symbol=new E;var a=this.lineColor.getColor(),b=this.lineStylesSelect.get("value");a.a=this.lineAlpha.getAlpha();var e=parseFloat(this.lineWidth.get("value"));this.symbol.setStyle(b);this.symbol.setColor(a);this.symbol.setWidth(e);
this._updatePreview(this.lineSymPreview);return this.symbol},_initFillSection:function(){this._showSection("fill");this._fillEventBinded||(this._fillEventBinded=!0,this._bindFillEvents(),this._requestFillSymJson("fill"));this._initFillSettings(this.symbol);this._getFillSymbolBySetting()},_bindFillEvents:function(){this.own(b(this.fillIconTables,".symbol-div-item:click",c.hitch(this,this._onFillSymIconItemClick)));this.own(b(this.fillColor,"change",c.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillAlpha,
"change",c.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillOutlineColor,"change",c.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillOutlineWidth,"change",c.hitch(this,this._onFillSymbolChange)))},_onFillSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getFillSymbolBySetting(),this._onChange(this.symbol))},_initFillSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.fillColor.setColor(a.color),this.fillAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a.outline&&
(this.fillOutlineColor.setColor(a.outline.color),this.fillOutlineWidth.set("value",parseInt(a.outline.width,10))),this._invokeSymbolChangeEvent=!0)},_isSimpleFillSymbol:function(a){return a&&"esri.symbol.SimpleFillSymbol"===a.declaredClass},_requestFillSymJson:function(b){var e=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+b+".json");a(e,{handleAs:"json"}).then(c.hitch(this,function(a){a=this._createSymbolIconTable(b,a);s.place(a,this.fillIconTables)}),c.hitch(this,function(a){console.error("get fill symbol failed",
a)}))},_onFillSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return s.hasClass(a,"symbol-div-item")},5))if(r(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),s.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=w.fromJson(a),this._initFillSettings(a),this._onFillSymbolChange()},_getFillSymbolBySetting:function(){this.symbol=new v;var a=this.fillColor.getColor();a.a=this.fillAlpha.getAlpha();var b=this.fillOutlineColor.getColor(),
e=parseInt(this.fillOutlineWidth.get("value"),10);this.symbol.setColor(a);this.symbol.setStyle(v.STYLE_SOLID);a=new E;a.setStyle(E.STYLE_SOLID);a.setColor(b);a.setWidth(e);this.symbol.setOutline(a);this._updatePreview(this.fillSymPreview);return this.symbol},_initTextSection:function(){this._showSection("text");this._textEventBinded||(this._textEventBinded=!0,this._bindTextEvents());this._initTextSettings();this._getTextSymbolBySetting()},_bindTextEvents:function(){this.own(b(this.inputText,"change",
c.hitch(this,this._onTextSymbolChange)));this.own(b(this.textColor,"change",c.hitch(this,this._onTextSymbolChange)));this.own(b(this.textFontSize,"change",c.hitch(this,this._onTextSymbolChange)))},_onTextSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getTextSymbolBySetting(),this._onChange(this.symbol))},_initTextSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.inputText.value=a.text,this.textColor.setColor(a.color),a=parseInt(a.font.size,10),this.textFontSize.set("value",
a),this._invokeSymbolChangeEvent=!0)},_isTextSymbol:function(a){return a&&"esri.symbol.TextSymbol"===a.declaredClass},_updateTextPreview:function(){var a=this.textColor.getColor().toHex(),b=parseInt(this.textFontSize.get("value"),10)+"px";s.setStyle(this.textPreview,{color:a,fontSize:b});this.textPreview.innerHTML=this.inputText.value},_getTextSymbolBySetting:function(){this.symbol=new I;var a=this.inputText.value,b=this.textColor.getColor(),e=parseInt(this.textFontSize.get("value"),10),c=new F;c.setSize(e);
this.symbol.setText(a);this.symbol.setColor(b);this.symbol.setFont(c);this._updateTextPreview();return this.symbol}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),function(q,d,
g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A){function B(a){return function(b){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(s.hitch(this,a,b))}}var y=d("dijit.form._SelectMenu",t,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,b=this.parentWidget.value;s.isArray(b)&&
(b=b[b.length-1]);b&&q.forEach(this.parentWidget._getChildren(),function(e){e.option&&b===e.option.value&&(a=!0,this.focusChild(e,!1))},this);a||this.inherited(arguments)}});k=d("dijit.form.Select"+(b("dojo-bidi")?"_NoBidi":""),[r,m,h],{baseClass:"dijitSelect dijitValidationTextBox",templateString:A,_buttonInputDisabled:b("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new y({id:this.id+"_menu",parentWidget:this});f.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(b){if(!b.value&&!b.label)return new e({ownerDocument:this.ownerDocument});var c=s.hitch(this,"_setValueAttr",b);b=new a({option:b,label:("text"===this.labelType?(b.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):b.label)||this.emptyLabel,onClick:c,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:b.disabled||!1});b.focusNode.setAttribute("role","option");return b},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=z.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,b,e,c){a&&this.focusChild(a)},_loadChildren:function(b){if(!0===b)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{q.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var e=new a({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(e)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);g.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var b=a?"":this._missingMsg;b&&this.focused&&this._hasBeenBlurred?n.show(b,this.domNode,this.tooltipPosition,!this.isLeftToRight()):n.hide(this.domNode);this._set("message",b);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);n.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=p.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(l(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[c.LEFT_ARROW];delete a[c.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
f.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);n.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){n.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
b("dojo-bidi")&&(k=d("dijit.form.Select",k,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));k._Menu=y;k.prototype._onContainerKeydown=B("_onContainerKeydown");k.prototype._onContainerKeypress=B("_onContainerKeypress");return k})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t){return k("dijit.form._FormSelectWidget",t,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var b=this.options||[];if(null==a)return b;if(l.isArray(a))return q.map(a,"return this.getOptions(item);",this);l.isString(a)&&(a={value:a});l.isObject(a)&&(q.some(b,function(b,e){for(var c in a)if(!(c in b)||b[c]!=a[c])return!1;a=e;return!0})||(a=-1));return 0<=a&&a<b.length?b[a]:null},addOption:function(a){q.forEach(l.isArray(a)?a:[a],function(a){a&&l.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(l.isArray(a)?
a:[a]);q.forEach(a,function(a){a&&(this.options=q.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){q.forEach(l.isArray(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),c;if(b)for(c in a)b[c]=a[c]},this);this._loadChildren()},setStore:function(a,b,c){s.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,b,c)},_deprecatedSetStore:function(a,b,c){var h=this.store;c=c||{};if(h!==a){for(var k;k=this._notifyConnections.pop();)k.remove();a.get||(l.mixin(a,{_oldAPI:!0,get:function(a){var b=new d;this.fetchItemByIdentity({identity:a,onItem:function(a){b.resolve(a)},onError:function(a){b.reject(a)}});return b.promise},query:function(a,b){var e=new d(function(){c.abort&&c.abort()});e.total=new d;var c=this.fetch(l.mixin({query:a,onBegin:function(a){e.total.resolve(a)},
onComplete:function(a){e.resolve(a)},onError:function(a){e.reject(a)}},b));return new m(e)}}),a.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[g.after(a,"onNew",l.hitch(this,"_onNewItem"),!0),g.after(a,"onDelete",l.hitch(this,"_onDeleteItem"),!0),g.after(a,"onSet",l.hitch(this,"_onSetItem"),!0)]));this._set("store",a)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);c.query&&this._set("query",c.query);c.queryOptions&&this._set("queryOptions",c.queryOptions);a&&a.query&&(this._loadingStore=!0,this.onLoadDeferred=new d,this._queryRes=a.query(this.query,this.queryOptions),r(this._queryRes,l.hitch(this,function(d){if(this.sortByLabel&&!c.sort&&d.length)if(a.getValue)d.sort(f.createSortFunction([{attribute:a.getLabelAttributes(d[0])[0]}],a));else{var h=this.labelAttr;d.sort(function(a,b){return a[h]>b[h]?1:b[h]>
a[h]?-1:0})}c.onFetch&&(d=c.onFetch.call(this,d,c));q.forEach(d,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(l.hitch(this,function(a,b,e){b==e?this._onSetItem(a):(-1!=b&&this._onDeleteItem(a),-1!=e&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:b);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(d):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)}));return h},_setValueAttr:function(a,b){this._onChangeActive||(b=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=l.isArray(a)?q.map(a,function(a){return l.isObject(a)?a:{value:a}}):l.isObject(a)?[a]:[{value:a}];a=q.filter(this.getOptions(a),function(a){return a&&a.value});var c=this.getOptions()||[];if(!this.multiple&&(!a[0]||!a[0].value)&&c.length)a[0]=c[0];q.forEach(c,
function(b){b.selected=q.some(a,function(a){return a.value===b.value})});c=q.map(a,function(a){return a.value});if(!("undefined"==typeof c||"undefined"==typeof c[0])){var d=q.map(a,function(a){return a.label});this._setDisplay(this.multiple?d:d[0]);this.inherited(arguments,[this.multiple?c:c[0],b]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=q.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?a:a[0]},
_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(q.forEach(this._getChildren(),function(a){a.destroyRecursive()}),q.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var b=this;q.forEach(this._getChildren(),function(d){var h=q.some(a,function(a){return d.option&&
a===d.option.value});h&&!b.multiple&&(b.focusedChild=d);c.toggle(d.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),h);d.domNode.setAttribute("aria-selected",h?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var b=q.filter(a,function(a){return a.selected})[0];if(b&&b.value)return b.value;a[0].selected=!0;return a[0].value}return this.multiple?q.map(q.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,b){(!b||!b.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var b=this.store,c=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:b.getLabel(a);return{value:c?b.getIdentity(a):null,label:c,item:a}},_addOptionForItem:function(a){var b=this.store;b.isItemLoaded&&!b.isItemLoaded(a)?b.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);p.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?b("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+s._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);g.after(this,"onChange",l.hitch(this,"_updateSelection"));var a=this.store;if(a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(q,d,g){var f=function(k){function p(d){k[d]=function(){var l=arguments,b=g(k,function(b){Array.prototype.unshift.call(l,b);return f(q[d].apply(q,l))});if("forEach"!==d||c)return b}}if(!k)return k;var c=!!k.then;c&&(k=d.delegate(k));p("forEach");p("filter");
p("map");null==k.total&&(k.total=g(k,function(c){return c.length}));return k};d.setObject("dojo.store.util.QueryResults",f);return f})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(q,d,g,f){return q("dijit.DropDownMenu",f,{templateString:g,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(d){this._moveToPopup(d);d.stopPropagation();d.preventDefault()},
_onLeftArrow:function(d){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else d.stopPropagation(),d.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e){return d("dijit._MenuBase",[m,
e,a,t],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){k.toggle(this.domNode,"dijitMenuActive",a);k.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var b=r.byNode(a);return a.parentNode==this.containerNode&&
b&&b.focus},postCreate:function(){var a=this,e="string"==typeof this.childSelector?this.childSelector:p.hitch(this,"childSelector");this.own(s(this.containerNode,s.selector(e,c.enter),function(){a.onItemHover(r.byNode(this))}),s(this.containerNode,s.selector(e,c.leave),function(){a.onItemUnhover(r.byNode(this))}),s(this.containerNode,s.selector(e,b),function(b){a.onItemClick(r.byNode(this),b);b.stopPropagation()}),s(this.containerNode,s.selector(e,"focusin"),function(){a._onItemFocus(r.byNode(this))}));
this.inherited(arguments)},onKeyboardSearch:function(a,b,e,c){this.inherited(arguments);if(a&&(-1==c||a.popup&&1==c))this.onItemClick(a,b)},_keyboardSearchCompare:function(a,b){return a.shortcutKey?b==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},
_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=
a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&
(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,b){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var e=/^key/.test(b._origType||b.type)||0==b.clientX&&0==b.clientY;this._openItemPopup(a,
e)}else this.onExecute(),a._onClick?a._onClick(b):a.onClick(b)},_openItemPopup:function(a,b){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var e=a.popup;e.parentMenu=this;this.own(this._mouseoverHandle=s.once(e.domNode,"mouseover",p.hitch(this,"_onPopupHover")));var c=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){b&&c.focusChild(a);c._cleanUp()},onExecute:p.hitch(this,
"_cleanUp",!0),onClose:function(){c._mouseoverHandle&&(c._mouseoverHandle.remove(),delete c._mouseoverHandle)}},b);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(f.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),
this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(q,d,g,f,k,p,c,s,l,b){return d("dijit._KeyNavContainer",[l,b,s],{connectKeyNavHandlers:function(b,c){var d=this._keyNavCodes={},a=p.hitch(this,"focusPrev"),e=p.hitch(this,"focusNext");q.forEach(b,function(b){d[b]=a});q.forEach(c,function(a){d[a]=e});d[k.HOME]=p.hitch(this,"focusFirstChild");d[k.END]=p.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){f.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);q.forEach(this.getChildren(),
p.hitch(this,"_startupChild"))},addChild:function(b,c){this.inherited(arguments);this._startupChild(b)},_startupChild:function(b){b.set("tabIndex","-1")},_getFirst:function(){var b=this.getChildren();return b.length?b[0]:null},_getLast:function(){var b=this.getChildren();return b.length?b[b.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(b){return(b=
c.byNode(b))&&b.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(q,d,g,f,k,p,c,s){return d("dijit._KeyNavMixin",s,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);g.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var d=this._keyNavCodes={};d[f.HOME]=k.hitch(this,"focusFirstChild");d[f.END]=k.hitch(this,
"focusLastChild");d[this.isLeftToRight()?f.LEFT_ARROW:f.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");d[this.isLeftToRight()?f.RIGHT_ARROW:f.LEFT_ARROW]=k.hitch(this,"_onRightArrow");d[f.UP_ARROW]=k.hitch(this,"_onUpArrow");d[f.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var b=this,d="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(p(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),p(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),p(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),p(this.containerNode,p.selector(d,"focusin"),function(d){b._onChildFocus(c.getEnclosingWidget(this),d)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(c,b){c&&(this.focusedChild&&c!==this.focusedChild&&this._onChildBlur(this.focusedChild),c.set("tabIndex",this.tabIndex),c.focus(b?"end":"start"))},_onContainerFocus:function(c){c.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){g.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(c){g.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(c){c&&c!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),c.set("tabIndex",this.tabIndex),this.lastFocused=c,this._set("focusedChild",c))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(c,b,d,m){c&&this.focusChild(c)},_keyboardSearchCompare:function(c,b){var d=c.domNode,d=(c.label||(d.focusNode?
d.focusNode.label:"")||d.innerText||d.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&d==b?-1:0},_isFormElement:function(c){return"INPUT"===c.tagName||"TEXTAREA"===c.tagName||"SELECT"===c.tagName||"BUTTON"===c.tagName},_onContainerKeydown:function(c){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[c.keyCode];b?(b(c,this.focusedChild),c.stopPropagation(),c.preventDefault(),this._searchString=""):c.keyCode==f.SPACE&&(this._searchTimer&&
!c.ctrlKey&&!c.altKey&&!c.metaKey)&&(c.stopImmediatePropagation(),c.preventDefault(),this._keyboardSearch(c," "))}},_onContainerKeypress:function(c){if(!this._isFormElement(document.activeElement)&&!(c.charCode<=f.SPACE||c.ctrlKey||c.altKey||c.metaKey))c.preventDefault(),c.stopPropagation(),this._keyboardSearch(c,String.fromCharCode(c.charCode).toLowerCase())},_keyboardSearch:function(c,b){var d=null,m,f=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=b;
var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;m=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var e=this.focusedChild||null;if(1==a||!e)if(e=this._getNextFocusableChild(e,1),!e)return;a=e;do{var c=this._keyboardSearchCompare(e,m);c&&0==f++&&(d=e);if(-1==c){f=-1;break}e=this._getNextFocusableChild(e,1)}while(e!=a)})();this.onKeyboardSearch(d,c,m,f)},_onChildBlur:function(){},
_getNextFocusableChild:function(c,b){var d=c;do{if(c)c=this._getNext(c,b);else if(c=this[0<b?"_getFirst":"_getLast"](),!c)break;if(null!=c&&c!=d&&c.isFocusable())return c}while(c!=d);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(d,b){if(d)for(d=d.domNode;d;)if((d=d[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in d){var f=c.byNode(d);if(f)return f}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m){c=q("dijit.MenuItem"+(p("dojo-bidi")?"_NoBidi":""),[s,l,b,r],{templateString:m,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(b){this._set("label",b);var a="",e;e=b.search(/{\S}/);if(0<=e){var a=b.charAt(e+1),c=b.substr(0,e);b=b.substr(e+3);e=c+a+b;b=c+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+a+"\x3c/span\x3e"+b}else e=b;this.domNode.setAttribute("aria-label",e+" "+this.accelKey);this.containerNode.innerHTML=b;this._set("shortcutKey",a)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(b){b&&!("label"in this.params)&&this._set("label",b.innerHTML)},buildRendering:function(){this.inherited(arguments);g.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&g.set(this.accelKeyNode,"id",this.id+"_accel");d.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==p("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(b){}},_setSelected:function(b){f.toggle(this.domNode,
"dijitMenuItemSelected",b)},setLabel:function(b){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",b)},setDisabled:function(b){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",b)},_setDisabledAttr:function(b){this.focusNode.setAttribute("aria-disabled",b?"true":"false");this._set("disabled",b)},_setAccelKeyAttr:function(b){this.accelKeyNode&&(this.accelKeyNode.style.display=
b?"":"none",this.accelKeyNode.innerHTML=b,g.set(this.containerNode,"colSpan",b?"1":"2"));this._set("accelKey",b)}});p("dojo-bidi")&&(c=q("dijit.MenuItem",c,{_setLabelAttr:function(b){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return c})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(q,d){return q("dijit._Contained",null,{_getSibling:function(g){var f=this.domNode;do f=f[g+"Sibling"];while(f&&1!=f.nodeType);return f&&
d.byNode(f)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var d=this.getParent();return!d||!d.getIndexOfChild?-1:d.getIndexOfChild(this)}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(q,d,g,f,k,p){return q("dijit.MenuSeparator",[g,f,k],{templateString:p,buildRendering:function(){this.inherited(arguments);
d.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare","dojo/keys","./_Spinner","./NumberTextBox"],function(q,d,g,f){return q("dijit.form.NumberSpinner",[g,f.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(d,f){var c=this.constraints,g=isNaN(d),l=!isNaN(c.max),b=!isNaN(c.min);g&&0!=f&&(d=0<f?b?c.min:l?c.max:0:l?this.constraints.max:b?c.min:0);var r=d+f;if(g||isNaN(r))return d;l&&r>
c.max&&(r=c.max);b&&r<c.min&&(r=c.min);return r},_onKeyDown:function(f){if(!this.disabled&&!this.readOnly&&(f.keyCode==d.HOME||f.keyCode==d.END)&&!f.ctrlKey&&(!f.altKey&&!f.metaKey)&&"undefined"!=typeof this.get("value")){var g=this.constraints[f.keyCode==d.HOME?"min":"max"];"number"==typeof g&&this._setValueAttr(g,!1);f.stopPropagation();f.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),
function(q,d,g,f,k,p,c,s,l,b){return q("dijit.form._Spinner",s,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:l,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(b){return b},_arrowPressed:function(c,d,l){!this.disabled&&!this.readOnly&&(this._setValueAttr(this.adjust(this.get("value"),d*l),!1),b.selectInputText(this.textbox,this.textbox.value.length))},
_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(b,c,l){var a=this.smallDelta;c==this.textbox&&(c=l.keyCode,a=c==d.PAGE_UP||c==d.PAGE_DOWN?this.largeDelta:this.smallDelta,c=c==d.UP_ARROW||c==d.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==b?this._arrowReleased(c):this._arrowPressed(c,c==this.upArrowNode?1:-1,a)},_wheelTimer:null,_mouseWheeled:function(b){b.stopPropagation();b.preventDefault();var c=b.wheelDelta/120;Math.floor(c)!=c&&(c=0<b.wheelDelta?1:-1);b=b.detail?
-1*b.detail:c;if(0!==b){var d=this[0<b?"upArrowNode":"downArrowNode"];this._arrowPressed(d,b,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(d)},50)}},_setConstraintsAttr:function(b){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",
this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(b,c){this.focusNode.setAttribute("aria-valuenow",b);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(p(this.domNode,k.wheel,g.hitch(this,"_mouseWheeled")),c.addListener(this.upArrowNode,this.textbox,{keyCode:d.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),c.addListener(this.downArrowNode,
this.textbox,{keyCode:d.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),c.addListener(this.upArrowNode,this.textbox,{keyCode:d.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),c.addListener(this.downArrowNode,this.textbox,{keyCode:d.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",
this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(q,d,g){return q("dijit.form.RangeBoundTextBox",g,{rangeMessage:"",rangeCheck:function(d,k){return("min"in k?0<=this.compare(d,k.min):!0)&&("max"in k?0>=this.compare(d,k.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var d=
this.get("value");if(null==d)return!1;var k=!1;"min"in this.constraints&&(k=this.constraints.min,k=0>this.compare(d,"number"==typeof k&&0<=k&&0!=d?0:k));!k&&"max"in this.constraints&&(k=this.constraints.max,k=0<this.compare(d,"number"!=typeof k||0<k?k:0));return k},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(d){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(d))},getErrorMessage:function(d){var k=
this.get("value");return null!=k&&""!==k&&("number"!=typeof k||!isNaN(k))&&!this.isInRange(d)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=d.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(q,d,g,f){return q("dijit.form.MappedTextBox",
f,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(d){return d.toString?d.toString():""},toString:function(){var d=this.filter(this.get("value"));return null!=d?"string"==typeof d?d:this.serialize(d,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=g.place("\x3cinput type\x3d'hidden'"+(this.name&&
!d("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(q,d,g,f,k,p){var c=function(c){c=c||{};var b=g.getLocalization("dojo.cldr","number",g.normalizeLocale(c.locale)),d=c.pattern?c.pattern:b[(c.type||"decimal")+"Format"];c="number"==
typeof c.places?c.places:-1!=d.indexOf(b.decimal)?d.split(b.decimal)[1].replace(/[^#0]/g,"").length:0;return{sep:b.decimal,places:c}},s=q("dijit.form.NumberTextBoxMixin",null,{pattern:function(c){return"("+(this.focused&&this.editOptions?this._regExpGenerator(d.delegate(c,this.editOptions))+"|":"")+this._regExpGenerator(c)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:k.format,_regExpGenerator:k.regexp,_decimalInfo:c(),postMixInProperties:function(){this.inherited(arguments);this._set("type",
"text")},_setConstraintsAttr:function(d){var b="number"==typeof d.places?d.places:0;b&&b++;"number"!=typeof d.max&&(d.max=9*Math.pow(10,15-b));"number"!=typeof d.min&&(d.min=-9*Math.pow(10,15-b));this.inherited(arguments,[d]);this.focusNode&&(this.focusNode.value&&!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=c(d)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var c=this.get("value");"number"==typeof c&&!isNaN(c)&&(c=this.format(c,this.constraints),void 0!==c&&(this.textbox.value=
c));this.inherited(arguments)}},format:function(c,b){var f=String(c);if("number"!=typeof c)return f;if(isNaN(c))return"";if(!("rangeCheck"in this&&this.rangeCheck(c,b))&&!1!==b.exponent&&/\de[-+]?\d/i.test(f))return f;this.editOptions&&this.focused&&(b=d.mixin({},b,this.editOptions));return this._formatter(c,b)},_parser:k.parse,parse:function(c,b){var f=this._parser(c,d.mixin({},b,this.editOptions&&this.focused?this.editOptions:{}));this.editOptions&&(this.focused&&isNaN(f))&&(f=this._parser(c,b));
return f},_getDisplayedValueAttr:function(){var c=this.inherited(arguments);return isNaN(c)?this.textbox.value:c},filter:function(c){if(null==c||"string"==typeof c&&""==c)return NaN;"number"==typeof c&&(!isNaN(c)&&0!=c)&&(c=k.round(c,this._decimalInfo.places));return this.inherited(arguments,[c])},serialize:function(c,b){return"number"!=typeof c||isNaN(c)?"":this.inherited(arguments)},_setBlurValue:function(){var c=d.hitch(d.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(c,!0)},_setValueAttr:function(c,
b,d){if(void 0!==c&&void 0===d)if(d=String(c),"number"==typeof c)if(isNaN(c))d="";else{if("rangeCheck"in this&&this.rangeCheck(c,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(d))d=void 0}else c?c=void 0:(d="",c=NaN);this.inherited(arguments,[c,b,d])},_getValueAttr:function(){var c=this.inherited(arguments);if(isNaN(c)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+k._realNumberRegexp(d.delegate(this.constraints))+
"$").test(this.textbox.value))return c=Number(this.textbox.value),isNaN(c)?void 0:c}else return c},isValid:function(c){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var b=this.get("value");return!isNaN(b)&&this.rangeCheck(b,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var c="number"==typeof this.constraints.min,b="number"==typeof this.constraints.max,d=this.get("value");
if(isNaN(d)||!c&&!b)return this.inherited(arguments);var m=d|0,k=0>d,a=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),e=(this.maxLength||20)-this.textbox.value.length,n=a?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",m=a?m+"."+n:m+"",e=f.rep("9",e),a=d;k?a=Number(m+e):d=Number(m+e);return!(c&&d<this.constraints.min||b&&a>this.constraints.max)}});q=q("dijit.form.NumberTextBox",[p,s],{baseClass:"dijitTextBox dijitNumberTextBox"});q.Mixin=s;return q})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/ColorPalette dijit/popup".split(" "),
function(q,d,g,f,k,p,c,s,l,b){return q([d,g],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",color:null,postCreate:function(){this.inherited(arguments);this.color?this.color instanceof c||(this.color=new c(this.color)):this.color=new c("#ccc");k.setStyle(this.domNode,"backgroundColor",this.color.toHex());this._createTooltipDialog(this.domNode)},_createTooltipDialog:function(d){var m=k.create("div"),g=new s({style:"width: 250px;cursor:pointer",
content:m}),a=new l({palette:"7x10",cellClass:"cursor:pointer",onChange:f.hitch(this,function(a){k.setStyle(d,"backgroundColor",a);b.close(g);this.color=new c(a);this.onChange(this.color)})});a.placeAt(m);a.startup();this.own(p(d,"click",f.hitch(this,function(a){a.stopPropagation();a.preventDefault();b.open({parent:this.getParent(),popup:g,around:d})})));this.own(p(window,"click",f.hitch(this,function(a){a=a.target||a.srcElement;var c=g.domNode;a===c||k.isDescendant(a,c)||b.close(g)})));return g},
setColor:function(b){if(b instanceof c){var d=this.color,f="";d&&(f=d.toHex());d=b.toHex();this.color=b;k.setStyle(this.domNode,"backgroundColor",d);if(f!==d)this.onChange(new c(d))}},getColor:function(){return this.color},onChange:function(b){}})})},"dijit/ColorPalette":function(){define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r){var m=l("dijit.ColorPalette",[g,f,k],{palette:"7x10",_palettes:{"7x10":["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),
"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),"black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},templateString:d,baseClass:"dijitColorPalette",_dyeFactory:function(b,a,e,c){return new this._dyeClass(b,
a,e,c)},buildRendering:function(){this.inherited(arguments);this._dyeClass=l(m._Color,{palette:this.palette});this._preparePalette(this._palettes[this.palette],c.getLocalization("dojo","colors",this.lang))}});m._Color=l("dijit._Color",s,{template:"\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e",hcTemplate:"\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
_imagePaths:{"7x10":q.toUrl("./themes/a11y/colors7x10.png"),"3x4":q.toUrl("./themes/a11y/colors3x4.png")},constructor:function(b,a,e,c){this._title=c;this._row=a;this._col=e;this.setColor(s.named[b])},getValue:function(){return this.toHex()},fillCell:function(c,a){var e=r.substitute(p("highcontrast")?this.hcTemplate:this.template,{color:this.toHex(),blankGif:a,alt:this._title,title:this._title,image:this._imagePaths[this.palette].toString(),left:-20*this._col-5,top:-20*this._row-5,size:"7x10"==this.palette?
"height: 145px; width: 206px":"height: 64px; width: 86px"});b.place(e,c)}});return m})},"dijit/_PaletteMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "),function(q,d,g,f,k,p,c,s,l,b,r){return q("dijit._PaletteMixin",s,{defaultTimeout:500,timeoutChangeRate:0.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(b){return new ("string"==
typeof this.dyeClass?p.getObject(this.dyeClass):this.dyeClass)(b)},_preparePalette:function(b,d){this._cells=[];var a=this._blankGif;this.own(c(this.gridNode,l,p.hitch(this,"_onCellClick")));for(var e=0;e<b.length;e++)for(var n=f.create("tr",{tabIndex:"-1",role:"row"},this.gridNode),h=0;h<b[e].length;h++){var g=b[e][h];if(g){var s=this._dyeFactory(g,e,h,d[g]),g=f.create("td",{"class":this.cellClass,tabIndex:"-1",title:d[g],role:"gridcell"},n);s.fillCell(g,a);g.idx=this._cells.length;this._cells.push({node:g,
dye:s})}}this._xDim=b[0].length;this._yDim=b.length;var q={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1},y;for(y in q)this.own(r.addKeyListener(this.domNode,{keyCode:k[y],ctrlKey:!1,altKey:!1,shiftKey:!1},this,function(){var a=q[y];return function(b){this._navigateByKey(a,b)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments);this._setCurrent(this._cells[0].node)},focus:function(){b.focus(this._currentFocus)},
_onCellClick:function(c){for(var d=c.target;"TD"!=d.tagName;){if(!d.parentNode||d==this.gridNode)return;d=d.parentNode}var a=this._getDye(d).getValue();this._setCurrent(d);b.focus(d);this._setValueAttr(a,!0);c.stopPropagation();c.preventDefault()},_setCurrent:function(b){"_currentFocus"in this&&d.set(this._currentFocus,"tabIndex","-1");(this._currentFocus=b)&&d.set(b,"tabIndex",this.tabIndex)},_setValueAttr:function(b,c){0<=this._selectedCell&&g.remove(this._cells[this._selectedCell].node,this.cellClass+
"Selected");this._selectedCell=-1;if(b)for(var a=0;a<this._cells.length;a++)if(b==this._cells[a].dye.getValue()){this._selectedCell=a;g.add(this._cells[a].node,this.cellClass+"Selected");break}this._set("value",0<=this._selectedCell?b:null);if(c||void 0===c)this.onChange(b)},onChange:function(){},_navigateByKey:function(c,d){if(-1!=d){var a=this._currentFocus.idx+c;a<this._cells.length&&-1<a&&(a=this._cells[a].node,this._setCurrent(a),this.defer(p.hitch(b,"focus",a)))}},_getDye:function(b){return this._cells[b.idx].dye}})})},
"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(q,d,g,f){var k={};d.setObject("dojo.colors",k);var p=function(c,d,b){0>b&&++b;1<b&&--b;var f=6*b;return 1>f?c+(d-c)*f:1>2*b?d:2>3*b?c+6*(d-c)*(2/3-b):c};q.colorFromRgb=g.fromRgb=function(c,d){var b=c.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(b){var k=b[2].split(/\s*,\s*/),m=k.length,b=b[1];if("rgb"==b&&3==m||"rgba"==b&&4==m)return b=k[0],"%"==b.charAt(b.length-1)?(b=f.map(k,
function(a){return 2.56*parseFloat(a)}),4==m&&(b[3]=k[3]),g.fromArray(b,d)):g.fromArray(k,d);if("hsl"==b&&3==m||"hsla"==b&&4==m){var b=(parseFloat(k[0])%360+360)%360/360,t=parseFloat(k[1])/100,a=parseFloat(k[2])/100,t=0.5>=a?a*(t+1):a+t-a*t,a=2*a-t,b=[256*p(a,t,b+1/3),256*p(a,t,b),256*p(a,t,b-1/3),1];4==m&&(b[3]=k[3]);return g.fromArray(b,d)}}return null};var c=function(c,d,b){c=Number(c);return isNaN(c)?b:c<d?d:c>b?b:c};g.prototype.sanitize=function(){this.r=Math.round(c(this.r,0,255));this.g=Math.round(c(this.g,
0,255));this.b=Math.round(c(this.b,0,255));this.a=c(this.a,0,1);return this};k.makeGrey=g.makeGrey=function(c,d){return g.fromArray([c,c,c,d])};d.mixin(g.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,
149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,
0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],
lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,
0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,
250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return g})},"jimu/dijit/_Transparency":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/_Transparency.html dojo/_base/lang dojo/_base/html dojo/on dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dijit/form/HorizontalRule".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m){return q([d,g,f,k],{baseClass:"jimu-transparency",declaredClass:"jimu.dijit.Transparency",templateString:p,nls:null,alpha:1,postMixInProperties:function(){this.nls=window.jimuNls.transparency},postCreate:function(){this.inherited(arguments);"number"===typeof this.alpha&&this.setAlpha(this.alpha)},setAlpha:function(b){b=Math.round(100-100*b);this.opacitySlider.set("value",b)},getAlpha:function(){return Math.round(100-this.opacitySlider.get("value"))/100},_onAlphaChanged:function(){var b=
this.getAlpha();this.emit("change",b)}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y){var w=d("dijit.form._SliderMover",
r,{onMouseMove:function(a){var b=this.widget,e=b._abspos;e||(e=b._abspos=k.position(b.sliderBarContainer,!0),b._setPixelValue_=s.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-e[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?e[b._pixelCount]-a:a,e[b._pixelCount],!1)},destroy:function(a){r.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,!0)}});g=d("dijit.form.HorizontalSlider",[A,B],{templateString:y,value:0,
showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:e.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(a){!this.disabled&&(!this.readOnly&&!a.altKey&&
!a.ctrlKey&&!a.metaKey)&&this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!this.disabled&&!this.readOnly&&!a.altKey&&!a.ctrlKey&&!a.metaKey){switch(a.keyCode){case c.HOME:this._setValueAttr(this.minimum,!1);break;case c.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?c.RIGHT_ARROW:c.LEFT_ARROW:case !1===this._descending?c.DOWN_ARROW:c.UP_ARROW:case !1===this._descending?c.PAGE_DOWN:c.PAGE_UP:this.increment(a);break;case this._descending||this.isLeftToRight()?
c.LEFT_ARROW:c.RIGHT_ARROW:case !1===this._descending?c.UP_ARROW:c.DOWN_ARROW:case !1===this._descending?c.PAGE_UP:c.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){!this.disabled&&!this.readOnly&&(l("ie")||n.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&this.clickSelect){n.focus(this.sliderHandle);a.stopPropagation();
a.preventDefault();var b=k.position(this.sliderBarContainer,!0),e=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-e:e,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,e){if(!this.disabled&&!this.readOnly){var c=this.discreteValues;if(1>=c||Infinity==c)c=b;c--;a=Math.round(a/(b/c));this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*a/c+this.minimum,this.maximum),this.minimum),e)}},_setValueAttr:function(a,
b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var e=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,c=!1===this._descending?this.remainingBar:this.progressBar,d=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&c.style[this._progressPixelSize]){var h=this,m={},l=parseFloat(c.style[this._progressPixelSize]),
k=this.slideDuration*(e-l/100);0!=k&&(0>k&&(k=0-k),m[this._progressPixelSize]={start:l,end:100*e,units:"%"},this._inProgressAnim=f.animateProperty({node:c,duration:k,onAnimate:function(a){d.style[h._progressPixelSize]=100-parseFloat(a[h._progressPixelSize])+"%"},onEnd:function(){delete h._inProgressAnim},properties:m}),this._inProgressAnim.play())}else c.style[this._progressPixelSize]=100*e+"%",d.style[this._progressPixelSize]=100*(1-e)+"%"},_bumpValue:function(a,b){if(!this.disabled&&!(this.readOnly||
this.maximum<=this.minimum)){var e=p.getComputedStyle(this.sliderBarContainer),c=k.getContentBox(this.sliderBarContainer,e),e=this.discreteValues;if(1>=e||Infinity==e)e=c[this._pixelCount];e--;c=(this.value-this.minimum)*e/(this.maximum-this.minimum)+a;0>c&&(c=0);c>e&&(c=e);c=c*(this.maximum-this.minimum)/e+this.minimum;this._setValueAttr(c,b)}},_onClkBumper:function(a){!this.disabled&&(!this.readOnly&&this.clickSelect)&&this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===
this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==c.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==c.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){a.stopPropagation();a.preventDefault();this._bumpValue(0>a.wheelDelta?-1:1,!0)},startup:function(){this._started||(q.forEach(this.getChildren(),function(a){this[a.container]!=
this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,e){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](e)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display="");var a=m('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+
"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(h.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),h.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(a(this.domNode,t.wheel,s.hitch(this,"_mouseWheeled")));var e=d(w,{widget:this});this._movable=
new b(this.sliderHandle,{mover:e});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});g._Mover=w;return g})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(q,d,g,f,k,p){q=q("dijit.form.HorizontalRuleLabels",p,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',
labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(c){return c},_genHTML:function(c,d){var f=this.labels[d];return this._positionPrefix+this._calcPosition(c)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(f)+this._labelPrefix+
f+this._suffix},_genDirectionHTML:function(c){return""},getLabels:function(){var c=this.labels;!c.length&&this.srcNodeRef&&(c=f("\x3e li",this.srcNodeRef).map(function(b){return String(b.innerHTML)}));if(!c.length&&1<this.count)for(var d=this.minimum,l=(this.maximum-d)/(this.count-1),b=0;b<this.count;b++)c.push(b<this.numericMargin||b>=this.count-this.numericMargin?"":g.format(d,this.constraints)),d+=l;return c},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();
this.count=this.labels.length}});d("dojo-bidi")&&q.extend({_setTextDirAttr:function(c){this.textDir!=c&&(this._set("textDir",c),f(".dijitRuleLabelContainer",this.domNode).forEach(k.hitch(this,function(c){c.style.direction=this.getTextDir(c.innerText||c.textContent||"")})))},_genDirectionHTML:function(c){return this.textDir?"direction:"+this.getTextDir(c)+";":""}});return q})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(q,d,g){return q("dijit.form.HorizontalRule",
[d,g],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(d){return this._positionPrefix+d+this._positionSuffix+this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var d;if(1==this.count)d=this._genHTML(50,0);else{var k,
g=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){d=this._genHTML(0,0);for(k=1;k<this.count-1;k++)d+=this._genHTML(g*k,k);d+=this._genHTML(100,this.count-1)}else{d=this._genHTML(100,0);for(k=1;k<this.count-1;k++)d+=this._genHTML(100-g*k,k);d+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=d}})})},"jimu/dijit/Search":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/string dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(q,d,g,f,k,p,c,s){return q([c,s],{baseClass:"jimu-search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',placeholder:"",
onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&g.setAttr(this.inputSearch,"placeholder",this.placeholder)},doSearch:function(){if(this.onSearch)this.onSearch(p.trim(this.inputSearch.value))},_onKeyDown:function(c){13===(void 0!==c.keyCode?c.keyCode:c.which)&&this.doSearch();c.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},"jimu/dijit/Selectionbox":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dojo/_base/lang","dojo/on","dojo/dom-class"],function(q,d,g,f,k){return q(d,{baseClass:"jimu-selection-box",selected:!1,postCreate:function(){this.selected&&k.add(this.domNode,"jimu-selection-box-selected");this.own(f(this.domNode,"click",g.hitch(this,function(){this.selected?this.unSelect():this.select()})))},select:function(){this.selected=!0;k.add(this.domNode,"jimu-selection-box-selected");this.onStateChange()},unSelect:function(){this.selected=!1;k.remove(this.domNode,"jimu-selection-box-selected");
this.onStateChange()},onStateChange:function(){}})})},"jimu/dijit/ServiceURLInput":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),function(q,d,g,f,k,p,c,s,l){return q([l],{_validatingNode:null,_validNode:null,_inValidNode:null,_fetchHandle:null,_fetchErrHandle:null,verify:!0,postCreate:function(){this.inherited(arguments);this._validatingNode=d.create("div",{"class":"jimu-service-validating"},
this.domNode);this._validNode=d.create("div",{"class":"jimu-service-valid"},this.domNode);this._inValidNode=d.create("div",{"class":"jimu-service-invalid"},this.domNode);d.addClass(this.domNode,"jimu-serviceurl-input");this.verify&&this.own(f(this,"Change",g.hitch(this,"_onServiceUrlChange")))},setProcessFunction:function(b,d){this._fetchHandle&&this._fetchErrHandle&&this._removeProcessFunction();"function"===typeof b&&(this._fetchHandle=c.after(this,"onFetch",b),this.own(this._fetchHandle));"function"===
typeof d&&(this._fetchErrHandle=c.after(this,"onFetchError",d),this.own(this._fetchErrHandle))},_removeProcessFunction:function(){this._fetchHandle&&this._fetchHandle.remove&&(this._fetchHandle.remove(),this._fetchHandle=null);this._fetchErrHandle&&this._fetchErrHandle.remove&&(this._fetchErrHandle.remove(),this._fetchErrHandle=null)},onFetch:function(b){return b},onFetchError:function(b){},_onServiceUrlChange:function(b){var c=new p;c.then(g.hitch(this,function(){this._valid()}),g.hitch(this,function(){this._inValid();
this.onFetchError()}));this._validating();s({url:g.trim(b||""),handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(g.hitch(this,function(b){this.onFetch({url:this.getValue(),data:b})?c.resolve("success"):c.reject("error")}),g.hitch(this,function(b){c.reject(b)}))},_hideStatus:function(){d.setStyle(this._validNode,{display:"none"});d.setStyle(this._inValidNode,{display:"none"});d.setStyle(this._validatingNode,{display:"none"})},_validating:function(){d.setStyle(this._validNode,{display:"none"});
d.setStyle(this._inValidNode,{display:"none"});d.setStyle(this._validatingNode,{display:"inline-block"});d.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_valid:function(){d.setStyle(this._validNode,{display:"inline-block"});d.setStyle(this._inValidNode,{display:"none"});d.setStyle(this._validatingNode,{display:"none"});d.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_inValid:function(){d.setStyle(this._validNode,{display:"none"});d.setStyle(this._inValidNode,{display:"inline-block"});
d.setStyle(this._validatingNode,{display:"none"});d.addClass(this.domNode,"jimu-serviceurl-input-invalid")}})})},"jimu/dijit/SimpleTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/mouse jimu/utils".split(" "),function(q,d,g,f,k,p,c,s,l,b,r){return q([d,g,f],{baseClass:"jimu-simple-table",declaredClass:"jimu.dijit.SimpleTable",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"tableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" onselectstart\x3d"return false;"\x3e\x3ccolgroup\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead"\x3e\x3c/thead\x3e\x3ctbody class\x3d"simple-table-tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
_name:null,_rowIndex:0,REPEATING_ERROR:"REPEATING_ERROR",autoHeight:!0,selectable:!1,fields:null,postMixInProperties:function(){this.nls=window.jimuNls.simpleTable},postCreate:function(){this.inherited(arguments);this._initSelf()},startup:function(){this.inherited(arguments);this._updateUI()},_updateUI:function(){if(this.autoHeight){var b=this.getRows();p.setStyle(this.domNode,"height",40*((0<b.length?b.length:1)+1)+1+"px")}this._updateHeadDiv()},_updateHeadDiv:function(){p.empty(this.headDiv);var b=
k.clone(this.tableDiv),d=l("input[type\x3dradio]",b);c.forEach(d,function(a){a.name="0"});p.place(b,this.headDiv)},_initSelf:function(){this._initAttachPoints();this.selectable&&this.own(r.bindClickAndDblclickEvents(this.table,k.hitch(this,function(a){if(a=r.getAncestorDom(a.target||a.srcElement,function(a){return p.hasClass(a,"simple-table-tr")&&p.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onClickRow(a)}),k.hitch(this,function(a){if(a=r.getAncestorDom(a.target||a.srcElement,function(a){return p.hasClass(a,
"simple-table-tr")&&p.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onDblClickRow(a)})));var b=Math.random().toString();this._name="jimu_table_"+b.slice(2,b.length);this.thead=l("thead",this.domNode)[0];this.tbody=l("tbody",this.domNode)[0];if(this.fields&&0<this.fields.length){var d=p.create("tr",{},this.thead);c.forEach(this.fields,k.hitch(this,function(a){var b="auto";"actions"===a.type&&(a.name="actions");a.hidden?b=1:void 0!==a.width&&null!==a.width?b=a.width:"actions"===a.type&&
!a.name&&(a.width=this._calculateActionsWidth(a)+20,b=a.width);p.create("col",{width:b},this.colgroup);b=p.create("th",{innerHTML:a.title,title:a.title},d);a.hidden&&p.addClass(b,"hidden-column");a["class"]&&p.addClass(b,a["class"]);p.addClass(b,a.name)}))}else this.fields=null},_initAttachPoints:function(){this.table=l("table",this.bodyDiv)[0];this.colgroup=l("colgroup",this.bodyDiv)[0];this.head=l("thead",this.bodyDiv)[0];this.tbody=l("tbody",this.bodyDiv)[0]},clear:function(){var b=this._getNotEmptyRows();
p.empty(this.tbody);c.forEach(b,k.hitch(this,function(b){this._onDeleteRow(b)}));this._updateUI();this._rowIndex=0;this._onClearRows(b)},addRows:function(b){var d=[];this.fields&&b instanceof Array&&c.forEach(b,k.hitch(this,function(a){d.push(this.addRow(a,!0))}));this._updateUI();return d},addRow:function(b,d){this._rowIndex++;var a={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof b)return a;var e=c.filter(this.fields,k.hitch(this,function(a){return"text"===
a.type&&!0===a.unique})),e=c.filter(e,k.hitch(this,function(a){return 0<this.getRowDataArrayByFieldValue(a.name,b[a.name]).length}));if(0<e.length)return a.errorCode=this.REPEATING_ERROR,a.errorMessage="repeating data",a.repeatFields=e,a;var f=p.create("tr",{"class":"simple-table-tr not-empty"},this.tbody);p.setAttr(f,"rowId","row"+this._rowIndex);c.forEach(this.fields,k.hitch(this,function(a){var e=b[a.name],c=a.type,d=null;"actions"===c?this._createActionsTd(f,a):("text"===c?d=this._createTextTd(f,
a,e):"radio"===c?d=this._createRadioTd(f,a,e):"checkbox"===c?d=this._createCheckboxTd(f,a,e):"empty"===c?d=this._createEmptyTd(f,a):"extension"===c&&(d=this._createExtensionTd(f,a,e)),a.hidden&&p.addClass(d,"hidden-column"))}));d||(this._setRowOdevity(),this._updateUI());a.success=!0;a.tr=f;a.errorMessage=null;this._onAddRow(f);return a},deleteRow:function(b){b&&(p.destroy(b),this._setRowOdevity(),this._updateUI(),this._onDeleteRow(b))},selectRow:function(b){l(".simple-table-tr",this.tbody).removeClass("selected");
p.addClass(b,"selected");this._onSelectRow(b)},_setRowOdevity:function(){var b=l(".simple-table-tr",this.tbody);b.removeClass("odd");b.removeClass("even");c.forEach(b,k.hitch(this,function(b,a){0===a%2?p.addClass(b,"odd"):p.addClass(b,"even")}))},_createTextTd:function(b,c,a){var e=null;return e=c.editable?this._createEditableTextTd(b,c,a):this._createNormalTextTd(b,c,a)},_createNormalTextTd:function(b,c,a){var e=p.toDom('\x3ctd class\x3d"simple-table-td normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e');
p.addClass(e,c.name);l("div",e)[0].innerHTML=a||"";c["class"]&&p.addClass(e,c["class"]);p.place(e,b);return e},_createEditableTextTd:function(b,c,a){var e=p.toDom('\x3ctd class\x3d"editable-text-td '+c.name+'"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e');p.addClass(e,"simple-table-td");p.place(e,b);c["class"]&&p.addClass(e,c["class"]);var d=l("div",e)[0],h=l("input",e)[0];d.innerHTML=a||"";""!==d.innerHTML&&
(d.title=d.innerHTML);h.value=d.innerHTML;this.own(s(d,"dblclick",k.hitch(this,function(a){a.stopPropagation();h.value=d.innerHTML;p.setStyle(d,"display","none");p.setStyle(h,"display","inline");h.focus();this._updateUI()})));this.own(s(h,"blur",k.hitch(this,function(){h.value=k.trim(h.value);var a=d.innerHTML,e=h.value;""!==e?c.unique?0<this.getRowDataArrayByFieldValue(c.name,e,b).length?h.value=a:d.innerHTML=e:d.innerHTML=e:h.value=a;p.setStyle(h,"display","none");p.setStyle(d,"display","block");
this._updateUI()})));return e},_createRadioTd:function(b,c,a){var e=p.toDom('\x3ctd class\x3d"radio-td '+c.name+'"\x3e\x3cinput type\x3d"radio" /\x3e\x3c/td\x3e');p.addClass(e,"simple-table-td");p.place(e,b);c["class"]&&p.addClass(e,c["class"]);b=l("input",e)[0];b.name=c.radio&&"row"===c.radio?this._name+this._rowIndex:this._name+c.name;b.checked=!0===a;return e},_createCheckboxTd:function(b,c,a){var e=p.toDom('\x3ctd class\x3d"checkbox-td '+c.name+'"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3c/td\x3e');
p.addClass(e,"simple-table-td");p.place(e,b);c["class"]&&p.addClass(e,c["class"]);l("input",e)[0].checked=!0===a;return e},_createActionsTd:function(b,d){var a=p.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent"\x3e\x3c/div\x3e\x3c/td\x3e');p.addClass(a,"simple-table-td");var e=l(".action-item-parent",a)[0];p.place(a,b);d["class"]&&p.addClass(a,d["class"]);c.forEach(d.actions,k.hitch(this,function(a){"up"===a?(a=p.create("div",{"class":"action-item row-up-div"},e),a.title=
this.nls.moveUp,this.own(s(a,"click",k.hitch(this,function(a){a.stopPropagation();if(this.onBeforeRowUp(b)){a=l(".simple-table-tr",this.tbody);var e=c.indexOf(a,b);0<e&&(a=a[e-1])&&p.place(b,a,"before");this._setRowOdevity();this._updateUI()}})))):"down"===a?(a=p.create("div",{"class":"action-item row-down-div"},e),a.title=this.nls.moveDown,this.own(s(a,"click",k.hitch(this,function(a){a.stopPropagation();if(this.onBeforeRowDown(b)){a=l(".simple-table-tr",this.tbody);var e=c.indexOf(a,b);e<a.length-
1&&(a=a[e+1])&&p.place(b,a,"after");this._setRowOdevity();this._updateUI()}})))):"edit"===a?(a=p.create("div",{"class":"action-item row-edit-div"},e),a.title=this.nls.edit,this.own(s(a,"click",k.hitch(this,function(a){a.stopPropagation();this.onBeforeRowEdit(b)&&(this._updateUI(),this._onActionsEdit(b))})))):"delete"===a&&(a=p.create("div",{"class":"action-item row-delete-div"},e),a.title=this.nls.deleteRow,this.own(s(a,"click",k.hitch(this,function(a){a.stopPropagation();this.onBeforeRowDelete(b)&&
this.deleteRow(b)}))))}));var f=this._calculateActionsWidth(d)+"px";p.setStyle(e,"width",f);return a},_calculateActionsWidth:function(b){return 20*c.map(b.actions,function(b){return"up"===b||"down"===b||"edit"===b||"delete"===b}).length},_createEmptyTd:function(b,c){var a=p.create("td",{"class":c.name},b);p.addClass(a,"simple-table-td");p.addClass(a,"empty-text-td");c["class"]&&p.addClass(a,c["class"]);return a},_createExtensionTd:function(b,c,a){b=p.create("td",{"class":c.name},b);p.addClass(b,"simple-table-td");
p.addClass(b,"extension-td");c["class"]&&p.addClass(b,c["class"]);c.create&&"function"===typeof c.create&&c.create(b);c.setValue&&"function"===typeof c.setValue&&c.setValue(b,a);return b},editRow:function(b,d){var a={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof d||!p.isDescendant(b,this.tbody))return a;var e=k.mixin([],this.fields),e=c.filter(e,k.hitch(this,function(a){return"text"===a.type&&!0===a.unique})),e=c.filter(e,k.hitch(this,function(a){return 0<
this.getRowDataArrayByFieldValue(a.name,d[a.name],b).length}));if(0<e.length)return a.errorCode=this.REPEATING_ERROR,a.errorMessage="repeating data",a.repeatFields=e,a;var f=l(".simple-table-td",b);c.forEach(this.fields,k.hitch(this,function(a,b){if(d.hasOwnProperty(a.name)){var e=f[b],c=d[a.name],m=a.type;"text"===m?a.editable?this._editEditableText(e,a,c):this._editNormalText(e,a,c):"radio"===m?this._editRadio(e,a,c):"checkbox"===m?this._editCheckbox(e,a,c):"extension"===m&&this._editExtension(e,
a,c)}}));a.success=!0;a.tr=b;a.errorMessage=null;this._onEditRow(b);return a},_editNormalText:function(b,c,a){b=l("div",b)[0];b.innerHTML=a||"";b.title=b.innerHTML},_editEditableText:function(b,c,a){c=l("div",b)[0];c.innerHTML=a||"";l("input",b)[0].value=c.innerHTML},_editRadio:function(b,c,a){l("input",b)[0].checked=!0===a},_editCheckbox:function(b,c,a){l("input",b)[0].checked=!0===a},_editExtension:function(b,c,a){c.setValue&&"function"===typeof c.setValue&&c.setValue(b,a)},_getAllRows:function(){return l(".simple-table-tr",
this.tbody)},_getNotEmptyRows:function(){var b=this._getAllRows();return c.filter(b,k.hitch(this,function(b){return!p.hasClass(b,"empty")}))},_getEmptyRows:function(){var b=this._getAllRows();return c.filter(b,k.hitch(this,function(b){return p.hasClass(b,"empty")}))},getRows:function(){return this._getNotEmptyRows()},getSelectedRow:function(){var b=null,d=l(".simple-table-tr",this.tbody),d=c.filter(d,k.hitch(this,function(a){return!p.hasClass(a,"empty")&&p.hasClass(a,"selected")}));0<d.length&&(b=
d[0]);return b},getSelectedRowData:function(){var b=null,c=this.getSelectedRow();c&&(b=this._getRowDataByTr(c));return b},getData:function(b){var d=this._getNotEmptyRows();b&&(d=c.filter(d,k.hitch(this,function(a){return a!==b})));return c.map(d,k.hitch(this,function(a){return this._getRowDataByTr(a)}))},getRowData:function(b){return this._getRowDataByTr(b)},_getRowDataByTr:function(b){var d=null;if(b)d={};else return null;c.forEach(this.fields,k.hitch(this,function(a){var e=a.type;if("actions"!==
e){var c=a.name;d[c]=null;var h=l("."+c,b)[0];h&&("text"===e?(a=l("div",h)[0],d[c]=a.innerHTML):"radio"===e?(a=l("input",h)[0],d[c]=a.checked):"checkbox"===e?(a=l("input",h)[0],d[c]=a.checked):"extension"===e&&a.getValue&&"function"===typeof a.getValue&&(d[c]=a.getValue(h,a)))}}));return d},getRowDataArrayByFieldValue:function(b,d,a){var e=[];if(!this.fields||!c.some(this.fields,k.hitch(this,function(a){return a.name===b})))return[];a=this.getData(a);return e=c.filter(a,k.hitch(this,function(a){return a[b]==
d}))},_onClickRow:function(b){this.emit("row-click",b)},_onDblClickRow:function(b){this.emit("row-dblclick",b)},_onSelectRow:function(b){this.emit("row-select",b)},_onAddRow:function(b){this.emit("row-add",b)},_onEditRow:function(b){this.emit("row-edit",b)},_onDeleteRow:function(b){this.emit("row-delete",b)},_onEnterRow:function(b){this.emit("row-enter",b)},_onClearRows:function(b){this.emit("rows-clear",b)},_onActionsEdit:function(b){this.emit("actions-edit",b)},onBeforeRowUp:function(b){return!0},
onBeforeRowDown:function(b){return!0},onBeforeRowEdit:function(b){return!0},onBeforeRowDelete:function(b){return!0}})})},"jimu/dijit/TabContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dojo/NodeList-manipulate dijit/_WidgetBase dijit/_TemplatedMixin ./ViewStack ../utils".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m){return q([l,b,p],{"class":"jimu-tab",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"control" data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);if(0!==this.tabs.length){this.controlNodes=[];this.viewStack=new r(null,this.containerNode);var b=100*(1/this.tabs.length);this.isNested&&f.addClass(this.domNode,"nested");g.forEach(this.tabs,function(a){this._createTab(a,b)},this)}},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title);m.setVerticalCenter(this.domNode)},_createTab:function(b,a){var e;e=f.create("div",{innerHTML:b.title,
"class":"tab jimu-vcenter-text",style:{width:this.isNested?"auto":a+"%"},label:b.title},this.controlNode);this.viewStack.viewType=b.content.domNode?"dijit":"dom";b.content.label=b.title;this.viewStack.addView(b.content);this.own(k(e,"click",d.hitch(this,this.onSelect,b.title)));e.label=b.title;this.controlNodes.push(e)},onSelect:function(b){this.selectTab(b)},selectTab:function(b){this._selectControl(b);this.viewStack.switchView(b);this.emit("tabChanged",b)},_selectControl:function(b){g.forEach(this.controlNodes,
function(a){f.removeClass(a,"jimu-state-selected");a.label===b&&f.addClass(a,"jimu-state-selected")})}})})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(q,d,g,f,k){function p(c){for(;c.childNodes[0]&&1==c.childNodes[0].nodeType;)c=c.childNodes[0];return c}function c(c,b){"string"==typeof c?(c=f.toDom(c,b&&b.ownerDocument),11==c.nodeType&&(c=c.childNodes[0])):1==c.nodeType&&c.parentNode&&(c=c.cloneNode(!1));
return c}var s=q.NodeList;d.extend(s,{_placeMultiple:function(c,b){for(var d="string"==typeof c||c.nodeType?q(c):c,m=[],k=0;k<d.length;k++)for(var a=d[k],e=this.length,g=e-1,h;h=this[g];g--)0<k&&(h=this._cloneNode(h),m.unshift(h)),g==e-1?f.place(h,a,b):a.parentNode.insertBefore(h,a),a=h;m.length&&(m.unshift(0),m.unshift(this.length-1),Array.prototype.splice.apply(this,m));return this},innerHTML:function(c){return arguments.length?this.addContent(c,"only"):this[0].innerHTML},text:function(c){if(arguments.length){for(var b=
0,d;d=this[b];b++)1==d.nodeType&&k.set(d,"textContent",c);return this}for(var f="",b=0;d=this[b];b++)f+=k.get(d,"textContent");return f},val:function(c){if(arguments.length){for(var b=d.isArray(c),f=0,m;m=this[f];f++){var k=m.nodeName.toUpperCase(),a=m.type,e=b?c[f]:c;if("SELECT"==k){k=m.options;for(a=0;a<k.length;a++){var n=k[a];n.selected=m.multiple?-1!=g.indexOf(c,n.value):n.value==e}}else"checkbox"==a||"radio"==a?m.checked=m.value==e:m.value=e}return this}if((m=this[0])&&1==m.nodeType){c=m.value||
"";if("SELECT"==m.nodeName.toUpperCase()&&m.multiple){c=[];k=m.options;for(a=0;a<k.length;a++)n=k[a],n.selected&&c.push(n.value);c.length||(c=null)}return c}},append:function(c){return this.addContent(c,"last")},appendTo:function(c){return this._placeMultiple(c,"last")},prepend:function(c){return this.addContent(c,"first")},prependTo:function(c){return this._placeMultiple(c,"first")},after:function(c){return this.addContent(c,"after")},insertAfter:function(c){return this._placeMultiple(c,"after")},
before:function(c){return this.addContent(c,"before")},insertBefore:function(c){return this._placeMultiple(c,"before")},remove:s.prototype.orphan,wrap:function(d){if(this[0]){d=c(d,this[0]);for(var b=0,f;f=this[b];b++){var m=this._cloneNode(d);f.parentNode&&f.parentNode.replaceChild(m,f);p(m).appendChild(f)}}return this},wrapAll:function(d){if(this[0]){d=c(d,this[0]);this[0].parentNode.replaceChild(d,this[0]);d=p(d);for(var b=0,f;f=this[b];b++)d.appendChild(f)}return this},wrapInner:function(f){if(this[0]){f=
c(f,this[0]);for(var b=0;b<this.length;b++){var k=this._cloneNode(f);this._wrap(d._toArray(this[b].childNodes),null,this._NodeListCtor).wrapAll(k)}}return this},replaceWith:function(c){c=this._normalize(c,this[0]);for(var b=0,d;d=this[b];b++)this._place(c,d,"before",0<b),d.parentNode.removeChild(d);return this},replaceAll:function(c){c=q(c);for(var b=this._normalize(this,this[0]),d=0,f;f=c[d];d++)this._place(b,f,"before",0<d),f.parentNode.removeChild(f);return this},clone:function(){for(var c=[],
b=0;b<this.length;b++)c.push(this._cloneNode(this[b]));return this._wrap(c,this,this._NodeListCtor)}});s.prototype.html||(s.prototype.html=s.prototype.innerHTML);return s})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(q,d,g,f,k){return q(k,{baseClass:"jimu-viewstack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);f.forEach(this.views,d.hitch(this,function(d){1===
d.nodeType?(g.place(d,this.domNode),g.addClass(d,"view")):d.domNode&&(g.place(d.domNode,this.domNode),g.addClass(d.domNode,"view"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var d="",c=this.getSelectedView();c&&(d=c.label);return d},getViewByLabel:function(d){for(var c=0;c<this.views.length;c++)if(d===this.views[c].label)return this.views[c];return null},addView:function(d){this.views.push(d);
1===d.nodeType?(g.place(d,this.domNode),g.addClass(d,"view")):d.domNode&&(g.place(d.domNode,this.domNode),g.addClass(d.domNode,"view"))},removeView:function(d){var c=this.views.length;this.views=f.filter(this.views,function(c){return d!==c});c!==this.views.length&&(1===d.nodeType?g.destroy(d):d.domNode&&d.destroyRecursive())},switchView:function(f){var c,k;c="number"===typeof f?this.views[f]:"string"===typeof f?this.getViewByLabel(f):f;this.views.forEach(d.hitch(this,function(d){d&&(1===d.nodeType?
k=d:d.domNode&&(k=d.domNode),d===c?(g.setStyle(k,"display","block"),d.domNode&&!d._started&&(d.startup(),d._started=!0)):g.setStyle(k,"display","none"))}));this._currentView=c;this.onViewSwitch(c)},onViewSwitch:function(){}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(q,d,
g,f,k,p,c,s,l,b,r){return q([s,l,p],{templateString:b,selected:"",tabs:null,average:!1,"class":"jimu-tab3",postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(b){var k=c("td",this.tabTr);g.forEach(k,d.hitch(this,function(a){f.removeClass(a,"selected");a.label===b?(f.addClass(a,"selected"),a.style.borderLeft="1px solid #ccc",a.style.borderRight="1px solid #ccc",a.style.borderTop=
"2px solid #15a4fa",a.style.borderBottom="0"):(a.style.borderLeft="0",a.style.borderRight="0",a.style.borderTop="0",a.style.borderBottom="1px solid #ccc")}));this.controlNode.removeChild(this.controlTable);f.place(this.controlTable,this.controlNode);this.viewStack.switchView(b);this.emit("tabChanged",b)},showShelter:function(){f.setStyle(this.shelter,"display","block")},hideShelter:function(){f.setStyle(this.shelter,"display","none")},_initSelf:function(){this.viewStack=new r(null,this.containerNode);
g.forEach(this.tabs,function(b){this._createTab(b)},this);if(this.average)this.controlTable.style.tableLayout="fixed";else{var b=f.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');f.place(b,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},_createTab:function(b){var l=f.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');
l.label=b.title||"";f.place(l,this.tabTr);var a=c(".tab-item-div",l)[0];a.innerHTML=l.label;a.label=l.label;b.content.label=l.label;this.viewStack.addView(b.content);this.own(k(l,"click",d.hitch(this,this._onSelect,b.title)))},_onSelect:function(b){this.selectTab(b)}})})},"jimu/dijit/TileLayoutContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/mouse dojo/query dijit/_WidgetBase".split(" "),function(q,d,g,f,k,p,c,s){return q([s],{baseClass:"jimu-tile-container",
constructor:function(){this.items=[];this.margin=15},startup:function(){this.inherited(arguments);this.items.forEach(d.hitch(this,function(c){this._placeItem(c)}));this.resize()},_placeItem:function(c){c.domNode?g.place(c.domNode,this.domNode):g.place(c,this.domNode)},addItem:function(c){this.items.push(c);this._placeItem(c);this.resize()},addItems:function(c){this.items=this.items.concat(c);this.items.forEach(d.hitch(this,function(b){this._placeItem(b)}));this.resize()},removeItem:function(c){var b;
for(b=0;b<this.items.length;b++)if(this.items[b].label===c){this.items[b].domNode?this.items[b].destroy():g.destroy(this.items[b]);this.items.splice(b,1);this.resize();break}},empty:function(){var c;for(c=0;c<this.items.length;c++)this.items[c].domNode?this.items[c].destroy():g.destroy(this.items[c]);this.items=[]},resize:function(){var c,b,f;c=g.getMarginBox(this.domNode);b=this.getItemSize(c);f=Math.floor((c.w+this.margin)/(b.width+this.margin));this.items.forEach(d.hitch(this,function(c,d){this.setItemPosition(c,
d,b,f)}))},getItemSize:function(c){var b={},d;if("fixWidth"===this.strategy)b.width=this.itemSize.width,b.height=this.itemSize.height;else if("breakWidth"===this.strategy)for(d=0;d<this.itemSize.length;d++){if(c.w<=this.itemSize[d].screenWidth){b.width=this.itemSize[d].width;b.height=this.itemSize[d].height;break}}else"fixCols"===this.strategy&&(b.width=(c.w-this.margin*(this.maxCols-1))/this.maxCols,b.height="number"===typeof this.itemSize.height?this.itemSize.height:b.width*parseFloat(this.itemSize.height.substring(0,
this.itemSize.height.length-1))/100);return b},setItemPosition:function(c,b,d,f){b++;b={marginLeft:1===b%f?0:this.margin+"px",marginTop:1===Math.ceil(b/f)?0:this.margin+"px"};0<=d.width&&(b.width=d.width+"px");0<=d.height&&(b.height=d.height+"px");g.setStyle(c.domNode?c.domNode:c,b)}})})},"jimu/dijit/DrawBox":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DrawBox.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query esri/layers/GraphicsLayer esri/graphic esri/toolbars/draw esri/symbols/jsonUtils".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a){return q([d,g,f],{templateString:k,baseClass:"jimu-draw-box",nls:null,types:null,pointSymbol:null,lineSymbol:null,polygonSymbol:null,textSymbol:null,map:null,drawLayer:null,drawLayerId:null,drawToolBar:null,showClear:!1,keepOneGraphic:!1,postMixInProperties:function(){this.nls=window.jimuNls.drawBox},postCreate:function(){this.inherited(arguments);var a={};this.drawLayerId&&(a.id=this.drawLayerId);this.drawLayer=new r(a);this._initDefaultSymbols();this._initTypes();
a=b(".draw-item",this.domNode);this.own(a.on("click",p.hitch(this,this._onItemClick)));this.own(l(this.btnClear,"click",p.hitch(this,this.clear)));this.map&&this.setMap(this.map);c.setStyle(this.btnClear,"display",!0===this.showClear?"block":"none")},disableWebMapPopup:function(){if(this.map&&this.map.webMapResponse){var a=this.map.webMapResponse.clickEventHandle;a&&(a.remove(),this.map.webMapResponse.clickEventHandle=null)}},enableWebMapPopup:function(){if(this.map&&this.map.webMapResponse){var a=
this.map.webMapResponse.clickEventHandle,b=this.map.webMapResponse.clickEventListener;b&&!a&&(this.map.webMapResponse.clickEventHandle=l(this.map,"click",p.hitch(this.map,b)))}},destroy:function(){this.drawToolBar&&this.drawToolBar.deactivate();this.drawLayer&&this.map&&this.map.removeLayer(this.drawLayer);this.drawLayer=this.map=this.drawToolBar=null;this.inherited(arguments)},setMap:function(a){a&&(this.map=a,this.map.addLayer(this.drawLayer),this.drawToolBar=new t(this.map),this.drawToolBar.setMarkerSymbol(this.pointSymbol),
this.drawToolBar.setLineSymbol(this.lineSymbol),this.drawToolBar.setFillSymbol(this.polygonSymbol),this.own(l(this.drawToolBar,"draw-end",p.hitch(this,this._onDrawEnd))))},setPointSymbol:function(a){this.pointSymbol=a;this.drawToolBar.setMarkerSymbol(this.pointSymbol)},setLineSymbol:function(a){this.lineSymbol=a;this.drawToolBar.setLineSymbol(a)},setPolygonSymbol:function(a){this.polygonSymbol=a;this.drawToolBar.setFillSymbol(a)},setTextSymbol:function(a){this.textSymbol=a},clear:function(){this.drawLayer.clear();
this.onClear()},deactivate:function(){this.enableWebMapPopup();this.drawToolBar&&this.drawToolBar.deactivate();b(".draw-item",this.domNode).removeClass("selected")},onIconSelected:function(a,b,c){},onDrawEnd:function(a,b,c){},onClear:function(){},addGraphic:function(a){this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a)},removeGraphic:function(a){this.drawLayer.remove(a)},_initDefaultSymbols:function(){var b={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,
0,128,255],width:1},type:"esriSMS",size:18},c={style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},d={style:"esriSFSSolid",color:[79,129,189,128],type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}};this.pointSymbol||(this.pointSymbol=a.fromJson(b));this.lineSymbol||(this.lineSymbol=a.fromJson(c));this.polygonSymbol||(this.polygonSymbol=a.fromJson(d))},_initTypes:function(){this.types instanceof Array||(this.types=["point","polyline",
"polygon"]);var a=b(".draw-item",this.domNode);a.style("display","none");s.forEach(a,p.hitch(this,function(a){var b=a.getAttribute("data-commontype"),b=0<=s.indexOf(this.types,b)?"block":"none";c.setStyle(a,"display",b)}))},_onItemClick:function(a){a=a.target||a.srcElement;b(".draw-item",this.domNode).removeClass("selected");c.addClass(a,"selected");var d=a.getAttribute("data-geotype"),h=a.getAttribute("data-commontype"),f=t[d];this.disableWebMapPopup();this.drawToolBar.activate(f);this.onIconSelected(a,
d,h)},_onDrawEnd:function(a){var d=b(".draw-item.selected",this.domNode)[0],h=d.getAttribute("data-geotype"),d=d.getAttribute("data-commontype");a=a.geometry;var f=a.type,k=null,k="point"===f||"multipoint"===f?c.hasClass(this.textIcon,"selected")?this.textSymbol:this.pointSymbol:"line"===f||"polyline"===f?this.lineSymbol:this.polygonSymbol;a=new m(a,k,null,null);this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a);this.deactivate();this.onDrawEnd(a,h,d)}})})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y,w,C,D,E,x){var v=q(e,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(a,b){this.markerSymbol=new n(n.STYLE_SOLID,10,new h(h.STYLE_SOLID,new k([255,0,0]),2),new k([0,0,0,0.25]));this.lineSymbol=new h(h.STYLE_SOLID,new k([255,0,0]),2);this.fillSymbol=new z(z.STYLE_SOLID,new h(h.STYLE_SOLID,new k([255,0,0]),2),new k([0,0,0,0.25]));this._points=[];this._mouse=!c("esri-touch")&&!c("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=d.mixin(d.mixin({},this._defaultOptions),b||{});if(s("ios")||s("android"))this._options.showTooltips=!1;this._onKeyDownHandler=d.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=d.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=d.hitch(this,this._onMouseUpHandler);this._onClickHandler=d.hitch(this,this._onClickHandler);this._onMouseMoveHandler=d.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=d.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=d.hitch(this,this._onDblClickHandler);this._updateTooltip=d.hitch(this,this._updateTooltip);this._hideTooltip=d.hitch(this,this._hideTooltip);this._redrawGraphic=d.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(a,b){this._geometryType&&this.deactivate();var e=this.map,h=f.connect,m=v;this._options=d.mixin(d.mixin({},this._options),b||{});e.navigationManager.setImmediateClick(!1);switch(a){case m.ARROW:case m.LEFT_ARROW:case m.RIGHT_ARROW:case m.UP_ARROW:case m.DOWN_ARROW:case m.TRIANGLE:case m.CIRCLE:case m.ELLIPSE:case m.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=h(e,"onClick",this._onClickHandler);this._onMouseDownHandler_connect=
h(e,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=h(e,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=h(e,this._mouse?"onMouseUp":"onSwipeEnd",this._onMouseUpHandler);c("esri-touch")&&!c("esri-pointer")&&(this._onMouseDownHandler2_connect=h(e,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=h(e,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=h(e,"onMouseUp",
this._onMouseUpHandler));break;case m.POINT:this._onClickHandler_connect=h(e,"onClick",this._onClickHandler);break;case m.LINE:case m.EXTENT:case m.FREEHAND_POLYLINE:case m.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._onMouseDownHandler_connect=h(e,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=h(e,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=h(e,this._mouse?"onMouseUp":"onSwipeEnd",
this._onMouseUpHandler);c("esri-touch")&&!c("esri-pointer")&&(this._onMouseDownHandler2_connect=h(e,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=h(e,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=h(e,"onMouseUp",this._onMouseUpHandler));break;case m.POLYLINE:case m.POLYGON:case m.MULTI_POINT:e.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=h(e,"onClick",this._onClickHandler);this._onDblClickHandler_connect=h(e,"onDblClick",
this._onDblClickHandler);this._dblClickZoom=e.isDoubleClickZoom;e.disableDoubleClickZoom();break;default:console.error("Unsupported geometry type: "+a);return}this._onKeyDown_connect=h(e,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=h(e,"onExtentChange",this._redrawGraphic);this._geometryType=a;this._toggleTooltip(!0);e.snappingManager&&("freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType)&&(e.snappingManager._startSelectionLayerQuery(),e.snappingManager._setUpSnapping());
this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var b=f.disconnect;b(this._onMouseMoveHandler_connect);b(this._onMouseDownHandler_connect);b(this._onMouseDragHandler_connect);b(this._onMouseUpHandler_connect);b(this._onMouseDownHandler2_connect);b(this._onMouseDragHandler2_connect);b(this._onMouseUpHandler2_connect);b(this._onClickHandler_connect);b(this._onDblClickHandler_connect);b(this._onKeyDown_connect);b(this._redrawConnect);this._onMouseDownHandler_connect=
this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null;a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping());switch(this._geometryType){case v.CIRCLE:case v.ELLIPSE:case v.TRIANGLE:case v.ARROW:case v.LEFT_ARROW:case v.RIGHT_ARROW:case v.UP_ARROW:case v.DOWN_ARROW:case v.RECTANGLE:case v.LINE:case v.EXTENT:case v.FREEHAND_POLYLINE:case v.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case v.POLYLINE:case v.POLYGON:case v.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}b=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(b)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var a,b=this._points,c=this.map.spatialReference,e=v,b=b.slice(0,b.length);switch(this._geometryType){case e.POLYLINE:if(!this._graphic||2>b.length)return;a=new w(c);a.addPath([].concat(b));break;case e.POLYGON:if(!this._graphic||3>b.length)return;a=new C(c);b=[].concat(b,[b[0].offset(0,0)]);!C.prototype.isClockwise(b)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),b.reverse());
a.addRing(b);break;case e.MULTI_POINT:a=new D(c),g.forEach(b,function(b){a.addPoint(b)})}f.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(a)},_drawEnd:function(a){if(a){var b=this.map.spatialReference,c;this.onDrawEnd(a);b&&(b.isWebMercator()?c=y.webMercatorToGeographic(a,!0):4326===b.wkid&&(c=B.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:c})}},_normalizeRect:function(a,b,c){var e=a.x;a=a.y;var d=b.x;b=b.y;var h=Math.abs(e-
d),f=Math.abs(a-b);return{x:Math.min(e,d),y:Math.max(a,b),width:h,height:f,spatialReference:c}},_onMouseDownHandler:function(a){this._dragged=!1;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var e=b||a.mapPoint,d=v;b=this.map;var h=b.spatialReference;this._points.push(e.offset(0,0));switch(this._geometryType){case d.LINE:this._graphic=b.graphics.add(new A(new w({paths:[[[e.x,e.y],[e.x,e.y]]],spatialReference:h}),this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);
break;case d.FREEHAND_POLYLINE:this._oldPoint=a.screenPoint;e=new w(h);e.addPath(this._points);this._graphic=b.graphics.add(new A(e,this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.CIRCLE:case d.ELLIPSE:case d.TRIANGLE:case d.ARROW:case d.LEFT_ARROW:case d.RIGHT_ARROW:case d.UP_ARROW:case d.DOWN_ARROW:case d.RECTANGLE:case d.FREEHAND_POLYGON:this._oldPoint=a.screenPoint,e=new C(h),e.addRing(this._points),this._graphic=b.graphics.add(new A(e,this.fillSymbol),
!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)}c("esri-touch")&&a.preventDefault()},_onMouseMoveHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[this._points.length-1];a=b||a.mapPoint;b=this._tGraphic;var e=b.geometry;switch(this._geometryType){case v.POLYLINE:case v.POLYGON:e.setPoint(0,0,{x:c.x,y:c.y}),e.setPoint(0,1,{x:a.x,y:a.y}),b.setGeometry(e)}},_onMouseDragHandler:function(a){if(c("esri-touch")&&!this._points.length)a.preventDefault();
else{this._dragged=!0;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var e=this._points[0],h=b||a.mapPoint,f=this.map,m=f.spatialReference;b=this._graphic;var k=v,l=f.toScreen(e),g=f.toScreen(h),n=[],n=g.x-l.x,g=g.y-l.y,r=Math.sqrt(n*n+g*g);switch(this._geometryType){case k.CIRCLE:this._hideTooltip();b.geometry=C.createCircle({center:l,r:r,numberOfPoints:60,map:f});b.setGeometry(b.geometry);break;case k.ELLIPSE:this._hideTooltip();b.geometry=C.createEllipse({center:l,
longAxis:n,shortAxis:g,numberOfPoints:60,map:f});b.setGeometry(b.geometry);break;case k.TRIANGLE:this._hideTooltip();n=[[0,-r],[0.8660254037844386*r,0.5*r],[-0.8660254037844386*r,0.5*r],[0,-r]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.ARROW:this._hideTooltip();e=g/r;f=n/r;h=0.25*f*r;m=0.25*r/(g/n);r*=0.25*e;n=[[n,g],[n-h*(1+24/m),g+24*f-r],[n-h*(1+12/m),g+12*f-r],[-12*e,12*f],[12*e,-12*f],[n-h*(1-12/m),g-12*f-r],[n-h*(1-24/m),g-24*f-r],[n,g]];b.geometry=this._toPolygon(n,
l.x,l.y);b.setGeometry(b.geometry);break;case k.LEFT_ARROW:this._hideTooltip();n=0>=n?[[n,0],[0.75*n,g],[0.75*n,0.5*g],[0,0.5*g],[0,-0.5*g],[0.75*n,-0.5*g],[0.75*n,-g],[n,0]]:[[0,0],[0.25*n,g],[0.25*n,0.5*g],[n,0.5*g],[n,-0.5*g],[0.25*n,-0.5*g],[0.25*n,-g],[0,0]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.RIGHT_ARROW:this._hideTooltip();n=0<=n?[[n,0],[0.75*n,g],[0.75*n,0.5*g],[0,0.5*g],[0,-0.5*g],[0.75*n,-0.5*g],[0.75*n,-g],[n,0]]:[[0,0],[0.25*n,g],[0.25*n,0.5*g],
[n,0.5*g],[n,-0.5*g],[0.25*n,-0.5*g],[0.25*n,-g],[0,0]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.UP_ARROW:this._hideTooltip();n=0>=g?[[0,g],[-n,0.75*g],[-0.5*n,0.75*g],[-0.5*n,0],[0.5*n,0],[0.5*n,0.75*g],[n,0.75*g],[0,g]]:[[0,0],[-n,0.25*g],[-0.5*n,0.25*g],[-0.5*n,g],[0.5*n,g],[0.5*n,0.25*g],[n,0.25*g],[0,0]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.DOWN_ARROW:this._hideTooltip();n=0<=g?[[0,g],[-n,0.75*g],[-0.5*n,0.75*g],[-0.5*
n,0],[0.5*n,0],[0.5*n,0.75*g],[n,0.75*g],[0,g]]:[[0,0],[-n,0.25*g],[-0.5*n,0.25*g],[-0.5*n,g],[0.5*n,g],[0.5*n,0.25*g],[n,0.25*g],[0,0]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.RECTANGLE:this._hideTooltip();n=[[0,0],[n,0],[n,g],[0,g],[0,0]];b.geometry=this._toPolygon(n,l.x,l.y);b.setGeometry(b.geometry);break;case k.LINE:b.setGeometry(d.mixin(b.geometry,{paths:[[[e.x,e.y],[h.x,h.y]]]}));break;case k.EXTENT:b&&f.graphics.remove(b,!0);b=new E(this._normalizeRect(e,
h,m));b._originOnly=!0;this._graphic=f.graphics.add(new A(b,this.fillSymbol),!0);f.snappingManager&&f.snappingManager._setGraphic(this._graphic);break;case k.FREEHAND_POLYLINE:this._hideTooltip();if(!1===this._canDrawFreehandPoint(a)){c("esri-touch")&&a.preventDefault();return}this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([h.offset(0,0)],0);b.setGeometry(b.geometry);break;case k.FREEHAND_POLYGON:this._hideTooltip();if(!1===this._canDrawFreehandPoint(a)){c("esri-touch")&&a.preventDefault();
return}this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([h.offset(0,0)],0);b.setGeometry(b.geometry)}c("esri-touch")&&a.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;var b=this._oldPoint.x-a.screenPoint.x,c=this._oldPoint.y-a.screenPoint.y,e=this._options.tolerance;if((0>b?-1*b:b)<e&&(0>c?-1*c:c)<e)return!1;b=new Date;if(b-this._startTime<this._options.drawTime)return!1;this._startTime=b;this._oldPoint=a.screenPoint;return!0},_onMouseUpHandler:function(a){if(this._dragged){0===
this._points.length&&this._points.push(a.mapPoint.offset(0,0));var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var e=this._points[0];b=b||a.mapPoint;var d=this.map.spatialReference,h=v,f;switch(this._geometryType){case h.CIRCLE:case h.ELLIPSE:case h.TRIANGLE:case h.ARROW:case h.LEFT_ARROW:case h.RIGHT_ARROW:case h.UP_ARROW:case h.DOWN_ARROW:case h.RECTANGLE:f=this._graphic.geometry;break;case h.LINE:f=new w({paths:[[[e.x,e.y],[b.x,b.y]]],spatialReference:d});break;case h.EXTENT:f=
(new E(this._normalizeRect(e,b,d))).getExtent();break;case h.FREEHAND_POLYLINE:f=new w(d);f.addPath([].concat(this._points,[b.offset(0,0)]));break;case h.FREEHAND_POLYGON:f=new C(d),e=[].concat(this._points,[b.offset(0,0),this._points[0].offset(0,0)]),!C.prototype.isClockwise(e)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),e.reverse()),f.addRing(e)}c("esri-touch")&&a.preventDefault();this._clear();
this._drawEnd(f)}else this._clear()},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);a=b||a.mapPoint;b=this.map;var c=b.toScreen(a),e=v;this._points.push(a.offset(0,0));switch(this._geometryType){case e.POINT:this._drawEnd(a.offset(0,0));this._setTooltipMessage(0);break;case e.POLYLINE:1===this._points.length?(c=new w(b.spatialReference),c.addPath(this._points),this._graphic=b.graphics.add(new A(c,this.lineSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic),
this._onMouseMoveHandler_connect=f.connect(b,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=b.graphics.add(new A(new w({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:b.spatialReference}),this.lineSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),b=this._tGraphic,c=b.geometry,c.setPoint(0,0,a.offset(0,0)),c.setPoint(0,1,a.offset(0,0)),b.setGeometry(c));break;case e.POLYGON:1===this._points.length?
(c=new C(b.spatialReference),c.addRing(this._points),this._graphic=b.graphics.add(new A(c,this.fillSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=f.connect(b,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=b.graphics.add(new A(new w({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:b.spatialReference}),this.fillSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),
b=this._tGraphic,c=b.geometry,c.setPoint(0,0,a.offset(0,0)),c.setPoint(0,1,a.offset(0,0)),b.setGeometry(c));break;case e.MULTI_POINT:a=this._points;1===a.length?(c=new D(b.spatialReference),c.addPoint(a[a.length-1]),this._graphic=b.graphics.add(new A(c,this.markerSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)):(this._graphic.geometry.addPoint(a[a.length-1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case e.ARROW:this._addShape([[0,
0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],c.x,c.y);break;case e.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],c.x,c.y);break;case e.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],c.x,c.y);break;case e.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]],c.x,c.y);break;case e.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],
[12,-24],[24,-24],[0,0]],c.x,c.y);break;case e.TRIANGLE:this._addShape([[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],c.x,c.y);break;case e.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],c.x-48,c.y+48);break;case e.CIRCLE:this._clear();this._drawEnd(C.createCircle({center:c,r:48,numberOfPoints:60,map:b}));break;case e.ELLIPSE:this._clear(),this._drawEnd(C.createEllipse({center:c,longAxis:48,shortAxis:24,numberOfPoints:60,map:b}))}this._setTooltipMessage(this._points.length)},
_addShape:function(a,b,c){this._setTooltipMessage(0);this._clear();this._drawEnd(this._toPolygon(a,b,c))},_toPolygon:function(a,b,c){var e=this.map,d=new C(e.spatialReference);d.addRing(g.map(a,function(a){return e.toMap({x:a[0]+b,y:a[1]+c})}));return d},_onDblClickHandler:function(a){var b,e=this._points,d=this.map.spatialReference,h=v;c("esri-touch")&&e.push(a.mapPoint);e=e.slice(0,e.length);switch(this._geometryType){case h.POLYLINE:if(!this._graphic||2>e.length){f.disconnect(this._onMouseMoveHandler_connect);
this._clear();this._onClickHandler(a);return}b=new w(d);b.addPath([].concat(e));break;case h.POLYGON:if(!this._graphic||2>e.length){f.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(a);return}b=new C(d);a=[].concat(e,[e[0].offset(0,0)]);!C.prototype.isClockwise(a)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),a.reverse());b.addRing(a);break;case h.MULTI_POINT:b=
new D(d),g.forEach(e,function(a){b.addPoint(a)})}f.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(b)},_onKeyDownHandler:function(a){a.keyCode===l.ESCAPE&&(f.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(a){this._options.showTooltips&&(a?this._tooltip||(this._tooltip=b.create("div",{"class":"tooltip"},this.map.container),m.isBodyLtr()||r.set(this._tooltip,"direction","rtl"),this._tooltip.style.display=
"none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=f.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=f.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=f.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(f.disconnect(this._onTooltipMouseEnterHandler_connect),f.disconnect(this._onTooltipMouseLeaveHandler_connect),f.disconnect(this._onTooltipMouseMoveHandler_connect),
b.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var b=this._tooltip;if(b){var c="";switch(this._geometryType){case v.POINT:c=x.toolbars.draw.addPoint;break;case v.ARROW:case v.LEFT_ARROW:case v.RIGHT_ARROW:case v.UP_ARROW:case v.DOWN_ARROW:case v.TRIANGLE:case v.RECTANGLE:case v.CIRCLE:case v.ELLIPSE:c=x.toolbars.draw.addShape;break;case v.LINE:case v.EXTENT:case v.FREEHAND_POLYLINE:case v.FREEHAND_POLYGON:c=
x.toolbars.draw.freehand;break;case v.POLYLINE:case v.POLYGON:c=x.toolbars.draw.start;1===a?c=x.toolbars.draw.resume:2<=a&&(c=x.toolbars.draw.complete);break;case v.MULTI_POINT:c=x.toolbars.draw.addMultipoint,1<=a&&(c=x.toolbars.draw.finish)}b.innerHTML=c}},_updateTooltip:function(a){var b=this._tooltip;if(b){var c;a.clientX||a.pageY?(c=a.clientX,a=a.clientY):(c=a.clientX+p.body().scrollLeft-p.body().clientLeft,a=a.clientY+p.body().scrollTop-p.body().clientTop);b.style.display="none";r.set(b,{left:c+
this._options.tooltipOffset+"px",top:a+"px"});b.style.display=""}},_redrawGraphic:function(a,b,c,e){if(c||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});d.mixin(v,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",
ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"});return v})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(q,d,g,f,k){return q([k],{declaredClass:"esri.toolbars._Toolbar",constructor:function(d){this.map=d},_cursors:{move:"pointer","move-v":"pointer","move-gv":"pointer",box0:"nw-resize",
box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(d,c,f,k){var b=this.map;d&&(this._mapNavState={isDoubleClickZoom:b.isDoubleClickZoom,isClickRecenter:b.isClickRecenter,isPan:b.isPan,isRubberBandZoom:b.isRubberBandZoom,isKeyboardNavigation:b.isKeyboardNavigation,isScrollWheelZoom:b.isScrollWheelZoom},b.disableDoubleClickZoom(),b.disableClickRecenter(),b.disablePan(),b.disableRubberBandZoom(),
b.disableKeyboardNavigation());c&&b.hideZoomSlider();f&&b.hidePanArrows();k&&b.graphics.disableMouseEvents()},_activateMapTools:function(d,c,f,k){var b=this.map,g=this._mapNavState;d&&g&&(g.isDoubleClickZoom&&b.enableDoubleClickZoom(),g.isClickRecenter&&b.enableClickRecenter(),g.isPan&&b.enablePan(),g.isRubberBandZoom&&b.enableRubberBandZoom(),g.isKeyboardNavigation&&b.enableKeyboardNavigation(),g.isScrollWheelZoom&&b.enableScrollWheelZoom());c&&b.showZoomSlider();f&&b.showPanArrows();k&&b.graphics.enableMouseEvents()}})})},
"jimu/dijit/URLInput":function(){define(["dojo/_base/declare","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(q,d,g){return q([d],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allLocal:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.urlInput;this.invalidMessage=this.nls.invalidUrl},validator:function(d){var k="^"+g.url({allowNamed:this.allowNamed,allLocal:this.allLocal}),k=RegExp(k,"g").test(d);return this.rest?(d=/\/rest\/services/gi.test(d),
k&&d):k}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(q,d,g){var f=q.getObject("validate.regexp",!0,g);return f=g.validate.regexp={ipAddress:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowDottedDecimal&&(d.allowDottedDecimal=!0);"boolean"!=typeof d.allowDottedHex&&(d.allowDottedHex=!0);"boolean"!=typeof d.allowDottedOctal&&(d.allowDottedOctal=!0);"boolean"!=typeof d.allowDecimal&&(d.allowDecimal=!0);"boolean"!=typeof d.allowHex&&
(d.allowHex=!0);"boolean"!=typeof d.allowIPv6&&(d.allowIPv6=!0);"boolean"!=typeof d.allowHybrid&&(d.allowHybrid=!0);var f=[];d.allowDottedDecimal&&f.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");d.allowDottedHex&&f.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");d.allowDottedOctal&&f.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");d.allowDecimal&&f.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
d.allowHex&&f.push("0[xX]0*[\\da-fA-F]{1,8}");d.allowIPv6&&f.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");d.allowHybrid&&f.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");d="";0<f.length&&(d="("+f.join("|")+")");return d},host:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowIP&&(d.allowIP=!0);"boolean"!=typeof d.allowLocal&&(d.allowLocal=!1);"boolean"!=typeof d.allowPort&&(d.allowPort=!0);"boolean"!=typeof d.allowNamed&&
(d.allowNamed=!1);var g=d.allowPort?"(\\:\\d+)?":"",c="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)";d.allowIP&&(c+="|"+f.ipAddress(d));d.allowLocal&&(c+="|localhost");d.allowNamed&&(c+="|^[^-][a-zA-Z0-9_-]*");return"("+c+")"+g},url:function(g){g="object"==typeof g?g:{};"scheme"in g||(g.scheme=[!0,!1]);return d.buildGroupRE(g.scheme,function(d){return d?"(https?|ftps?)\\://":""})+f.host(g)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},
emailAddress:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowCruft&&(d.allowCruft=!1);d.allowPort=!1;var g="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+f.host(d);d.allowCruft&&(g="\x3c?(mailto\\:)?"+g+"\x3e?");return g},emailAddressList:function(d){d="object"==typeof d?d:{};"string"!=typeof d.listSeparator&&(d.listSeparator="\\s;,");var g=f.emailAddress(d);return"("+g+"\\s*["+d.listSeparator+"]\\s*)*"+g+"\\s*["+d.listSeparator+"]?\\s*"},numberFormat:function(f){f=
"object"==typeof f?f:{};"undefined"==typeof f.format&&(f.format="###-###-####");return d.buildGroupRE(f.format,function(f){return d.escapeString(f,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(d){d="object"==typeof d?d:{};"boolean"!=typeof d.allowTerritories&&(d.allowTerritories=!0);"boolean"!=typeof d.allowMilitary&&(d.allowMilitary=!0);
var f="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";d.allowTerritories&&(f+="|AS|FM|GU|MH|MP|PW|PR|VI");d.allowMilitary&&(f+="|AA|AE|AP");return"("+f+")"}}}})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(q,d,g,f,k,p,c,s,l){return p("dijit.layout._LayoutWidget",
[d,g,f],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);c.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var b=this.getParent&&this.getParent();if(!b||!b.isLayoutContainer)this.resize(),this.own(k.on("resize",q.hitch(this,"resize")))}},resize:function(b,c){var d=this.domNode;b&&s.setMarginBox(d,b);var f=c||{};q.mixin(f,b||{});if(!("h"in f)||!("w"in f))f=q.mixin(s.getMarginBox(d),
f);var a=l.getComputedStyle(d),e=s.getMarginExtents(d,a),g=s.getBorderExtents(d,a),f=this._borderBox={w:f.w-(e.w+g.w),h:f.h-(e.h+g.h)},e=s.getPadExtents(d,a);this._contentBox={l:l.toPixelValue(d,a.paddingLeft),t:l.toPixelValue(d,a.paddingTop),w:f.w-e.w,h:f.h-e.h};this.layout()},layout:function(){},_setupChild:function(b){c.add(b.domNode,this.baseClass+"-child "+(b.baseClass?this.baseClass+"-"+b.baseClass:""))},addChild:function(b,c){this.inherited(arguments);this._started&&this._setupChild(b)},removeChild:function(b){c.remove(b.domNode,
this.baseClass+"-child"+(b.baseClass?" "+this.baseClass+"-"+b.baseClass:""));this.inherited(arguments)}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n){r("dijit-legacy-requires")&&n(0,function(){q(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem",
"dijit/MenuSeparator"])});return g("dijit.Menu",e,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):d.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return t.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},
_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=f.byId(a,this.ownerDocument);var c;if("iframe"==a.tagName.toLowerCase()){var e=a;c=this._iframeContentWindow(e);c=m.body(c.document)}else c=a==m.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var d={node:a,iframe:e};k.set(a,"_dijitMenu"+this.id,this._bindings.push(d));var g=l.hitch(this,
function(a){var c=this.selector,d=c?function(a){return b.selector(c,a)}:function(a){return a},h=this;return[b(a,d(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<this._lastKeyDown+500||h._scheduleOpen(this,e,{x:a.pageX,y:a.pageY},a.target)}),b(a,d("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==s.F10||this.leftClickToOpen&&a.keyCode==s.SPACE)a.stopPropagation(),a.preventDefault(),h._scheduleOpen(this,e,null,a.target),
this._lastKeyDown=(new Date).getTime()})]});d.connects=c?g(c):[];e&&(d.onloadHandler=l.hitch(this,function(){var a=this._iframeContentWindow(e),a=m.body(a.document);d.connects=g(a)}),e.addEventListener?e.addEventListener("load",d.onloadHandler,!1):e.attachEvent("onload",d.onloadHandler))},unBindDomNode:function(a){var b;try{b=f.byId(a,this.ownerDocument)}catch(c){return}a="_dijitMenu"+this.id;if(b&&k.has(b,a)){for(var e=k.get(b,a)-1,d=this._bindings[e],m;m=d.connects.pop();)m.remove();(m=d.iframe)&&
(m.removeEventListener?m.removeEventListener("load",d.onloadHandler,!1):m.detachEvent("onload",d.onloadHandler));k.remove(b,a);delete this._bindings[e]}},_scheduleOpen:function(a,b,c,e){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:e,delegatedTarget:a,iframe:b,coords:c})},1))},_openMyself:function(b){function e(){s.refocus&&t&&t.focus();a.close(s)}var d=b.target,m=b.iframe,g=b.coords,n=!g;this.currentTarget=b.delegatedTarget;if(g){if(m){b=
p.position(m,!0);var d=this._iframeContentWindow(m),d=p.docScroll(d.document),l=c.getComputedStyle(m),k=c.toPixelValue,q=(r("ie")&&r("quirks")?0:k(m,l.paddingLeft))+(r("ie")&&r("quirks")?k(m,l.borderLeftWidth):0),m=(r("ie")&&r("quirks")?0:k(m,l.paddingTop))+(r("ie")&&r("quirks")?k(m,l.borderTopWidth):0);g.x+=b.x+q-d.x;g.y+=b.y+m-d.y}}else g=p.position(d,!0),g.x+=10,g.y+=10;var s=this,m=this._focusManager.get("prevNode");b=this._focusManager.get("curNode");var t=!b||f.isDescendant(b,this.domNode)?
m:b;a.open({popup:this,x:g.x,y:g.y,onExecute:e,onCancel:e,orient:this.isLeftToRight()?"L":"R"});this.focus();n||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);a.close(this)}},destroy:function(){d.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dgrid/main":function(){define([],1)},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(q,d,g){return q("dgrid.OnDemandGrid",
[d,g],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(q,d,g,f,k,p,c){function s(b,c){c&&c.nodeType&&b.appendChild(c)}function l(b,c,d,a){if(this.formatter){a=this.formatter;var e=this.grid.formatterScope;d.innerHTML="string"===typeof a&&e?e[a](c,b):this.formatter(c,b)}else null!=c&&d.appendChild(document.createTextNode(c))}var b=8>f("ie")&&!f("quirks");d=d("dgrid.Grid",p,{columns:null,
cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(b){return"object"!=typeof b?this.columns[b]:this.cell(b).column},listType:"grid",cell:function(b,c){if(b.column&&b.element)return b;b.target&&b.target.nodeType&&(b=b.target);var d;if(b.nodeType){do{if(this._rowIdToObject[b.id])break;var a=b.columnId;if(a){c=a;d=b;break}b=b.parentNode}while(b&&b!=this.domNode)}if(!d&&"undefined"!=typeof c){var e=this.row(b);if(a=e&&e.element)for(var a=a.getElementsByTagName("td"),f=0;f<a.length;f++)if(a[f].columnId==
c){d=a[f];break}}if(null!=b)return{row:e||this.row(b),column:c&&this.column(c),element:d}},createRowCells:function(d,m,g,a){var e=k("table.dgrid-row-table[role\x3dpresentation]"),n=9>f("ie")||f("quirks")?k(e,"tbody"):e,h,l,p,s,q,w,C,D,E,x;g=g||this.subRows;l=0;for(p=g.length;l<p;l++){w=g[l];h=k(n,"tr");w.className&&k(h,"."+w.className);s=0;for(q=w.length;s<q;s++){C=w[s];D=C.id;E=C.field?".field-"+c.escapeCssIdentifier(C.field,"-"):"";(x="function"===typeof C.className?C.className(a):C.className)&&
(E+="."+x);E=k(d+(".dgrid-cell.dgrid-cell-padding"+(D?".dgrid-column-"+c.escapeCssIdentifier(D,"-"):"")+E.replace(/ +/g,"."))+"[role\x3d"+("th"===d?"columnheader":"gridcell")+"]");E.columnId=D;b?(D=k(E,"!dgrid-cell-padding div.dgrid-cell-padding"),E.contents=D):D=E;if(x=C.colSpan)E.colSpan=x;if(x=C.rowSpan)E.rowSpan=x;m(D,C);h.appendChild(E)}}return e},left:function(b,c){b.element||(b=this.cell(b));return this.cell(this._move(b,-(c||1),"dgrid-cell"))},right:function(b,c){b.element||(b=this.cell(b));
return this.cell(this._move(b,c||1,"dgrid-cell"))},renderRow:function(b,c){var d=this.createRowCells("td",function(a,e){var d=b;e.get?d=e.get(b):"field"in e&&"_item"!=e.field&&(d=d[e.field]);e.renderCell?s(a,e.renderCell(b,d,a,c)):l.call(e,b,d,a,c)},c&&c.subRows,b);return k("div[role\x3drow]\x3e",d)},renderHeader:function(){var c=this,d=this.headerNode,l=d.childNodes.length;for(d.setAttribute("role","row");l--;)k(d.childNodes[l],"!");l=this.createRowCells("th",function(a,c){var d=c.headerNode=a;b&&
(a=a.parentNode);var f=c.field;f&&(a.field=f);if(c.renderHeaderCell)s(d,c.renderHeaderCell(d));else if("label"in c||c.field)d.appendChild(document.createTextNode("label"in c?c.label:c.field));!1!==c.sortable&&(f&&"_item"!=f)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[l.id=this.id+"-header"]=this.columns;d.appendChild(l);this._sortListener&&this._sortListener.remove();this._sortListener=g(l,"click,keydown",function(a){if("click"==a.type||
32==a.keyCode||!f("opera")&&13==a.keyCode){var b=a.target,l,h,k;do if(b.sortable){k=[{attribute:l=b.field||b.columnId,descending:(h=c._sort[0])&&h.attribute==l&&!h.descending}];l={bubbles:!0,cancelable:!0,grid:c,parentType:a.type,sort:k};g.emit(a.target,"dgrid-sort",l)&&(c._sortNode=b,c.set("sort",k));break}while((b=b.parentNode)&&b!=d)}})},resize:function(){var b=this.headerNode.firstChild,c=this.contentNode,d;this.inherited(arguments);if(!f("ie")||7<f("ie")&&!f("quirks"))if(c.style.width="",c&&
b&&(d=b.offsetWidth)!=c.offsetWidth)c.style.width=d+"px"},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(b,c){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(b){var c=this.columns,d;for(d in c){var a=c[d];if(a.field==b)return a.headerNode}},updateSortArrow:function(b,c){this._lastSortedArrow&&(k(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),k(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);c&&(this._sort=b);if(b[0]){var d=b[0].attribute,a=b[0].descending,d=this._sortNode||this._findSortArrowParent(d),e;delete this._sortNode;d&&(d=d.contents||d,e=this._lastSortedArrow=k("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),e.innerHTML="\x26nbsp;",d.insertBefore(e,d.firstChild),k(d,a?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,d){return this.addCssRule("#"+c.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+c.escapeCssIdentifier(b,
"-"),d)},_configColumns:function(b,d){var f=[],a=d instanceof Array;c.each(d,function(c,g){"string"==typeof c&&(d[g]=c={label:c});!a&&!c.field&&(c.field=g);g=c.id=c.id||(isNaN(g)?g:b+g);this._configColumn&&(this._configColumn(c,g,d,b),g=c.id);a&&(this.columns[g]=c);c.grid=this;"function"===typeof c.init&&c.init();f.push(c)},this);return a?d:f},_destroyColumns:function(){var b=this.subRows,c=b&&b.length,d,a,e,f;this.cleanup();for(d=0;d<c;d++){a=0;for(f=b[d].length;a<f;a++)e=b[d][a],"function"===typeof e.destroy&&
e.destroy()}},configStructure:function(){var b=this.subRows,c=this._columns=this.columns;this.columns=!c||c instanceof Array?{}:c;if(b)for(c=0;c<b.length;c++)b[c]=this._configColumns(c+"-",b[c]);else this.subRows=[this._configColumns("",c)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(b){this._destroyColumns();this.subRows=null;this.columns=b;this._updateColumns()},_setSubRows:function(b){this._destroyColumns();this.subRows=b;this._updateColumns()},setColumns:function(b){q.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",b)},setSubRows:function(b){q.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",b)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});d.appendIfNode=s;d.defaultRenderCell=l;return d})},"put-selector/put":function(){(function(q){var d,
g=/[-+,> ]/;q([],d=function(f,k){function p(d){function m(){h&&(n&&h!=n)&&(n==d&&(k||(k=g.test(y)&&f.createDocumentFragment()))?k:n).insertBefore(h,e||null)}for(var k,a,e,n,h,q=arguments,A=q[0],B=0;B<q.length;B++){var y=q[B];if("object"==typeof y){a=!1;if(y instanceof Array){h=f.createDocumentFragment();for(var w=0;w<y.length;w++)h.appendChild(p(y[w]));y=h}if(y.nodeType)h=y,m(),n=y,e=0;else for(w in y)h[w]=y[w]}else if(a)a=!1,h.appendChild(f.createTextNode(y));else{1>B&&(d=null);a=!0;if(A=y.replace(c,
function(a,c,g,k,t,w){c&&(m(),"-"==c||"+"==c?(n=(e=h||n).parentNode,h=null,"+"==c&&(e=e.nextSibling)):("\x3c"==c?n=h=(h||n).parentNode:(","==c?n=d:h&&(n=h),h=null),e=0),h&&(n=h));if((a=!g&&k)||!h&&(g||t))"$"==a?(a=q[++B],n.appendChild(f.createTextNode(a))):(a=a||p.defaultTag,(c=b&&q[B+1]&&q[B+1].name)&&(a="\x3c"+a+' name\x3d"'+c+'"\x3e'),h=l&&~(s=a.indexOf("|"))?f.createElementNS(l[a.slice(0,s)],a.slice(s+1)):f.createElement(a));if(g)if("$"==k&&(k=q[++B]),"#"==g)h.id=k;else if(c=(a=h.className)&&
(" "+a+" ").replace(" "+k+" "," "),"."==g)h.className=a?(c+k).substring(1):k;else if("!"==y){var A;b?p("div",h,"\x3c").innerHTML="":(A=h.parentNode)&&A.removeChild(h)}else c=c.substring(1,c.length-1),c!=a&&(h.className=c);t&&("$"==w&&(w=q[++B]),"style"==t?h.style.cssText=w:(g="!"==t.charAt(0)?(t=t.substring(1))&&"removeAttribute":"setAttribute",w=""===w?t:w,l&&~(s=t.indexOf("|"))?h[g+"NS"](l[t.slice(0,s)],t.slice(s+1),w):h[g](t,w)));return""}))throw new SyntaxError("Unexpected char "+A+" in "+y);
m();n=A=h||n}}d&&k&&d.appendChild(k);return A}g=k||g;var c=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,s,l=!1;f=f||document;var b="object"==typeof f.createElement;p.addNamespace=function(b,c){f.createElementNS?(l||(l={}))[b]=c:f.namespaces.add(b,c)};p.defaultTag="div";p.forDocument=d;return p})})(function(q,d,g){g=g||d;"function"===typeof define?define([],function(){return g()}):"undefined"==typeof window?require("./node-html")(module,g):put=g()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),
function(q,d,g,f,k,p,c,s,l){function b(a,b){l(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function r(a){var b=a?"."+a.replace(z,"."):"";this._class&&(b="!"+this._class.replace(z,"!")+b);l(this.domNode,b);this._class=a}function m(){return this._class}function t(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function a(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&
(this.bodyNode.scrollTop=a.y)}s("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var e,n;k.add("dom-scrollbar-width",function(a,c,e){return b(e,"Width")});k.add("dom-scrollbar-height",function(a,c,e){return b(e,"Height")});k.add("dom-rtl-scrollbar-left",function(a,b,c){a=l("div");l(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");l(c,a);b=!!k("ie")||!!k("trident")||a.offsetLeft>=k("dom-scrollbar-width");c.className="";document.body.removeChild(c);l(a,"!");c.removeAttribute("dir");
return b});var h=0,z=/ +/g,A=7>k("ie")&&!k("quirks")?function(){var a,b,c;if(this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a))this.resize(),this._prevWinDims=[b,a]}:function(){this._started&&this.resize()};return d("dgrid.List",k("touch")?c:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,
b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,b){var c=this.domNode=b||l("div"),e;a?(this.params=a,d.safeMixin(this,a),e=a["class"]||a.className||c.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&
this.postMixInProperties();this.id=c.id=c.id||this.id||"dgrid_"+h++;null===this.useTouchScroll&&(this.useTouchScroll=!k("dom-scrollbar-width"));this.buildRendering();e&&r.call(this,e);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,e,d,h,m;m=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";l(a,"[role\x3dgrid].dgrid.dgrid-"+
this.listType+(b?".ui-widget":""));e=this.headerNode=l(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(k("quirks")||8>k("ie"))&&l(a,"div.dgrid-spacer");d=this.bodyNode=l(a,"div.dgrid-scroller");k("ff")&&(d.tabIndex=-1);this.headerScrollNode=l(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));h=this.footerNode=l("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));l(a,h);m&&(a.className+=
" dgrid-rtl"+(k("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));f(d,"scroll",function(b){c.showHeader&&(e.scrollLeft=b.scrollLeft||d.scrollLeft);b.stopPropagation();f.emit(a,"scroll",{scrollTarget:d})});this.configStructure();this.renderHeader();this.contentNode=this.touchNode=l(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=f(window,"resize",p.throttleDelayed(A,this)))},postCreate:k("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:
function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,c=this.footerNode,d=b.offsetHeight,f=this.showFooter?c.offsetHeight:0,h=k("quirks")||7>k("ie");this.headerScrollNode.style.height=a.style.marginTop=d+"px";a.style.marginBottom=f+"px";h&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-d-f,0)+"px",f&&(c.style.bottom=
"1px",setTimeout(function(){c.style.bottom=""},0)));e||(e=k("dom-scrollbar-width"),n=k("dom-scrollbar-height"),k("ie")&&(e++,n++),p.addCssRule(".dgrid-scrollbar-width","width: "+e+"px"),p.addCssRule(".dgrid-scrollbar-height","height: "+n+"px"),17!=e&&!h&&(p.addCssRule(".dgrid-header-row","right: "+e+"px"),p.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+e+"px")));h&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=p.addCssRule(a,
b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=f(this.domNode,a,b);k("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();
delete this._listeners}this._started=!1;this.cleanup();l(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";this.scrollTo({x:0,y:0})},newRow:function(a,b,c,e,d){if(b){var f=this.insertRow(a,b,c,e,d);l(f,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){l(f,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return f}},adjustRowIndices:function(a){var b=
a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&l(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,b,c){function e(){var b=arguments;if(-1<r)for(var f=0;f<b.length;f++){var h=b[f],g=n[h?0:n.length-1];if(g=g&&d(g)){var l=g[h?"previousSibling":"nextSibling"];l&&(l=m.row(l));l&&l.element!=g&&(h=h?"unshift":"push",a[h](l.data),
n[h](l.element),c.count++)}}}function d(a){return!g.isDescendant(a,m.domNode)&&document.getElementById(a.id)?m.row(a.id.slice(m.id.length+5)).element:a}function f(a){t=m.insertRow(a,s,null,l++,c);t.observerIndex=r;return t}function h(a){z=a.slice(0);(p=b?b.parentNode:m.contentNode)&&p.parentNode&&(p!==m.contentNode||a.length)?(p.insertBefore(s,b||null),(t=a[a.length-1])&&m.adjustRowIndices(t)):k[r]&&m.cleanEmptyObservers&&"undefined"!==typeof r&&(k[r].cancel(),k[r]=0,m._numObservers--);n=a;q&&(q.rows=
n)}c=c||{};var m=this,l=c.start||0,k=this.observers,n,p,r;b||(this._lastCollection=a);if(a.observe){m._numObservers++;var q=a.observe(function(f,h,g){var l,k,q;-1<h&&n[h]&&(l=n.splice(h,1)[0],l.parentNode==p&&((k=l.nextSibling)&&h!=g&&k.rowIndex--,m.removeRow(l)),c.count--,m._processScroll&&m._processScroll());if(-1<g){if(n.length)if(0===g)q=(q=n[g])&&d(q);else{if(q=n[g-1])q=d(q),q=(q.connected||q).nextSibling}else q=m._getFirstRowSibling&&m._getFirstRowSibling(p);l&&(q&&l.id===q.id)&&(q=(q.connected||
q).nextSibling);q&&!q.parentNode&&(q=document.getElementById(q.id));l=b&&b.parentNode||q&&q.parentNode||m.contentNode;if(l=m.newRow(f,l,q,c.start+g,c))if(l.observerIndex=r,n.splice(g,0,l),!k||g<h)k=l.previousSibling,k=!k||k.rowIndex+1==l.rowIndex||0==l.rowIndex?l:k;c.count++}0===h?e(1,1):h===a.length-(-1===g?0:1)&&e(0,0);h!=g&&k&&m.adjustRowIndices(k);m._onNotification(n,f,h,g)},!0);r=k.push(q)-1}var s=document.createDocumentFragment(),t,z;if(a.map){if(n=a.map(f,console.error),n.then)return a.then(function(b){a=
b;return n.then(function(a){h(a);e(1,1,0,0);return z})})}else{n=[];for(var A=0,K=a.length;A<K;A++)n[A]=f(a[A])}h(n);e(1,1,0,0);return z},_onNotification:function(a,b,c,e){},renderHeader:function(){},_autoId:0,insertRow:function(a,b,c,e,d){var f=d.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),h=document.getElementById(f),m=h&&h.previousSibling;h&&(h===c&&(c=(c.connected||c).nextSibling),this.removeRow(h));h=this.renderRow(a,d);
h.className=(h.className||"")+" dgrid-row "+(1==e%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[h.id=f]=a;b.insertBefore(h,c||null);m&&this.adjustRowIndices(m);h.rowIndex=e;return h},renderRow:function(a,b){return l("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||l(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+
5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):(b=a,a=this._rowIdToObject[this.id+"-row-"+b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,e){var d,f;f=d=a.element;b=b||1;do if(a=d[0>b?"previousSibling":"nextSibling"]){do if((d=a)&&-1<(d.className+" ").indexOf(c+" ")){f=d;b+=0>b?1:-1;break}while(a=(!e||!d.hidden)&&d[0>b?"lastChild":"firstChild"])}else if(d=d.parentNode,
!d||d===this.bodyNode||d===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:k("touch")?function(b){return this.useTouchScroll?this.inherited(arguments):a.call(this,b)}:a,getScrollPosition:k("touch")?function(){return this.useTouchScroll?this.inherited(arguments):t.call(this)}:t,get:function(a){var b=
"_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:m,_setClass:r,_getClassName:m,_setClassName:r,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();
this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,e){var d=c[a],f=e[a];void 0===d&&(d="");void 0===f&&(f="");return d==f?0:d>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){q.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;l(b,(a?"!":".")+"dgrid-header-hidden");
this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){q.deprecated("setShowHeader(...)",'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;l(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(q,d){q.add("dom-contains",function(c,b,d){return!!d.contains});var g=[],f,k,p,c=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,
s={defaultDelay:15,throttle:function(c,b,d){var f=!1;d=d||s.defaultDelay;return function(){f||(f=!0,c.apply(b,arguments),setTimeout(function(){f=!1},d))}},throttleDelayed:function(c,b,d){var f=!1;d=d||s.defaultDelay;return function(){if(!f){f=!0;var g=arguments;setTimeout(function(){f=!1;c.apply(b,g)},d)}}},debounce:function(c,b,d){var f;d=d||s.defaultDelay;return function(){f&&(clearTimeout(f),f=null);var g=arguments;f=setTimeout(function(){c.apply(b,g)},d)}},each:function(c,b,d){var f,g;if(c)if("number"===
typeof c.length){f=0;for(g=c.length;f<g;f++)b.call(d,c[f],f,c)}else for(f in c)b.call(d,c[f],f,c)},contains:function(c,b){return q("dom-contains")?c.contains(b):c.compareDocumentPosition(b)&8},addCssRule:function(c,b){f||(f=d(document.getElementsByTagName("head")[0],"style"),f=f.sheet||f.styleSheet,k=f.deleteRule?"deleteRule":"removeRule",p=f.cssRules?"cssRules":"rules");var r=g.length;g[r]=(f.cssRules||f.rules).length;f.addRule?f.addRule(c,b):f.insertRule(c+"{"+b+"}",g[r]);return{get:function(b){return f[p][g[r]].style[b]},
set:function(b,c){"undefined"!==typeof g[r]&&(f[p][g[r]].style[b]=c)},remove:function(){var b=g[r],c,a;if(void 0!==b){f[k](b);g[r]=void 0;c=r+1;for(a=g.length;c<a;c++)g[c]>b&&g[c]--}}}},escapeCssIdentifier:function(d,b){return d.replace(c,b||"\\$1")}};return s})},"xstyle/has-class":function(){define(["dojo/has"],function(q){var d={};return function(){for(var g,f=arguments,k=0;k<f.length;k++)if(g=f[k],!d[g]){d[g]=!0;var p=g.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),c=q(p[2]),s=-p[4];if((0<s?s<=
c&&(-p[5]||s)>=c:!!c)==!p[1])document.documentElement.className+=" has-"+g}}})},"xstyle/css":function(){define(["require"],function(q){function d(d,f,k){var p=document.documentElement;d=p.insertBefore(document.createElement(d),p.firstChild);d.id=f;f=(d.currentStyle||getComputedStyle(d,null))[k];p.removeChild(d);return f}return{load:function(g,f,k,p){function c(){var b=d("x-parse",null,"content");b&&"none"!=b?f([eval(b)],k):k()}var s=f.toUrl(g),l=f.cache["url:"+s];if(l)return l.xCss&&(l=l.cssText),
q(["./util/createStyleSheet"],function(b){b(l)}),c();if("none"==d("div",g.replace(/\//g,"-").replace(/\..*/,"")+"-loaded","display"))return c();q(["./load-css"],function(b){b(s,c)})}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(q,d,g,f,k,p,c,s,l){return g("dgrid.OnDemandList",[q,d],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,
queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:s.defaultDelay,keepScrollPosition:!1,rowHeight:22,postCreate:function(){this.inherited(arguments);var b=this;c(this.bodyNode,"scroll",s[this.pagingMethod](function(c){b._processScroll(c)},null,this.pagingDelay))},renderQuery:function(b,c,d){function g(b){l(q,"!");if(b)throw a._refreshDeferred&&(a._refreshDeferred.reject(b),delete a._refreshDeferred),b;}var a=this,e={query:b,count:0,node:c,options:d},n=this.preload,h;if(!c){var p={node:l(this.contentNode,
"div.dgrid-preload",{rowIndex:0}),count:0,query:b,next:e,options:d};p.node.style.height="0";e.node=c=l(this.contentNode,"div.dgrid-preload");e.previous=p}c.rowIndex=this.minRowsPerPage;n?((e.next=n.next)&&c.offsetTop>=n.node.offsetTop?e.previous=n:(e.next=n,e.previous=n.previous),e.previous.next=e,e.next.previous=e):this.preload=e;var q=l(c,"-div.dgrid-loading");l(q,"div.dgrid-below").innerHTML=this.loadingMessage;d=f.mixin(this.get("queryOptions"),d,{start:0,count:this.minRowsPerPage},"level"in b?
{queryLevel:b.level}:null);this._trackError(function(){return h=b(d)});if("undefined"===typeof h)g();else return k.when(a.renderArray(h,c,d),function(b){return k.when("undefined"===typeof h.total?h.length:h.total,function(f){var g=b.length,k=c.parentNode,n=a.noDataNode;l(q,"!");"queryLevel"in d||(a._total=f);0===f&&(n&&(l(n,"!"),delete a.noDataNode),a.noDataNode=n=l("div.dgrid-no-data"),k.insertBefore(n,a._getFirstRowSibling(k)),n.innerHTML=a.noDataMessage);for(n=k=0;n<g;n++)k+=a._calcRowHeight(b[n]);
g&&k&&(a.rowHeight=k/g);f-=g;e.count=f;c.rowIndex=g;f?c.style.height=Math.min(f*a.rowHeight,a.maxEmptySpace)+"px":(c.style.display="none",d.count++);a._previousScrollPosition&&(a.scrollTo(a._previousScrollPosition),delete a._previousScrollPosition);a._processScroll();a._refreshDeferred&&(a._refreshDeferred.resolve(h),delete a._refreshDeferred);return b},g)},g),h},refresh:function(b){var d=this,f=b&&b.keepScrollPosition,g;"undefined"===typeof f&&(f=this.keepScrollPosition);f&&(this._previousScrollPosition=
this.getScrollPosition());this.inherited(arguments);if(this.store)return f=this._refreshDeferred=new k,g=d.renderQuery(function(a){return d.store.query(d.query,a)}),"undefined"===typeof g&&f.reject(),f.then(function(a){setTimeout(function(){c.emit(d.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:d,results:a})},0);delete d._refreshDeferred;return a},function(a){delete d._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(b){return b.lastChild},
_calcRowHeight:function(b){var c=b.previousSibling;return c&&!/\bdgrid-preload\b/.test(c.className)?b.offsetTop-c.offsetTop:b.offsetHeight},lastScrollTop:0,_processScroll:function(b){function c(b,e,f,h){var g=a.farOffRemoval,k=b.node;if(e>2*g){for(var n,p=k[f],q=0,r=0,s=[];n=p;){var t=a._calcRowHeight(n);if(q+t+g>e||0>p.className.indexOf("dgrid-row")&&0>p.className.indexOf("dgrid-loading"))break;p=n[f];q+=t;r+=n.count||1;a.removeRow(n,!0);s.push(n)}b.count+=r;h?(k.rowIndex-=r,d(b)):k.style.height=
k.offsetHeight+q+"px";var z=l("div",s);setTimeout(function(){l(z,"!")},1)}}function d(b,c){b.node.style.height=Math.min(b.count*a.rowHeight,c?Infinity:a.maxEmptySpace)+"px"}function g(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}var a=this,e=a.bodyNode;b=b&&b.scrollTop||this.getScrollPosition().y;var e=e.offsetHeight+b,n,h,p=a.preload,q=a.lastScrollTop,s=a.bufferRows*a.rowHeight,y=s-a.rowHeight,w,C,D,E=!0;for(a.lastScrollTop=b;p&&!p.node.offsetWidth;)p=p.previous;for(;p&&p!=
n;){n=a.preload;a.preload=p;h=p.node;var x=h.offsetTop;if(e+1+y<x)p=g(p,E=!1);else if(b-1-y>x+h.offsetHeight)p=g(p,E=!0);else{var v=((h.rowIndex?b-s:e)-x)/a.rowHeight,x=(e-b+2*s)/a.rowHeight,I=Math.max(Math.min((b-q)*a.rowHeight,a.maxRowsPerPage/2),a.maxRowsPerPage/-2),x=x+Math.min(Math.abs(I),10);0==h.rowIndex&&(v-=x);v=Math.max(v,0);10>v&&(0<v&&x+v<a.maxRowsPerPage)&&(x+=Math.max(0,v),v=0);x=Math.min(Math.max(x,a.minRowsPerPage),a.maxRowsPerPage,p.count);if(0==x)p=g(p,E);else{var x=Math.ceil(x),
v=Math.min(Math.floor(v),p.count-x),F=f.mixin(a.get("queryOptions"),p.options);p.count-=x;var u=h,M,J=a.queryRowsOverlap;if(I=0<h.rowIndex&&p){var L=p.previous;L&&(c(L,b-(L.node.offsetTop+L.node.offsetHeight),"nextSibling"),0<v&&L.node==h.previousSibling?(v=Math.min(p.count,v),p.previous.count+=v,d(p.previous,!0),h.rowIndex+=v,J=0):x+=v,p.count-=v);F.start=h.rowIndex-J;F.count=Math.min(x+J,a.maxRowsPerPage);h.rowIndex=F.start+F.count}else p.next&&(c(p.next,p.next.node.offsetTop-e,"previousSibling",
!0),u=h.nextSibling,u==p.next.node?(p.next.count+=p.count-v,p.next.node.rowIndex=v+x,d(p.next),p.count=v,J=0):M=!0),F.start=p.count,F.count=Math.min(x+J,a.maxRowsPerPage);M&&(u&&u.offsetWidth)&&(M=u.offsetTop);d(p);"level"in p.query&&(F.queryLevel=p.query.level);if("queryLevel"in F||!(F.start>a._total||0>F.count)){h=l(u,"-div.dgrid-loading[style\x3dheight:"+x*a.rowHeight+"px]");l(h,"div.dgrid-"+(I?"below":"above")).innerHTML=a.loadingMessage;h.count=x;var N=p.query(F);if(void 0===a._trackError(function(){return N})){l(h,
"!");return}(function(b,c,e,f){D=k.when(a.renderArray(f,b,F),function(h){C=f;u=b.nextSibling;l(b,"!");if(e&&u&&u.offsetWidth){var g=a.getScrollPosition();a.scrollTo({x:g.x,y:g.y+u.offsetTop-e,preserveMomentum:!0})}k.when(f.total||f.length,function(b){"queryLevel"in F||(a._total=b);c&&(c.count=b-c.node.rowIndex,0===c.count&&F.count++,d(c))});a._processScroll();return h},function(a){l(b,"!");throw a;})}).call(this,h,I,M,N);p=p.previous}}}}if(D&&(w=this._refreshDeferred))delete this._refreshDeferred,
k.when(D,function(){w.resolve(C)})},removeRow:function(b,c){if(b){var d=b.previousSibling,f=b.nextSibling,d=d&&(null!=d.observerIndex?d.observerIndex:d.previousObserverIndex),a=f&&(null!=f.observerIndex?f.observerIndex:f.nextObserverIndex),f=b.observerIndex;b.observerIndex=void 0;c&&(b.nextObserverIndex=a,b.previousObserverIndex=d);if(this.cleanEmptyObservers&&(-1<f&&f!==d&&f!==a)&&(d=this.observers,a=d[f])){if(!c)for(var e=a.rows,g=0;g<e.length;g++)if(e[g]!=b&&p.isDescendant(e[g],this.domNode))return this.inherited(arguments);
a.cancel();this._numObservers--;d[f]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),function(q,d,g,f,k,p,c){function s(b){return b}function l(b){if("object"!==typeof b)b=Error(b);else if("cancel"===b.dojoType)return;b.grid=this;k.emit(this.domNode,"dgrid-error",{grid:this,error:b,cancelable:!0,bubbles:!0})&&console.error(b)}return d("dgrid._StoreMixin",
null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};p.before(this,"configStructure",g.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(b){b.set&&
(this._columnsWithSet[b.field]=b);this.inherited(arguments)},_updateNotifyHandle:function(b){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);b&&"function"===typeof b.notify&&(this._notifyHandle=p.after(b,"notify",g.hitch(this,"_onNotify"),!0),b=this.get("sort"),(!b||!b.length)&&console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},
_setStore:function(b,c,d){this._updateNotifyHandle(b);this.store=b;this.dirty={};this.set("query",c,d)},_setQuery:function(b,c){var d=c&&c.sort;this.query=void 0!==b?b:this.query;this.queryOptions=c||this.queryOptions;d?this.set("sort",d):this.refresh()},setStore:function(b,c,d){q.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",b,c,d)},setQuery:function(b,c){q.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",b,c)},_getQueryOptions:function(){var b=
g.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)b.sort=this._sort;return b},_getQuery:function(){var b=this.query;return"object"==typeof b&&null!=b?g.delegate(b,{}):b},_setSort:function(b,c){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(b,c){this.inherited(arguments);b&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},insertRow:function(b,c,d,f,a){var e=this.store,l=this.dirty,e=e&&e.getIdentity(b),h;e in l&&
!(e in this._updating)&&(h=l[e]);h&&(b=g.delegate(b,h));return this.inherited(arguments)},updateDirty:function(b,c,d){var f=this.dirty,a=f[b];a||(a=f[b]={});a[c]=d},setDirty:function(b,c,d){q.deprecated("setDirty(...)","use updateDirty() instead","dgrid 0.4");this.updateDirty(b,c,d)},save:function(){function b(a,b){return function(e){var h=c._columnsWithSet,l=c._updating,k,n;if("function"===typeof e.set)e.set(b);else for(k in b)e[k]=b[k];for(k in h)n=h[k].set(e),void 0!==n&&(e[k]=n);l[a]=!0;return f.when(d.put(e),
function(){delete g[a];delete l[a]})}}var c=this,d=this.store,g=this.dirty,a=new f,e=a.promise,l=function(a){var b;return c.getBeforePut||!(b=c.row(a).data)?function(){return d.get(a)}:function(){return b}},h;for(h in g)var k=b(h,g[h]),e=e.then(l(h)).then(k);a.resolve();return e},revert:function(){this.dirty={};this.refresh()},_trackError:function(b){var c;"string"==typeof b&&(b=g.hitch(this,b));try{c=b()}catch(d){l.call(this,d)}return f.when(c,s,g.hitch(this,l))},newRow:function(){var b=this.inherited(arguments);
this.noDataNode&&(c(this.noDataNode,"!"),delete this.noDataNode);return b},removeRow:function(b,d){var f={element:b};!d&&(this.noDataMessage&&this.up(f).element===b&&this.down(f).element===b)&&(this.noDataNode=c(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),
function(q,d,g,f,k,p,c,s,l){function b(a,b){for(var c=a.unselectable=b?"on":"",e=a.getElementsByTagName("*"),d=e.length;--d;)"INPUT"===e[d].tagName||"TEXTAREA"===e[d].tagName||(e[d].unselectable=c)}function r(a,c){var e=a.bodyNode,d=c?"text":21>k("ff")?"-moz-none":"none";t&&"msUserSelect"!==t?e.style[t]=d:k("dom-selectstart")?!c&&!a._selectstartHandle?a._selectstartHandle=f(e,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):c&&a._selectstartHandle&&
(a._selectstartHandle.remove(),delete a._selectstartHandle):(b(e,!c),!c&&!a._unselectableHandle?a._unselectableHandle=p.after(a,"renderRow",function(a){b(a,!0);return a}):c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}k.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});k.add("pointer",function(a,b,c){return"onpointerdown"in c?"pointer":"onmspointerdown"in c?"MSPointer":!1});k.add("css-user-select",function(a,b,c){a=c.style;
b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var e="userSelect";do if("undefined"!==typeof a[e])return e;while(c--&&(e=b[c]+"UserSelect"));return!1});k.add("dom-selectstart","undefined"!==typeof document.onselectstart);var m=k("mac")?"metaKey":"ctrlKey",t=k("css-user-select"),a=(c=k("pointer"))&&"MS"===c.slice(0,2),e=c?c+(a?"Down":"down"):"mousedown",n=c?c+(a?"Up":"up"):"mouseup";return d("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:e+","+n+",dgrid-cellfocusin",selectionTouchEvents:k("touch")?
s.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();
this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){q.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?r(this,a):r(this,"none"===this.selectionMode);
this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===n&&b!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===e&&this.isSelected(b))this._waitForMouseUp=b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,
b){var c=a.keyCode?a.ctrlKey:a[m];this._lastSelected===b?this.select(b,null,!c||!this.isSelected(b)):(this.clearSelection(),this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var c=this._lastSelected,e=a.keyCode?a.ctrlKey:a[m],d;a.shiftKey||(d=e?null:!0,c=null);this.select(b,c,d);c||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?!this.isSelected(b):!(a.keyCode?a.ctrlKey:a[m]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,
b)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var a=this,b=this.contentNode,c=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};k("touch")&&!k("pointer")&&this.selectionTouchEvents?(f(b,s.selector(c,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),f(b,f.selector(c,this.selectionEvents),function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===n&&(a._ignoreMouseSelect=
null)})):f(b,f.selector(c,this.selectionEvents),function(b){a._handleSelect(b,this)});this.addKeyHandler&&this.addKeyHandler(32,function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[m]&&(65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className))&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&p.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,
e,d){c=e||c&&c[b.idProperty||"id"];if(null!=c&&(e=(c=b.row(c))&&b.selection[c.id]))b[d](c,null,e)}var b=this,c=this.store,e,d;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(e=p.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),d=p.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){e.remove();d.remove()}):(e=p.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=
function(){e.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,e;e={bubbles:!0,grid:this};c&&(e.parentType=c.type);e[this._selectionTargetType]=b;f.emit(this.contentNode,"dgrid-"+a,e);this._selectionEventQueues[a]=[]},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,c){var e,d,f;"undefined"===typeof c&&(c=!0);a.element||
(a=this.row(a));if(!1===c||this.allowSelect(a))if(e=this.selection,d=!!e[a.id],null===c&&(c=!d),f=a.element,!c&&!this.allSelected?delete this.selection[a.id]:e[a.id]=c,f&&(c?l(f,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):l(f,"!dgrid-selected!ui-state-active")),c!==d&&f&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element){e=this._determineSelectionDirection(f,b);e||(b=document.getElementById(b.id),e=this._determineSelectionDirection(f,
b));for(;a.element!=b&&(a=this[e](a));)this._select(a,null,c)}}else this._lastSelected=f,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:k("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:
function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,
null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);g.when(b,function(b){var c=a.selection,e,d,f;for(e=0;e<b.length;e++)d=a.row(b[e]),
(f=d.id in c?c[d.id]:a.allSelected)&&a._select(d,null,f);a._fireSelectionEvents()});return b}})})},"xstyle/main":function(){define("xstyle/main",["require","put-selector/put"],function(q,d){function g(a,b){return a&&a.then?a.then(b):b(a)}function f(a,b,c){return g(a,function(a){var e=b[0];if(!a)return c(e||a);if(e&&a.get)return f(a.get(e),b.slice(1),c);if(a.receive)return a.receive(e?function(a){f(a,b,c)}:c);if(e)return f(a[e],b.slice(1),c);c(a)})}function k(a,b,c){f(a,b.slice(0,b.length-1),function(a){var e=
b[b.length-1];a.set?a.set(e,c):a[e]=c})}function p(a){a=x.getElementsByTagName(a);for(var b=0;b<a.length;b++)l(a[b])}function c(){return this.join("")}function s(a){this.value=a}function l(a,c,e){function d(){q(["xstyle/load-imports"],function(b){b(a,function(){l(a,c,!0)})})}var f=a.sheet||a.styleSheet||a,h=f.needsParsing,g=f.rules||f.cssRules;if(f.imports&&!e&&f.imports.length)return d();if(!h)for(var m=0;m<g.length;m++){var k=g[m];if(k.href&&!e)return d();k.selectorText&&"x-"==k.selectorText.substring(0,
2)&&(h=!0,/^'/.test(k.style.content))}b(f.localSource||(f.ownerNode||f.ownerElement).innerHTML,f,c)}function b(a,d,f){function m(a,b,c){(F[a]||(F[a]={}))[b]=c}function k(a){F[a]||(F[a]={});m("selector","x-"+a,{onRule:function(b){b.eachProperty(function(b,c){var e=c.toString();do{e=e.match(/([^, \(]+)(?:[, ]+(.+))?/);if(!e)break;var d=e[1];if("module"==d)return m(a,b,c[1].args[0]);if("default"==d){if("pseudo"==a)try{x.querySelectorAll("x:"+b);break}catch(f){}}else if("prefix"!=d)return m(a,b,function(){return c})}while(e=
e[2])})}})}function l(){}function p(a){this.caller=a;this.args=[]}function r(a,b){b.onRule();var c=F.selector[a];c&&t(c,"onRule",b)}function t(a,b,c,e){if(a){var h=G,g=function(a){"string"==typeof a&&d.addRule(h.fullSelector(),a);0==--S&&f&&f(d)};S++;var m=function(a){function f(a){console.error("Error occurred processing "+b.slice(2).toLowerCase()+" "+c+("{"==h.operator?' in rule "'+h.selector+'" {'+h.cssText:"")+". "+a.message);a&&console.error(a)}try{var m=a[b](c,e,h,d);h instanceof p&&(h.result=
m);m&&m.then?m.then(g,f):g(m)}catch(k){f(k)}};"string"==typeof a?q([a],m):m(a)}}function D(a,e){function d(a,b){b||(k+=a);if(H)if(H.push)"string"==typeof H[H.length-1]&&"string"==typeof a?H[H.length-1]+=a:a&&H.push(a);else if("string"==typeof H&&"string"==typeof a)H+=a;else{var e=[H,a];e.toString=c;H=e}else H=a}G=O;for(var g=A.lastIndex=0,m=!0,k="",l=!0;;){var n=A.exec(a),p=n[4],q=n[1],K=n[2],n=n[3],u,x,H,Q,n=n&&v(n),q=v(q);if(l){if(K?(k=x=q,u=K.charAt(0),Q="?"==K.charAt(1)):k=n=q,H=n,x||"/"!=p)l=
!1}else n=n?q+K:q,d(n);switch(p){case "'":case '"':var R="'"==p?B:y;R.lastIndex=A.lastIndex;(p=R.exec(a))||error("unterminated string");p=p[1];A.lastIndex=R.lastIndex;d(new s(p));continue;case "/":"*"==a[A.lastIndex]?(w.lastIndex=A.lastIndex+1,w.exec(a),A.lastIndex=w.lastIndex):d("/");continue;case "\\":p=R.lastIndex++;d(a.charAt(p));continue;case "(":case "{":case "[":var V=!1;if("{"==p){l=!0;d(q=G.newRule(k),!0);if(u){m=!1;if(!K||"\x3e"==K.charAt(1))H.creating=!0;"\x3d"==u&&n&&(V=!0)}G.root&&m&&
(q.cssRule=e.cssRules[g++])}else K=n.match(/(.*?)([\w-]*)$/),d(q=G.newCall(K[2],H,G)),q.ref=h(G,K[2]),(H.calls||(H.calls=[])).push(q);q.parent=G;q.selector=H.creating?".x-generated-"+C++:G.root?k:G.selector+" "+k;V&&(K=h(G,n.match(/[^\s]+$/)[0],!0))&&z(K,q);G.currentName=x;G.currentSequence=H;G.assignmentOperator=u;J.push(G=q);G.operator=p;G.start=A.lastIndex;k="";G.selector&&G.selector.replace(/:([-\w]+)/,function(a,b){var c=F.pseudo[b];c&&t(c,"onPseudo",b,G)});H=x=null;continue}if(H)if(q=H[0],q.charAt&&
"@"==q.charAt(0))"import"==H[0].slice(1,7)&&(K=b.getStyleSheet(e.cssRules[g++],H,e),S++,n=A.lastIndex,D(K.localSource,K),A.lastIndex=n);else try{G[":"==u?"setValue":"declareProperty"](x,H,Q)}catch(W){console.error(W.stack||W)}switch(p){case ":":l=!0;u=":";break;case "}":case ")":case "]":E[G.operator]!=p&&console.error("Incorrect opening operator "+G.operator+" with closing operator "+p);x=null;G.cssText=a.slice(G.start,A.lastIndex-1);"}"==p&&(r(G.selector,G),m=!0,k="");J.pop();G=J[J.length-1];H=
G.currentSequence;x=G.currentName;u=G.assignmentOperator;G.root&&"}"==p&&(l=!0,u=!1);break;case "":f&&f();return;case ";":H=null,l=!0,u=m=!1,k=""}}}d.addRule||(d.addRule=function(a,b,c){return this.insertRule(a+"{"+b+"}",0<=c?c:this.cssRules.length)});d.deleteRule||(d.deleteRule=d.removeRule);var F={property:{}};k("property");k("function");k("pseudo");F["function"]["var"]=P;F["function"]["extends"]=P;var S=1;(d.href||location.href).replace(/[^\/]+$/,"");l.prototype={eachProperty:function(a){for(var b=
this.values||0,c=0;c<b.length;c++){var e=b[c];a.call(this,e||"unnamed",b[e])}},fullSelector:function(){return(this.parent?this.parent.fullSelector():"")+(this.selector||"")+" "},newRule:function(a){return(this.rules||(this.rules={}))[a]=new l},newCall:function(a,b,c){return new p(a)},addSheetRule:function(a,b){if(b&&"@"!=a.charAt(0)){var c=d.addRule(a,b);-1==c&&(c=d.cssRules.length-1);return d.cssRules[c]}},onRule:function(){this.getCssRule()},getCssRule:function(){this.cssRule||(this.cssRule=this.addSheetRule(this.selector,
this.cssText));return this.cssRule},get:function(a){return this.values[a]},declareProperty:function(a,b,c){if("\x3e"==b[0].toString().charAt(0))a||(this.generator=b,b=e(b,this),P.addRenderer("",b,this,b));else{var d=a in I.style||h(this,a);if(!c||!d)(this.properties||(this.properties={}))[a]=b,d&&console.warn('Overriding existing property "'+a+'"')}},setValue:function(a,b){var c=this.values||(this.values=[]);c.push(a);c[a]=b;if(c=b.calls)for(var e=0;e<c.length;e++){var d=c[e],f=d.ref;f&&"function"==
typeof f.call&&f.call(d,this,a,b)}if(a){do{if(c=h(this,a)){var m=this;g(n(m,a,c),function(c){c=c.splice?c:[c];for(var e=0;e<c.length&&!c[e].put(b,m,a);e++);});break}a=a.substring(0,a.lastIndexOf("-"))}while(a)}},cssText:""};var Q=p.prototype=new l;Q.declareProperty=Q.setValue=function(a,b){this.args.push(b)};Q.toString=function(){var a=this.operator;return a+this.args+E[a]};var G,O=new l;O.root=!0;O.properties={Math:Math,module:function(a){return{then:function(b){q([a],b)}}},item:{forElement:function(a){for(;!a.item;)a=
a.parentNode;return{element:a,receive:function(b){b(a.item)}}}},prefix:{put:function(a,b,c){if("string"==typeof I.style[u+c])return b.addSheetRule(b.selector,u+c+":"+a)}},"var":{put:function(a,b,c){(b.variables||(b.variables={}))[c]=a;b=(b=b.variableListeners)&&b[c]||0;for(c=0;c<b.length;c++)b[c](a)},call:function(a,b,c,e){this.receive(function(a){b.addSheetRule(b.selector,c+": "+e.toString().replace(/var\([^)]+\)/g,a))},b,a.args[0])},receive:function(a,b,c){var e=b;do{if(b=e.variables&&e.variables[c])return e=
e.variableListeners||(e.variableListeners={}),(e[c]||(e[c]=[])).push(a),a(b);e=e.parent}while(e);a()}},on:{put:function(a,b,c){console.log("add event listener");n(b,c,a)}}};O.css=a;O.parse=D;var J=[O];D(a,d);0==--S&&f&&f(d);return O}function r(){p("link");p("style");if(!T)if(T=!0,M["dom-qsa2.1"]){for(var b=0,c=L.length;b<c;b++)m(L[b]);t()}else for(var e=x.all,b=0,c=e.length;b<c;b++)a(e[b])}function m(a){for(var b=x.querySelectorAll(a.selector),c=a.name,e=0,d=b.length;e<d;e++){var f=b[e],h=f.elementalStyle;
h||(h=f.elementalStyle={},f.elementalSpecificities={});var g=f.renderings;g||(g=f.renderings=[],N.push(f));g.push({name:c,rendered:h[c]==a.propertyValue,renderer:a});h[c]=a.propertyValue}}function t(){for(var a=0;a<N.length;a++){var b=N[a],c=b.renderings,e=b.elementalStyle;delete b.renderings;for(var f=0;f<c.length;f++){var h=c[f],g=h.renderer,m=g.rendered;U=e[h.name]==g.propertyValue;if(!m&&U)try{g.render(b)}catch(k){console.error(k,k.stack),d(b,"div.error",k.toString())}m&&(!U&&g.unrender)&&(g.unrender(b),
c.splice(f--,1))}}N=[]}function a(a,b){for(var c=0,e=L.length;c<e;c++){var d=L[c];(!b||b==d.selector)&&(J?J.call(a,d.selector):a.currentStyle[d.name]==d.propertyValue)&&d.render(a)}}function e(a,b){C++;a=a.sort?a:[a];return function(c,f){for(var h=c,m=0,k=a.length;m<k;m++){var l=a[m];try{if(l.eachProperty)if(l.args)if("("==l.operator){var p=a[m+1];p&&p.eachProperty&&d(h,p.selector);var q=l.args.toString(),r=n(l,0,q);(function(a,c){g(r,function(f){f.forElement&&(f=f.forElement(c));var h=a.appendChild(x.createTextNode("Loading"));
f.receive(function(b){if(b&&b.sort){h&&(h.parentNode.removeChild(h),h=null);var c=p&&p.eachProperty&&p.get("each");c&&(c=e(c,p));b.forEach(c?function(b){c(a,b)}:function(b){d(a,D[a.tagName]||"div",b)})}else"value"in a?(a.value=b,a["-x-variable"]=f):h.nodeValue=b},b,q)})})(h,c)}else d(h,l.toString());else d(h,l.selector),P.update(h,l.selector);else if("string"==typeof l){"\x3d"==l.charAt(0)&&(l=l.slice(1));for(var s=l.split(","),l=0,t=s.length;l<t;l++){var z=s[l].trim();if(z){var z=z.replace(/\([^)]*\)/,
function(a){}),A=d(0==l?h:c,z);f&&(A.item=f);p=a[m+1];A!=h&&(!p||!p.eachProperty)&&P.update(A);h=A}}}else h.appendChild(x.createTextNode(l.value))}catch(u){console.error(u,u.stack),h.appendChild(x.createTextNode(u))}}return h}}function n(a,b,c){function e(){var a=m.length+1,b=[],c=[],d,h,l=function(e){return function(f){b[e]=f;a--;if(0>=a){h=!0;d=r?r.apply(this,b):b[0];for(f=0;f<c.length;f++)c[f](d)}}};if(r)for(var n=0;n<m.length;n++){var p=m[n];f(p[0],p.slice(1),l(n))}else{var p=m[0],q={then:function(a){c.push(a)}};
g(p[0],function(a){q=a;for(var b=1;b<p.length;b++)if(q&&q.get)q=q.get(p[b]);else{q={receive:function(b){f(a,p.slice(1),b)},put:function(a){k(resolve,p.slice(1),a)}};break}for(b=0;b<c.length;b++)c[b](q)});return q}l(-1)();return d&&d.then?d:{receive:function(a){c&&c.push(a);h&&a(d)}}}var d=a["var-expr-"+b];if(m)return d;var m=[],l;m.id=C++;var p=[],q;c=c.join?c.join(""):c.toString();d=c.match(/^[\w_$\/\.-]*$/);c=c.replace(/("[^\"]*")|([\w_$\.\/-]+)/g,function(b,c,e){if(e){q=e.split("/");b=q.join("_");
p.push(b);m.push(q);c=q[0];e=h(a,c);if("string"==typeof e||e instanceof Array)e=n(a,c,e);else if(!e)throw Error('Could not find reference "'+c+'"');e.forElement&&(l=!0);q[0]=e}return b});if(!d)var r=Function.apply(this,p.concat(["return xstyleReturn("+c+")"]));m.func=r;a["var-expr-"+b]=m;return a["var-expr-"+b]=l?{forElement:function(b){for(var c,d=b;!J.call(b,a.selector);)b=b.parentNode;for(b=0;b<m.length;b++){var f=m[b],h=f[0];h.forElement&&(h=f[0]=h.forElement(d));f=h.element;if(d!=c){for(;d!=
f;){if(d==c)return;d=d.parentNode}c=d}}d=c["expr-result-"+m.id];d||(c["expr-result-"+m.id]=d=e(),d.element=c);return d}}:e()}function h(a,b,c){do{var e=a.properties&&a.properties[b]||c&&a.rules&&a.rules[b];a=a.parent}while(!e&&a);return e}function z(a,b){b.cssText+=a.cssText;"values,properties,variables,calls".replace(/\w+/g,function(c){a[c]&&(b[c]=Object.create(a[c]))});var c=b.getCssRule();a.eachProperty(function(a,e){b.setValue(a,e);if(a){var d=c.style;d[a]||(d[a]=e)}});a.generator&&b.declareProperty(null,
a.generator)}var A=/\s*([^{\}\[\]\(\)\/\\'":=;]*)([=:]\??\s*([^{\}\[\]\(\)\/\\'":;]*))?([{\}\[\]\(\)\/\\'":;]|$)/g,B=/((?:\\.|[^'])*)'/g,y=/((?:\\.|[^"])*)"/g,w=/\*\//g,C=0,D={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},E={"{":"}","[":"]","(":")"},x=document,v="".trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")},I=x.createElement("div");s.prototype.toString=function(){return'"'+this.value.replace(/["\\\n\r]/g,"\\$\x26")+'"'};var F=navigator.userAgent,
u=-1<F.indexOf("WebKit")?"-webkit-":-1<F.indexOf("Firefox")?"-moz-":-1<F.indexOf("MSIE")?"-ms-":-1<F.indexOf("Opera")?"-o-":"";b.getStyleSheet=function(a,b){return a.styleSheet};x.addEventListener("change",function(a){a=a.target;var b=a["-x-variable"];b.put&&b.put(a.value)});var I=x.createElement("div"),M={"dom-qsa2.1":!!I.querySelectorAll},J=I.matches||I.matchesSelector||I.webkitMatchesSelector||I.mozMatchesSelector||I.msMatchesSelector||I.oMatchesSelector,L=[],N=[],T;/e/.test(x.readyState||"")?
setTimeout(r,200):x.addEventListener("DOMContentLoaded",r);var U,P={process:l,vendorPrefix:u,applyProperty:function(a,b){return"opacity"==a&&"-ms-"==u?"filter: alpha(opacity\x3d"+100*b+"); zoom: 1;":u+a+":"+b+";"},onFunction:function(a,b,c){},onCall:function(a,b){function c(){var b=d,f="extends"==a?"rules":"variables";do{if(!b)throw Error('Could not find "'+e[0]+'" in the defined '+f);var h=b[f]&&b[f][e[0]],b=b.parent}while(!h);return h}var e=b.args,d=b.parent;if("extends"==a){var f=c();z(f,d)}else if("var"==
a)return function(a){a.addSheetRule(a.selector,a.currentName+": "+a.currentSequence.toString().replace(/var\([^)]+\)/g,c()))}},parse:b,addRenderer:function(a,b,c,e){a={selector:c.selector,propertyValue:b,name:a,render:e};L.push(a);T&&m(a);t()},update:a,clearRenderers:function(){L=[]},load:function(a,b,c,e){b(["xstyle/css"],function(d){d.load(a,b,c,e)})}};return P});xstyleReturn=function(q){return 1==arguments.length?q:[].slice.call(arguments)}},"dojo/store/Memory":function(){define(["../_base/declare",
"./util/QueryResults","./util/SimpleQueryEngine"],function(q,d,g){return q("dojo.store.Memory",null,{constructor:function(d){for(var g in d)this[g]=d[g];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:g,get:function(d){return this.data[this.index[d]]},getIdentity:function(d){return d[this.idProperty]},put:function(d,g){var p=this.data,c=this.index,q=this.idProperty,q=d[q]=g&&"id"in g?g.id:q in d?d[q]:Math.random();if(q in c){if(g&&!1===g.overwrite)throw Error("Object already exists");
p[c[q]]=d}else c[q]=p.push(d)-1;return q},add:function(d,g){(g=g||{}).overwrite=!1;return this.put(d,g)},remove:function(d){var g=this.index,p=this.data;if(d in g)return p.splice(g[d],1),this.setData(p),!0},query:function(f,g){return d(this.queryEngine(f,g)(this.data))},setData:function(d){d.items?(this.idProperty=d.identifier||this.idProperty,d=this.data=d.items):this.data=d;this.index={};for(var g=0,p=d.length;g<p;g++)this.index[d[g][this.idProperty]]=g}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],
function(q){return function(d,g){function f(f){f=q.filter(f,d);var c=g&&g.sort;c&&f.sort("function"==typeof c?c:function(d,b){for(var f,g=0;f=c[g];g++){var k=d[f.attribute],a=b[f.attribute],k=null!=k?k.valueOf():k,a=null!=a?a.valueOf():a;if(k!=a)return!!f.descending==(null==k||k>a)?-1:1}return 0});if(g&&(g.start||g.count)){var k=f.length;f=f.slice(g.start||0,(g.start||0)+(g.count||Infinity));f.total=k}return f}switch(typeof d){default:throw Error("Can not query with a "+typeof d);case "object":case "undefined":var k=
d;d=function(d){for(var c in k){var f=k[c];if(f&&f.test){if(!f.test(d[c],d))return!1}else if(f!=d[c])return!1}return!0};break;case "string":if(!this[d])throw Error("No filter function "+d+" was found in store");d=this[d];case "function":}f.matches=d;return f}})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m){g.isAsync||
s(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var t=d("dojo.dnd.Source",r,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){f.mixin(this,f.mixin({},b));var c=this.accept;if(c.length){this.accept={};for(var d=0;d<c.length;++d)this.accept[c[d]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState=
"";this.isSource&&k.add(this.node,"dojoDndSource");this.targetState="";this.accept&&k.add(this.node,"dojoDndTarget");this.horizontal&&k.add(this.node,"dojoDndHorizontal");this.topics=[l.subscribe("/dnd/source/over",f.hitch(this,"onDndSourceOver")),l.subscribe("/dnd/start",f.hitch(this,"onDndStart")),l.subscribe("/dnd/drop",f.hitch(this,"onDndDrop")),l.subscribe("/dnd/cancel",f.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var c=0;c<
b.length;++c){for(var d=a.getItem(b[c].id).type,f=!1,g=0;g<d.length;++g)if(d[g]in this.accept){f=!0;break}if(!f)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==m.manager().target);if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){t.superclass.destroy.call(this);q.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){t.superclass.onMouseMove.call(this,
a);var c=m.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var d=this.getSelectedNodes();d.length&&c.startDrag(this,d,this.copyState(b.getCopyKeyState(a),!0))}if(this.isDragging){d=!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=p.position(this.current,!0);d=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==p.isBodyLtr(this.current.ownerDocument):a.pageY-
this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||d!=this.before)this._markTargetAnchor(d),c.canDrop(!this.current||c.source!=this||!(this.current.id in this.selection))}}},onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||!b.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,t.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,t.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==
a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=m.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,b,c){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?c?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&m.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,
b,c,d){if(this==d)this.onDrop(a,b,c);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,c){if(this!=a)this.onDropExternal(a,b,c);else this.onDropInternal(b,c)},onDropExternal:function(a,c,d){var f=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return f.call(this,a.getItem(b.id).data,
c)}:d?function(c){var e=a.getItem(c.id);c=c.cloneNode(!0);c.id=b.getUniqueId();return{node:c,data:e.data,type:e.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();!d&&!this.creator&&a.selectNone();this.insertNodes(!0,c,this.before,this.current);!d&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=f},onDropInternal:function(a,c){var d=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(c)this._normalizedCreator=
this.creator?function(a,b){return d.call(this,this.getItem(a.id).data,b)}:function(a){var c=this.getItem(a.id);a=a.cloneNode(!0);a.id=b.getUniqueId();return{node:a,data:c.data,type:c.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=d}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){t.superclass.onOverEvent.call(this);
m.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){t.superclass.onOutEvent.call(this);m.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){this.current==this.targetAnchor&&this.before==a||(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&
this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!c.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(k.contains(a,"dojoDndHandle"))return!0;
if(k.contains(a,"dojoDndItem")||k.contains(a,"dojoDndIgnore"))break}return!1}});return t})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m){var t=d("dojo.dnd.Selector",m,{constructor:function(a,c){c||(c={});this.singular=c.singular;this.autoSync=c.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;
this.events.push(l(this.node,b.press,f.hitch(this,"onMouseDown")),l(this.node,b.release,f.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new s,b=r._empty,c;for(c in this.selection)c in b||a.push(k.byId(c));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(k.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=r._empty,
b;for(b in this.selection)if(!(b in a)){var c=k.byId(b);this.delItem(b);p.destroy(c)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,b){b=b||g.global;var c=this.selection,d=r._empty,f;for(f in c)f in d||a.call(b,this.getItem(f),f,this)},sync:function(){t.superclass.sync.call(this);this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=r._empty,c;for(c in this.selection)c in b||this.getItem(c)||a.push(c);q.forEach(a,function(a){delete this.selection[a]},
this);return this},insertNodes:function(a,b,c,d){var f=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=f.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};t.superclass.insertNodes.call(this,
b,c,d);this._normalizedCreator=f;return this},destroy:function(){t.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!r.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,c.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){r.getCopyKeyState(a)||this._removeSelection();var b=this.getAllNodes();if(b.length&&(this.anchor||(this.anchor=
b[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,f;d<b.length&&!(f=b[d],f==this.anchor||f==this.current);++d);for(++d;d<b.length;++d){f=b[d];if(f==this.anchor||f==this.current)break;this._addItemClass(f,"Selected");this.selection[f.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?r.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=
this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):r.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=
1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=l(this.node,
b.move,f.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=r._empty,b;for(b in this.selection)if(!(b in a)){var c=k.byId(b);c&&this._removeItemClass(c,"Selected")}this.selection={};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return t})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r,m,t,a){d=d("dojo.dnd.Container",l,{skipForm:!1,allowNested:!1,constructor:function(a,b){this.node=p.byId(a);b||(b={});this.creator=b.creator||null;this.skipForm=b.skipForm;this.parent=b.dropParent&&p.byId(b.dropParent);this.map={};this.current=null;this.containerState="";c.add(this.node,"dojoDndContainer");(!b||!b._skipStartup)&&this.startup();this.events=[r(this.node,t.over,f.hitch(this,"onMouseOver")),r(this.node,t.out,f.hitch(this,"onMouseOut")),r(this.node,"dragstart",
f.hitch(this,"onSelectStart")),r(this.node,"selectstart",f.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(b,c){c=c||g.global;var d=this.map,f=a._empty,m;for(m in d)m in f||b.call(c,d[m],m,this);return c},clearItems:function(){this.map={}},getAllNodes:function(){return m((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var b={};this.getAllNodes().forEach(function(c){if(c.id){var d=
this.getItem(c.id);if(d){b[c.id]=d;return}}else c.id=a.getUniqueId();var d=c.getAttribute("dndType"),f=c.getAttribute("dndData");b[c.id]={data:f||c.innerHTML,type:d?d.split(/\s*,\s*/):["text"]}},this);this.map=b;return this},insertNodes:function(a,b,c){this.parent.firstChild?b?c||(c=this.parent.firstChild):c&&(c=c.nextSibling):c=null;var d;if(c)for(b=0;b<a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),c.parentNode.insertBefore(d.node,c);else for(b=0;b<
a.length;++b)d=this._normalizedCreator(a[b]),this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node);return this},destroy:function(){q.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,c){a._skipStartup=!0;return new c(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var b=this.parent.getElementsByTagName("tbody");b&&b.length&&(this.parent=
b[0])}this.defaultCreator=a._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&b!=this.node;)try{b=b.parentNode}catch(c){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&
(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(b){if(!this.skipForm||!a.isFormElement(b))b.stopPropagation(),b.preventDefault()},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var d="dojoDnd"+a,f=a.toLowerCase()+"State";c.replace(this.node,d+b,d+this[f]);this[f]=b},_addItemClass:function(a,b){c.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){c.remove(a,"dojoDndItem"+b)},
_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&c.contains(a,"dojoDndItem"))return a;return null},_normalizedCreator:function(b,d){var h=(this.creator||this.defaultCreator).call(this,b,d);f.isArray(h.type)||(h.type=["text"]);h.node.id||(h.node.id=a.getUniqueId());c.add(h.node,"dojoDndItem");return h}});a._createNode=function(b){return!b?a._createSpan:function(a){return s.create(b,{innerHTML:a})}};a._createTrTd=function(a){var b=
s.create("tr");s.create("td",{innerHTML:a},b);return b};a._createSpan=function(a){return s.create("span",{innerHTML:a})};a._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};a._defaultCreator=function(b){b=b.tagName.toLowerCase();var c="tbody"==b||"thead"==b?a._createTrTd:a._createNode(a._defaultCreatorNodes[b]);return function(b,d){var e=b&&f.isObject(b),g,m;e&&b.tagName&&b.nodeType&&b.getAttribute?(g=b.getAttribute("dndData")||b.innerHTML,e=(e=b.getAttribute("dndType"))?e.split(/\s*,\s*/):
["text"],m=b):(g=e&&b.data?b.data:b,e=e&&b.type?b.type:["text"],m=("avatar"==d?a._createSpan:c)(String(g)));m.id||(m.id=a.getUniqueId());return{node:m,data:g,type:e}}};return d})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a){var e=d("dojo.dnd.Manager",[p],{constructor:function(){this.source=this.avatar=
null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:c("touch")?0:16,OFFSET_Y:c("touch")?-64:16,overSource:function(a){this.avatar&&(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());b.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),b.publish("/dnd/source/over",null)):b.publish("/dnd/source/over",null)},startDrag:function(a,
c,d){function e(a){a.preventDefault();a.stopPropagation()}t.autoScrollStart(f.doc);this.source=a;this.nodes=c;this.copy=Boolean(d);this.avatar=this.makeAvatar();f.body().appendChild(this.avatar.node);b.publish("/dnd/start",a,c,this.copy);this.events=[l(f.doc,r.move,g.hitch(this,"onMouseMove")),l(f.doc,r.release,g.hitch(this,"onMouseUp")),l(f.doc,"keydown",g.hitch(this,"onKeyDown")),l(f.doc,"keyup",g.hitch(this,"onKeyUp")),l(f.doc,"dragstart",e),l(f.body(),"selectstart",e)];k.add(f.body(),"dojoDnd"+
(d?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){k.remove(f.body(),["dojoDndCopy","dojoDndMove"]);q.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new a(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var b=this.avatar;b&&(t.autoScrollNodes(a),b=b.node.style,
b.left=a.pageX+this.OFFSET_X+"px",b.top=a.pageY+this.OFFSET_Y+"px",b=Boolean(this.source.copyState(m.getCopyKeyState(a))),this.copy!=b&&this._setCopyStatus(b));c("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var c=Boolean(this.source.copyState(m.getCopyKeyState(a)));b.publish("/dnd/drop/before",this.source,this.nodes,c,this.target,a);b.publish("/dnd/drop",this.source,this.nodes,c,this.target,a)}else b.publish("/dnd/cancel");this.stopDrag()}},
onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case s.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case s.ESCAPE:b.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==s.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();k.replace(f.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?
"Move":"Copy"))}});m._manager=null;e.manager=m.manager=function(){m._manager||(m._manager=new e);return m._manager};return e})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),function(q,d,g,f,k,p,c,s){return q("dojo.dnd.Avatar",null,{constructor:function(c){this.manager=c;this.construct()},construct:function(){var d=p.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",
margin:"0px"}}),b=this.manager.source,g,m=p.create("tbody",null,d),k=p.create("tr",null,m),a=p.create("td",null,k),e=Math.min(5,this.manager.nodes.length),n=0;c("highcontrast")&&p.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},a);p.create("span",{innerHTML:b.generateText?this._generateText():""},a);for(f.set(k,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});n<e;++n)b.creator?g=b._normalizedCreator(b.getItem(this.manager.nodes[n].id).data,"avatar").node:(g=this.manager.nodes[n].cloneNode(!0),
"tr"==g.tagName.toLowerCase()&&(k=p.create("table"),p.create("tbody",null,k).appendChild(g),g=k)),g.id="",k=p.create("tr",null,m),a=p.create("td",null,k),a.appendChild(g),f.set(k,{"class":"dojoDndAvatarItem",style:{opacity:(9-n)/10}});this.node=d},destroy:function(){p.destroy(this.node);this.node=!1},update:function(){k.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(c("highcontrast")){var d=g.byId("a11yIcon"),b="+";this.manager.canDropFlag&&!this.manager.copy?b="\x3c ":!this.manager.canDropFlag&&
!this.manager.copy?b="o":this.manager.canDropFlag||(b="x");d.innerHTML=b}s("tr.dojoDndAvatarHeader td span"+(c("highcontrast")?" span":""),this.node).forEach(function(b){b.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"dijit/CheckedMenuItem":function(){define(["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(q,d,g,f){return q("dijit.CheckedMenuItem",
g,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:f,checked:!1,_setCheckedAttr:function(d){this.domNode.setAttribute("aria-checked",d?"true":"false");this._set("checked",d)},iconClass:"",role:"menuitemcheckbox",checkedChar:"\x26#10003;",onChange:function(){},_onClick:function(d){this.disabled||(this.set("checked",!this.checked),this.onChange(this.checked));this.onClick(d)}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(q){return q})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),
function(q,d,g,f,k,p,c,s,l){f("dijit-legacy-requires")&&p(0,function(){q(["dijit/form/RadioButton"])});return d("dijit.form.CheckBox",[c,s],{templateString:l,baseClass:"dijitCheckBox",_setValueAttr:function(b,c){"string"==typeof b&&(this.inherited(arguments),b=!0);this._created&&this.set("checked",b,c)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},
_fillContent:function(){},_onFocus:function(){this.id&&k("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&k("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(q,d){return q("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(g){this._set("readOnly",
g);d.set(this.focusNode,"readOnly",g)},_setLabelAttr:void 0,_getSubmitValue:function(d){return null==d||""===d?"on":d},_setValueAttr:function(g){g=this._getSubmitValue(g);this._set("value",g);d.set(this.focusNode,"value",g)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));d.set(this.focusNode,"value",this.value)},_onClick:function(d){return this.readOnly?(d.stopPropagation(),d.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/ComboBox":function(){define(["dojo/_base/declare",
"./ValidationTextBox","./ComboBoxMixin"],function(q,d,g){return q("dijit.form.ComboBox",[d,g],{})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(q,d,g,f,k,p,c,s,l){return q("dijit.form.ComboBoxMixin",[s,p],{dropDownClass:c,hasDownArrow:!0,templateString:l,baseClass:"dijitTextBox dijitComboBox",
cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(b){this._set("hasDownArrow",b);this._buttonNode.style.display=b?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(b){b.get||f.mixin(b,{_oldAPI:!0,get:function(b){var c=new d;this.fetchItemByIdentity({identity:b,onItem:function(b){c.resolve(b)},onError:function(b){c.reject(b)}});return c.promise},query:function(b,c){var g=new d(function(){a.abort&&a.abort()});
g.total=new d;var a=this.fetch(f.mixin({query:b,onBegin:function(a){g.total.resolve(a)},onComplete:function(a){g.resolve(a)},onError:function(a){g.reject(a)}},c));return k(g)}});this._set("store",b)},postMixInProperties:function(){var b=this.params.store||this.store;b&&this._setStoreAttr(b);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var c=this.declaredClass;f.mixin(this.store,{getValue:function(b,d){g.deprecated(c+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly",
"","2.0");return b[d]},getLabel:function(b){g.deprecated(c+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return b.name},fetch:function(b){g.deprecated(c+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],f.hitch(this,function(c){(new c({objectStore:this})).fetch(b)}))}})}}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),
function(q,d,g,f,k,p,c,s,l,b,r){d=d("dijit.form._AutoCompleterMixin",r,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(b){var c=0;if("number"==typeof b.selectionStart)c=b.selectionStart;else if(s("ie")){var a=b.ownerDocument.selection.createRange().duplicate();b=b.createTextRange();a.move("character",0);b.move("character",0);try{b.setEndPoint("EndToEnd",a),c=String(b.text).replace(/\r/g,"").length}catch(d){}}return c},
_setCaretPos:function(c,d){d=parseInt(d);b.selectInputText(c,d,d)},_setDisabledAttr:function(b){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",b?"true":"false")},_onKey:function(b){if(!(32<=b.charCode)){var c=b.charCode||b.keyCode;if(!(c==f.ALT||c==f.CTRL||c==f.META||c==f.SHIFT)){var a=this.dropDown,d=null;this._abortQuery();this.inherited(arguments);if(!b.altKey&&!b.ctrlKey&&!b.metaKey)switch(this._opened&&(d=a.getHighlightedOption()),c){case f.PAGE_DOWN:case f.DOWN_ARROW:case f.PAGE_UP:case f.UP_ARROW:this._opened&&
this._announceOption(d);b.stopPropagation();b.preventDefault();break;case f.ENTER:if(d){if(d==a.nextButton){this._nextSearch(1);b.stopPropagation();b.preventDefault();break}else if(d==a.previousButton){this._nextSearch(-1);b.stopPropagation();b.preventDefault();break}b.stopPropagation();b.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case f.TAB:c=this.get("displayedValue");if(a&&(c==a._messages.previousMessage||c==a._messages.nextMessage))break;
d&&this._selectOption(d);case f.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(c){var d=this.focusNode;b.selectInputText(d,d.value.length);var a=this.ignoreCase?"toLowerCase":"substr";0==c[a](0).indexOf(this.focusNode.value[a](0))?(a=this.autoComplete?this._getCaretPos(d):d.value.length,a+1>d.value.length&&(d.value=c,b.selectInputText(d,a))):(d.value=c,b.selectInputText(d))},_openResultList:function(b,c,a){var d=this.dropDown.getHighlightedOption();
this.dropDown.clearResultList();!b.length&&0==a.start?this.closeDropDown():(this._nextSearch=this.dropDown.onPage=k.hitch(this,function(a){b.nextPage(-1!==a);this.focus()}),this.dropDown.createOptions(b,a,k.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in a?(a.direction?this.dropDown.highlightFirstOption():a.direction||this.dropDown.highlightLastOption(),d&&this._announceOption(this.dropDown.getHighlightedOption())):this.autoComplete&&(!this._prev_key_backspace&&!/^[*]+$/.test(c[this.searchAttr].toString()))&&
this._announceOption(this.dropDown.containerNode.firstChild.nextSibling))},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var b=this.get("displayedValue"),c=this.dropDown;c&&(b==c._messages.previousMessage||
b==c._messages.nextMessage)?this._setValueAttr(this._lastValueReported,!0):"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",b)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState());this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(b,c,a){var d="";b&&(a||(a=this.store._oldAPI?this.store.getValue(b,this.searchAttr):b[this.searchAttr]),d=this._getValueField()!=this.searchAttr?this.store.getIdentity(b):a);this.set("value",
d,c,a,b)},_announceOption:function(b){if(b){var c;if(b==this.dropDown.nextButton||b==this.dropDown.previousButton)c=b.innerHTML,this.item=void 0,this.value="";else{var a=this.dropDown.items[b.getAttribute("item")];c=(this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]).toString();this.set("item",a,!1,c)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",g.get(b,"id"));this._autoCompleteText(c)}},
_selectOption:function(b){this.closeDropDown();b&&this._announceOption(b);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(b){if(!this.dropDown){var c=this.id+"_popup";this.dropDown=new (k.isString(this.dropDownClass)?k.getObject(this.dropDownClass,
!1):this.dropDownClass)({onChange:k.hitch(this,this._selectOption),id:c,dir:this.dir,textDir:this.textDir})}this._lastInput=b;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new l({},this.srcNodeRef),!("value"in this.params))){var b=this.item=this.store.fetchSelectedItem();if(b){var c=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(b,c):b[c]}}},
postCreate:function(){var b=p('label[for\x3d"'+this.id+'"]');b.length&&(b[0].id||(b[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",b[0].id));this.inherited(arguments);q.after(this,"onSearch",k.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(b){b=this.labelFunc(b,this.store);var c=this.labelType;"none"!=this.highlightMatch&&("text"==this.labelType&&this._lastInput)&&(b=this.doHighlight(b,this._lastInput),c="html");return{html:"html"==c,label:b}},doHighlight:function(b,
d){var a=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),e=this.queryExpr.indexOf("${0}");d=c.escapeString(d);return this._escapeHtml(b.replace(RegExp((0==e?"^":"")+"("+d+")"+(e==this.queryExpr.length-4?"$":""),a),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(b){return b=String(b).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=
null;this.inherited(arguments)},labelFunc:function(b,c){return(c._oldAPI?c.getValue(b,this.labelAttr||this.searchAttr):b[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(b,c,a,d){this._set("item",d||null);null==b&&(b="");this.inherited(arguments)}});s("dojo-bidi")&&d.extend({_setTextDirAttr:function(b){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",b)}});return d})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(q,d,g,f,k,p){function c(c){return{id:c.value,value:c.value,name:g.trim(c.innerText||c.textContent||"")}}return q("dijit.form.DataList",k,{constructor:function(k,l){this.domNode=d.byId(l);g.mixin(this,k);this.id&&p.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:f("option",this.domNode).map(c)}])},destroy:function(){p.remove(this.id)},fetchSelectedItem:function(){var d=f("\x3e option[selected]",this.domNode)[0]||f("\x3e option",this.domNode)[0];return d&&c(d)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(q,d,g,f,k,p,c){return q("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(c){this._set("list",c)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(c){return RegExp("^"+c.replace(/(\\.)|(\*)|(\?)|\W/g,function(c,b,d,f){return d?".*":f?
".":b?b:"\\"+c})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(c){if(!this.disabled&&
!this.readOnly){var f=c.charOrCode;if(!("type"in c&&"key"==c.type.substring(0,3)&&(c.altKey||(c.ctrlKey||c.metaKey)&&"x"!=f&&"v"!=f||f==d.SHIFT))){this._prev_key_backspace=c=!1;switch(f){case d.DELETE:case d.BACKSPACE:c=this._maskValidSubsetError=this._prev_key_backspace=!0;break;default:c="string"==typeof f||229==f}if(c)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},
_startSearch:function(c){this._abortQuery();var d=this,b=g.clone(this.query),f={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},m=k.substitute(this.queryExpr,[c.replace(/([\\\*\?])/g,"\\$1")]),q,a=function(){var c=d._fetchHandle=d.store.query(b,f);!d.disabled&&!(d.readOnly||q!==d._lastQuery)&&p(c,function(g){d._fetchHandle=null;!d.disabled&&(!d.readOnly&&q===d._lastQuery)&&p(c.total,function(c){g.total=c;var e=d.pageSize;if(isNaN(e)||e>g.total)e=g.total;g.nextPage=function(c){f.direction=
c=!1!==c;f.count=e;c?(f.start+=g.length,f.start>=g.total&&(f.count=0)):(f.start-=e,0>f.start&&(f.count=Math.max(e+f.start,0),f.start=0));0>=f.count?(g.length=0,d.onSearch(g,b,f)):a()};d.onSearch(g,b,f)})},function(a){d._fetchHandle=null;d._cancelingQuery||console.error(d.declaredClass+" "+a.toString())})};g.mixin(f,this.fetchProperties);this.store._oldAPI?q=m:(q=this._patternToRegExp(m),q.toString=function(){return m});this._lastQuery=b[this.searchAttr]=q;this._queryDeferHandle=this.defer(a,this.searchDelay)},
constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var d=this.list;d&&(this.store=c.byId(d))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(q,d,g,f,k,p,c,s){return q("dijit.form._ComboBoxMenu",[k,p,s,c],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(d.add(this.previousButton,"dijitMenuItemRtl"),d.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var c=this.ownerDocument.createElement("div");c.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");c.setAttribute("role","option");return c},onHover:function(c){d.add(c,"dijitMenuItemHover")},onUnhover:function(c){d.remove(c,
"dijitMenuItemHover")},onSelect:function(c){d.add(c,"dijitMenuItemSelected")},onDeselect:function(c){d.remove(c,"dijitMenuItemSelected")},_page:function(c){var b=0,d=this.domNode.scrollTop,f=g.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();b<f;){var k=this.getHighlightedOption();if(c){if(!k.previousSibling||"none"==k.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!k.nextSibling||"none"==k.nextSibling.style.display)break;this.selectNextNode()}k=
this.domNode.scrollTop;b+=(k-d)*(c?-1:1);d=k}},handleKey:function(c){switch(c.keyCode){case f.DOWN_ARROW:return this.selectNextNode(),!1;case f.PAGE_DOWN:return this._page(!1),!1;case f.UP_ARROW:return this.selectPreviousNode(),!1;case f.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(q,d,g,f,k){var p=d("dijit.form._ComboBoxMenuMixin"+
(f("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=k.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(c){this._set("value",c);this.onChange(c)},onClick:function(c){if(c==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(c==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(c)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(c,d){var f=this._createMenuItem(),b=d(c);b.html?f.innerHTML=b.label:f.appendChild(f.ownerDocument.createTextNode(b.label));""==f.innerHTML&&(f.innerHTML="\x26#160;");return f},createOptions:function(c,d,f){this.items=c;this.previousButton.style.display=0==d.start?"none":"";g.set(this.previousButton,"id",this.id+
"_prev");q.forEach(c,function(b,c){var d=this._createOption(b,f);d.setAttribute("item",c);g.set(d,"id",this.id+c);this.nextButton.parentNode.insertBefore(d,this.nextButton)},this);var b=!1;c.total&&!c.total.then&&-1!=c.total?d.start+d.count<c.total?b=!0:d.start+d.count>c.total&&d.count==c.length&&(b=!0):d.count==c.length&&(b=!0);this.nextButton.style.display=b?"":"none";g.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var c=this.containerNode;2<c.childNodes.length;)c.removeChild(c.childNodes[c.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});f("dojo-bidi")&&(p=d("dijit.form._ComboBoxMenuMixin",
p,{_createOption:function(){var c=this.inherited(arguments);this.applyTextDir(c);return c}}));return p})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(q,d,g,f){return q("dijit.form._ListMouseMixin",f,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(d,f){this._setSelectedAttr(f,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(f)})},_onMouseDown:function(d,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(f,!1)},_onMouseUp:function(d,f){this._isDragging=!1;var c=this.selected,g=this._hoveredNode;c&&f==c?this.defer(function(){this._onClick(d,
c)}):g&&this.defer(function(){this._onClick(d,g)})},_onMouseOut:function(d,f){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(d,f){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=f;this.onHover(f);this._isDragging&&this._setSelectedAttr(f,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(q,d,g){return q("dijit.form._ListBase",null,{selected:null,_listConnect:function(f,g){var p=this;return p.own(d(p.containerNode,d.selector(function(c,d,f){return c.parentNode==f},f),function(c){p[g](c,this)}))},selectFirstNode:function(){for(var d=this.containerNode.firstChild;d&&"none"==d.style.display;)d=d.nextSibling;this._setSelectedAttr(d,!0)},selectLastNode:function(){for(var d=this.containerNode.lastChild;d&&"none"==d.style.display;)d=d.previousSibling;this._setSelectedAttr(d,
!0)},selectNextNode:function(){var d=this.selected;if(d){for(d=d.nextSibling;d&&"none"==d.style.display;)d=d.nextSibling;d?this._setSelectedAttr(d,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var d=this.selected;if(d){for(d=d.previousSibling;d&&"none"==d.style.display;)d=d.previousSibling;d?this._setSelectedAttr(d,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(d,k){if(this.selected!=d){var p=this.selected;if(p)this.onDeselect(p);
d&&(k&&g.scrollIntoView(d),this.onSelect(d));this._set("selected",d)}else if(d)this.onSelect(d)}})})},"url:esri/dijit/templates/InfoWindow.html":'\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\r\n  \x3e\x3cdiv style\x3d"position:relative;"\r\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\r\n      \x3e\x3cdiv class\x3d"top"\r\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\r\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\r\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\r\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\r\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\r\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\r\n    \t\t\t  \x3e\x3c/div\r\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\r\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\r\n    \t\t\t  \x3e\x3c/div\r\n    \t\t\t\x3e\x3c/div\r\n    \t\t\x3e\x3c/div\r\n        \x3e\x3cdiv class\x3d"bottom"\r\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n        \x3e\x3c/div\r\n      \x3e\x3c/div\r\n    \x3e\x3c/div\r\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\r\n  \x3e\x3c/div\r\n\x3e\x3c/div\x3e',
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv style\x3d"position:absolute;top:0;left:0;right:0;bottom:0;height:100%; width:100%; z-index:99999; background: no-repeat center center; opacity:0.6; filter:alpha(opacity\x3d60);font-size:14px;line-height:20px;z-index:510;"\x3e\r\n  \x3cdiv style\x3d"color:#000000;position:absolute; top:50%; left:50%; margin-left:-50px;margin-top:-20px; font-weight:bold; width:250px;height:40px;"\x3e\r\n      \x3cimg data-dojo-attach-point\x3d"loadingImg" style\x3d"position:absolute;width:40px;height:40px;left:0;top:0;"/\x3e\r\n      \x3cp data-dojo-attach-point\x3d"textNode" style\x3d"position:absolute;left:60px;top:0;display:inline-block;height:40px;line-height:40px;white-space:nowrap;margin:0 0 0 20px;"\x3e${nls.loading}...\x3c/p\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/SymbolChooser.html":'\x3cdiv style\x3d"width:320px;"\x3e\r\n\t\x3cdiv class\x3d"symbol-section point-symbol-section" data-dojo-attach-point\x3d"pointSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d130\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-sym-class-select-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"pointSymClassSelect" data-dojo-type\x3d"dijit/form/Select"\r\n\t\t\t\t\t\t style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'0\' selected\x3d"selected"\x3e${nls.basic}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'1\'\x3eA-Z\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'2\'\x3e${nls.arrows}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'3\'\x3e${nls.business}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'4\'\x3e${nls.cartographic}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'5\'\x3e${nls.nationalParkService}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'6\'\x3e${nls.outdoorRecreation}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'7\'\x3e${nls.peoplePlaces}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'8\'\x3e${nls.safetyHealth}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'9\'\x3e${nls.shapes}\x3c/option\x3e\r\n\t\t\t\t\t\t\t \x3coption value\x3d\'10\'\x3e${nls.transportation}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"point-icon-tables-tr"\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"pointIconTables"\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.symbolSize}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\r\n                        data-dojo-props\x3d\'value:18,smallDelta:1,largeDelta:10,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.color}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,128]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOpacityTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t${nls.transparency}\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOutlineColorTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,255]\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOulineWidthTr"\x3e\r\n\t\t\t\t\t\x3ctd\x3e${nls.outlineWidth}:\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n                        data-dojo-props\x3d\'value:1,smallDelta:1,constraints:{min:0,max:5},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section line-symbol-section" data-dojo-attach-point\x3d"lineSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"3"\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"lineIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.style}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"lineStylesSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"solid"\x3e${nls.solid}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"dash"\x3e${nls.dash}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"dot"\x3e${nls.dot}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"dashdot"\x3e${nls.dashDot}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"longdashdotdot"\x3e${nls.dashDotDot}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e${nls.transparency}\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:1\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.width}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"lineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n                        data-dojo-props\x3d\'value:3,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section fill-symbol-section" data-dojo-attach-point\x3d"fillSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"3"\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"fillIconTables"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t${nls.transparency}\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#738c3d"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.outlineWidth}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"fillOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \r\n                        data-dojo-props\x3d\'value:2,smallDelta:1,constraints:{min:0,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"symbol-section text-symbol-section" data-dojo-attach-point\x3d"textSection"\x3e\r\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.preview}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\r\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"textPreview"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.text}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"inputText" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.fontColor}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"textColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#000"\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.fontSize}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"textFontSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:20,smallDelta:1,constraints:{min:1,max:100},intermediateChanges:true\'\x3e\x3c/input\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\r\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\r\n\trole\x3d"listbox" aria-haspopup\x3d"true"\r\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\r\n\t\t/\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\r\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\r\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t${_buttonInputDisabled}\r\n\t\t/\x3e\x3c/td\r\n\t\x3e\x3c/tr\x3e\x3c/tbody\r\n\x3e\x3c/table\x3e\r\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}" role\x3d"presentation"\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\r\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\r\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t\t\t\t\t${_buttonInputDisabled}\r\n\t\t\t/\x3e\x3c/div\r\n\t\t\x3e\x3c/div\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\r\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"url:dijit/templates/ColorPalette.html":'\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/_Transparency.html":'\x3cdiv style\x3d"min-width: 170px;"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"opacitySlider" data-dojo-type\x3d"dijit/form/HorizontalSlider" showbuttons\x3d"true" value\x3d"0" minimum\x3d"0" maximum\x3d"100" discretevalues\x3d"101" intermediatechanges\x3d"true" style\x3d"width:100%;" data-dojo-attach-event\x3d"change: _onAlphaChanged"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"topDecoration" labels\x3d"${nls.opaque},${nls.transparent}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\r\n    \x3c/div\x3e\r\n    \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height: 1em; font-size: 0.75em; color: darkblue;"\x3e\r\n      \x3cli\x3e0%\x3c/li\x3e\r\n      \x3cli\x3e50%\x3c/li\x3e\r\n      \x3cli\x3e100%\x3c/li\x3e\r\n    \x3c/ol\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\r\n\trole\x3d"presentation"\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\r\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\r\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\r\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\r\n\t\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3c/div\r\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\r\n\t\t\t\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\r\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\r\n\t\t\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\t\x3e\x3ctr class\x3d"dijitReset"\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\r\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\r\n\t\x3e\x3c/tr\r\n\x3e\x3c/table\x3e\r\n',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\r\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/DrawBox.html":'\x3cdiv style\x3d"position:relative;width:100%;"\x3e\r\n\t\x3cdiv class\x3d"draw-items"\x3e\r\n\t\t\x3cdiv title\x3d"${nls.point}" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.line}" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polyline}" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolyline}" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.triangle}" data-geotype\x3d"TRIANGLE" data-commontype\x3d"polygon" class\x3d"draw-item triangle-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.extent}" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.circle}" data-geotype\x3d"CIRCLE" data-commontype\x3d"polygon" class\x3d"draw-item circle-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.ellipse}" data-geotype\x3d"ELLIPSE" data-commontype\x3d"polygon" class\x3d"draw-item ellipse-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.polygon}" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.freehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv title\x3d"${nls.text}" data-geotype\x3d"POINT" data-commontype\x3d"text" class\x3d"draw-item text-icon" data-dojo-attach-point\x3d"textIcon"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cspan class\x3d"drawings-clear" data-dojo-attach-point\x3d"btnClear"\x3e${nls.clear}\x3c/span\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/CheckedMenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${checkedChar}\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\r\n\t\x3e\x3cinput\r\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\r\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\r\n\t\tdata-dojo-attach-point\x3d"focusNode"\r\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\r\n/\x3e\x3c/div\x3e\r\n',"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\r\n\tid\x3d"widget_${id}"\r\n\trole\x3d"combobox"\r\n\taria-haspopup\x3d"true"\r\n\tdata-dojo-attach-point\x3d"_popupStateNode"\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\r\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\r\n\t\t\t${_buttonInputDisabled}\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\r\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\r\n\t/\x3e\x3c/div\r\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\r\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\r\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\r\n\t/\x3e\x3c/div\r\n\x3e\x3c/div\x3e\r\n',
"*now":function(q){q(['dojo/i18n!*preload*jimu/nls/main*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("./ConfigManager ./LayoutManager dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/mouse dojo/topic dojo/cookie dojo/Deferred dojo/promise/all dojo/io-query dojo/domReady! esri/request esri/urlUtils esri/IdentityManager jimu/portalUrlUtils ./utils require dojo/i18n dojo/i18n!./nls/main".split(" "),function(q,d,g,f,k,p,c,s,l,b,r,m,t,a,e,n,h,z,A,B,y){k={};"function"!==typeof l.getAll&&(l.getAll=function(a){var b=[];(a=l(a))&&b.push(a);return b});window.jimuNls=y;n.setProtocolErrorHandler(function(){return!0});
n=z.getAncestorWindow();var w=!1;try{w=0===n.location.href.indexOf("https://")}catch(C){console.log(C),w=!1}a.setRequestPreCallback(function(a){a.content&&a.content.printFlag&&(a.timeout=3E5);w&&(a.url=a.url.replace(/^http(s?):\/\//gi,"//"));return a});p(window,"mousedown",function(a){if(c.isMiddle(a))return a.preventDefault(),a.stopPropagation(),a.returnValue=!1});String.prototype.startWith=function(a){return this.substr(0,a.length)===a?!0:!1};String.prototype.endWith=function(a){return this.substr(this.length-
a.length,a.length)===a?!0:!1};"undefined"===typeof jimuConfig&&(jimuConfig={});jimuConfig=f.mixin({loadingId:"main-loading",layoutId:"jimu-layout-manager",mapId:"map",mainPageId:"main-page",timeout:5E3,widthBreaks:[600,1280]},jimuConfig);window.jimu={version:"Online 3.5 Beta"};k.initApp=function(){var a,b;console.log("jimu.js init...");b=window.location.search;a=""===b?{}:b=m.queryToObject(b.substr(1));g.setStyle(jimuConfig.loadingId,"display","none");g.setStyle(jimuConfig.mainPageId,"display","block");
b=d.getInstance({mapId:jimuConfig.mapId},jimuConfig.layoutId);a=q.getInstance(a);b.startup();a.loadConfig()};return k});